<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>CMA-ES: cma-es/cmaes.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CMA-ES</div>
   <div id="projectbrief">A C++ implementation of CMA-ES.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_31cc3052683361e99e57b7ec16c064ae.html">cma-es</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">cmaes.h</div>  </div>
</div>
<div class="contents">
<a href="cmaes_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00096"></a>00096 <span class="preprocessor">#pragma once</span>
<a name="l00097"></a>00097 <span class="preprocessor"></span>
<a name="l00098"></a>00098 <span class="preprocessor">#include &quot;<a class="code" href="parameters_8h.html">parameters.h</a>&quot;</span>
<a name="l00099"></a>00099 <span class="preprocessor">#include &quot;<a class="code" href="random_8h.html">random.h</a>&quot;</span>
<a name="l00100"></a>00100 <span class="preprocessor">#include &quot;<a class="code" href="timings_8h.html">timings.h</a>&quot;</span>
<a name="l00101"></a>00101 <span class="preprocessor">#include &quot;<a class="code" href="utils_8h.html" title="Contains some utility functions.">utils.h</a>&quot;</span>
<a name="l00102"></a>00102 <span class="preprocessor">#include &lt;cassert&gt;</span>
<a name="l00103"></a>00103 <span class="preprocessor">#include &lt;cmath&gt;</span>
<a name="l00104"></a>00104 <span class="preprocessor">#include &lt;cstdio&gt;</span>
<a name="l00105"></a>00105 <span class="preprocessor">#include &lt;cstring&gt;</span>
<a name="l00106"></a>00106 <span class="preprocessor">#include &lt;fstream&gt;</span>
<a name="l00107"></a>00107 <span class="preprocessor">#include &lt;limits&gt;</span>
<a name="l00108"></a>00108 <span class="preprocessor">#include &lt;iomanip&gt;</span>
<a name="l00109"></a>00109 <span class="preprocessor">#include &lt;sstream&gt;</span>
<a name="l00110"></a>00110 <span class="preprocessor">#include &lt;stdexcept&gt;</span>
<a name="l00111"></a>00111 <span class="preprocessor">#include &lt;string&gt;</span>
<a name="l00112"></a>00112 
<a name="l00118"></a>00118 <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;
<a name="l00119"></a><a class="code" href="classCMAES.html">00119</a> <span class="keyword">class </span><a class="code" href="classCMAES.html" title="Evolution Strategies with Covariance Matrix Adaptation.">CMAES</a>
<a name="l00120"></a>00120 {
<a name="l00121"></a>00121 <span class="keyword">public</span>:
<a name="l00122"></a>00122 
<a name="l00126"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8">00126</a>   <span class="keyword">enum</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8" title="Keys for get().">GetScalar</a>
<a name="l00127"></a>00127   {
<a name="l00128"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a0eac9fcd31997fbce7b050fea059146c">00128</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a0eac9fcd31997fbce7b050fea059146c">NoScalar</a> = 0,
<a name="l00129"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a80b1da110476f59b1dd637f86abcff6d">00129</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a80b1da110476f59b1dd637f86abcff6d">AxisRatio</a> = 1,
<a name="l00130"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a3d094cfa5259537cb5866df1aa30dabf">00130</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a792dc72137eae9dff32d3d0ec7e520a0">Eval</a> = 2, <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a3d094cfa5259537cb5866df1aa30dabf">Evaluations</a> = 2,
<a name="l00131"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a24a927cfe7f5c73c47e8f5395abc0e7a">00131</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8abda053a0cb2db42a16e0acfcdffc1f5d">FctValue</a> = 3, <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a0a185991edec9d5597e958a825ccef8b">FuncValue</a> = 3, <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a24a927cfe7f5c73c47e8f5395abc0e7a">FunValue</a> = 3, <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8addcdd74505b48ad4a541db7b829e335b">Fitness</a> = 3,
<a name="l00132"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8ad21c49f13a72548684969bd0efadee5b">00132</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8ad21c49f13a72548684969bd0efadee5b">FBestEver</a> = 4,
<a name="l00133"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a227350ef92ae76a118395539614413ea">00133</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8acc3da801ee825cfe1d4546e7ff1df445">Generation</a> = 5, <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a227350ef92ae76a118395539614413ea">Iteration</a> = 5,
<a name="l00134"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8ac2a58bc5ffa24f12ec92e11c18e8d4a1">00134</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8aa6d0a2c0e925ea13fbc4eafdb0d73212">MaxEval</a> = 6, <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8ae9d7f8b79143385c7b106bbbf3c2d412">MaxFunEvals</a> = 6, <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8ac2a58bc5ffa24f12ec92e11c18e8d4a1">StopMaxFunEvals</a> = 6,
<a name="l00135"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8aeb3dce345e47ca1fcc222d4fde877a3a">00135</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8af273a71dfa8af4b2512e63b85255c57b">MaxGen</a> = 7, <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a2f5dc38e6e11ee72a99131f66ac96ec6">MaxIter</a> = 7, <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8aeb3dce345e47ca1fcc222d4fde877a3a">StopMaxIter</a> = 7,
<a name="l00136"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8ad08dc0a35ffc83e74e5ee207facfd9ae">00136</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8ad08dc0a35ffc83e74e5ee207facfd9ae">MaxAxisLength</a> = 8,
<a name="l00137"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a69531e25f35ad31c729d8cbbdb0919ce">00137</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a69531e25f35ad31c729d8cbbdb0919ce">MinAxisLength</a> = 9,
<a name="l00138"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a2255eb5bbe0790bd7d8a59ebd6adcefc">00138</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a2255eb5bbe0790bd7d8a59ebd6adcefc">MaxStdDev</a> = 10,
<a name="l00139"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8ad2a4cb103c2cde9298f960900d82d9e5">00139</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8ad2a4cb103c2cde9298f960900d82d9e5">MinStdDev</a> = 11,
<a name="l00140"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8aa3da33927ee647a3f48e408b11c37946">00140</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a75e12eda134ea0f0eca86ee1833e561e">Dim</a> = 12, <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8aa3da33927ee647a3f48e408b11c37946">Dimension</a> = 12,
<a name="l00141"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a525cb5a156ebe9191586e97830aede31">00141</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a0a7cf2fff11dd8b8ad79f21540313a76">Lambda</a> = 13, <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a525cb5a156ebe9191586e97830aede31">SampleSize</a> = 13, <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a8fa009b49ad74ed50cb8639d94ce4d00">PopSize</a> = 13,
<a name="l00142"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a06a4d432f0d0783509dd88456ecd07ea">00142</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a06a4d432f0d0783509dd88456ecd07ea">Sigma</a> = 14
<a name="l00143"></a>00143   };
<a name="l00144"></a>00144 
<a name="l00148"></a><a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82">00148</a>   <span class="keyword">enum</span> <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82" title="Keys for getPtr().">GetVector</a>
<a name="l00149"></a>00149   {
<a name="l00150"></a><a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82af40a2e44d652a00a9ccd9edec2009af0">00150</a>     <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82af40a2e44d652a00a9ccd9edec2009af0">NoVector</a> = 0,
<a name="l00151"></a><a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82ae17b1c54a0a0ab7c76d07eed386d9322">00151</a>     <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82ae17b1c54a0a0ab7c76d07eed386d9322">DiagC</a> = 1,
<a name="l00152"></a><a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82a5bdd7c9d31b8273f97e54e30f6119399">00152</a>     <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82a5bdd7c9d31b8273f97e54e30f6119399">DiagD</a> = 2,
<a name="l00153"></a><a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82a0ec1a5126c8afaa5de18d488631e0694">00153</a>     <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82a0ec1a5126c8afaa5de18d488631e0694">StdDev</a> = 3,
<a name="l00154"></a><a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82aee6ad973ab7973ed05fbd787af5f4241">00154</a>     <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82aee6ad973ab7973ed05fbd787af5f4241">XBestEver</a> = 4,
<a name="l00155"></a><a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82aeb635f2a8c23f4e25bd9ae0e0804bb7a">00155</a>     <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82aeb635f2a8c23f4e25bd9ae0e0804bb7a">XBest</a> = 5,
<a name="l00156"></a><a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82abe10ba6036cb0771e308fb1f9af27f48">00156</a>     <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82abe10ba6036cb0771e308fb1f9af27f48">XMean</a> = 6
<a name="l00157"></a>00157   };
<a name="l00158"></a>00158 
<a name="l00162"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5">00162</a>   <span class="keyword">enum</span> <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5" title="Keys for writeToFile().">WriteKey</a>
<a name="l00163"></a>00163   {
<a name="l00164"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a21e38dd471b82a293b061500ada251c6">00164</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a21e38dd471b82a293b061500ada251c6">WCNone</a> = 0,
<a name="l00165"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5aa149aa30989f563b45db616cf69a375b">00165</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5aa149aa30989f563b45db616cf69a375b">WKResume</a> = 1,
<a name="l00166"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5ab430a1a4c4f6030e67f76d49dc1acd76">00166</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5ab430a1a4c4f6030e67f76d49dc1acd76">WKXMean</a> = 2,
<a name="l00167"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a61d330c96de9b673a0076606bea2b59b">00167</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a61d330c96de9b673a0076606bea2b59b">WKC</a> = 4,
<a name="l00168"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5abbf04a8ffe5c7bccecf352e294e9c099">00168</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5abbf04a8ffe5c7bccecf352e294e9c099">WKAll</a> = 8,
<a name="l00169"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a07d0282b9c7d9719df60fbc03f5a6eab">00169</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a07d0282b9c7d9719df60fbc03f5a6eab">WKFewInfo</a> = 16,
<a name="l00170"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5ac8b7485532d066b19565db85e060aeac">00170</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5ac8b7485532d066b19565db85e060aeac">WKFew</a> = 32,
<a name="l00171"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a92d1998fb46900bceb39a60e3ed35746">00171</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a92d1998fb46900bceb39a60e3ed35746">WKEval</a> = 64,
<a name="l00172"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a3bab88222e97d560b05cdcd7f5d967f0">00172</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a3bab88222e97d560b05cdcd7f5d967f0">WKFitness</a> = 128,
<a name="l00173"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a689dedaccffee9f44f969a838f62b2a3">00173</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a689dedaccffee9f44f969a838f62b2a3">WKFBestEver</a> = 256,
<a name="l00174"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5af74d31e6940d9c55b13935971bfd764d">00174</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5af74d31e6940d9c55b13935971bfd764d">WKCGeneration</a> = 512,
<a name="l00175"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a393a8956a826379f2918b1a0193ceead">00175</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a393a8956a826379f2918b1a0193ceead">WKSigma</a> = 1024,
<a name="l00176"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5ab3b3919789e241ae3ae2c855d17c7528">00176</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5ab3b3919789e241ae3ae2c855d17c7528">WKLambda</a> = 2048,
<a name="l00177"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a407d38eb1d75495aa388416be4fb9673">00177</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a407d38eb1d75495aa388416be4fb9673">WKB</a> = 4096,
<a name="l00178"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a9b15493966d6f12f6e3135046cd6ae24">00178</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a9b15493966d6f12f6e3135046cd6ae24">WKXBest</a> = 8192,
<a name="l00179"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a939618e4c01b55a93ead6992a16e7d80">00179</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a939618e4c01b55a93ead6992a16e7d80">WKClock</a> = 16384,
<a name="l00180"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a7213701c32edd96cbca9697368af03ae">00180</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a7213701c32edd96cbca9697368af03ae">WKDim</a> = 32768
<a name="l00181"></a>00181   };
<a name="l00182"></a>00182 
<a name="l00183"></a>00183 <span class="keyword">private</span>:
<a name="l00184"></a>00184 
<a name="l00186"></a>00186   std::string <a class="code" href="classCMAES.html#a39f33a47d224feccbb0f31bc3b24f922" title="Implementation version.">version</a>;
<a name="l00188"></a>00188   <a class="code" href="classRandom.html" title="A pseudo random number generator.">Random&lt;T&gt;</a> <a class="code" href="classCMAES.html#a73e60929e1e08ea6f9f4a5cec6f020b4" title="CMA-ES parameters.">rand</a>;
<a name="l00190"></a><a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">00190</a>   <a class="code" href="classParameters.html" title="Holds all parameters that can be adjusted by the user.">Parameters&lt;T&gt;</a> <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>;
<a name="l00191"></a>00191 
<a name="l00193"></a><a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4">00193</a>   T <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>;
<a name="l00195"></a><a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191">00195</a>   T* <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="Mean x vector, &quot;parent&quot;.">xmean</a>;
<a name="l00197"></a><a class="code" href="classCMAES.html#a0b94ac84584f832f79084141bc768068">00197</a>   T* <a class="code" href="classCMAES.html#a0b94ac84584f832f79084141bc768068" title="Best sample ever.">xBestEver</a>;
<a name="l00199"></a><a class="code" href="classCMAES.html#a46ee9e7f9bb10e7a32af8e991dbc3c4d">00199</a>   T** <a class="code" href="classCMAES.html#a46ee9e7f9bb10e7a32af8e991dbc3c4d" title="x-vectors, lambda offspring.">population</a>;
<a name="l00201"></a><a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3">00201</a>   <span class="keywordtype">int</span>* <a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="Sorting index of sample population.">index</a>;
<a name="l00203"></a><a class="code" href="classCMAES.html#a2e91522e80428b2abd40947b2fb3ed4e">00203</a>   T* <a class="code" href="classCMAES.html#a2e91522e80428b2abd40947b2fb3ed4e" title="History of function values.">funcValueHistory</a>;
<a name="l00204"></a>00204 
<a name="l00205"></a><a class="code" href="classCMAES.html#af5aff4dfec9d1eabe488c5f03395158f">00205</a>   T <a class="code" href="classCMAES.html#af5aff4dfec9d1eabe488c5f03395158f">chiN</a>;
<a name="l00207"></a><a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d">00207</a>   T** <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>;
<a name="l00209"></a><a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0">00209</a>   T** <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="Matrix with normalize eigenvectors in columns.">B</a>;
<a name="l00211"></a><a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1">00211</a>   T* <a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>;
<a name="l00212"></a>00212 
<a name="l00214"></a><a class="code" href="classCMAES.html#a978c42dbaee69df8ac0cd5d480835579">00214</a>   T* <a class="code" href="classCMAES.html#a978c42dbaee69df8ac0cd5d480835579" title="Anisotropic evolution path (for covariance).">pc</a>;
<a name="l00216"></a><a class="code" href="classCMAES.html#ab025d43841c37ded96cdc76f834d82ba">00216</a>   T* <a class="code" href="classCMAES.html#ab025d43841c37ded96cdc76f834d82ba" title="Isotropic evolution path (for step length).">ps</a>;
<a name="l00218"></a><a class="code" href="classCMAES.html#a62c5a6a980a0a2fd13d3ba5b257dfc4f">00218</a>   T* <a class="code" href="classCMAES.html#a62c5a6a980a0a2fd13d3ba5b257dfc4f" title="Last mean.">xold</a>;
<a name="l00220"></a><a class="code" href="classCMAES.html#aeb4c1c5be50edcc7ed39c9599191c3e5">00220</a>   T* <a class="code" href="classCMAES.html#aeb4c1c5be50edcc7ed39c9599191c3e5" title="Output vector.">output</a>;
<a name="l00222"></a><a class="code" href="classCMAES.html#a73714d5cec116bef33aed344991536a2">00222</a>   T* <a class="code" href="classCMAES.html#a73714d5cec116bef33aed344991536a2" title="B*D*z.">BDz</a>;
<a name="l00224"></a><a class="code" href="classCMAES.html#a9aa6c060f3f33a4e07b20133c429b3bb">00224</a>   T* <a class="code" href="classCMAES.html#a9aa6c060f3f33a4e07b20133c429b3bb" title="Temporary (random) vector used in different places.">tempRandom</a>;
<a name="l00226"></a>00226   T* <a class="code" href="classCMAES.html#aa1ad648deeabde4621b932ec378551fc" title="Objective function values of the population.">functionValues</a>;
<a name="l00228"></a><a class="code" href="classCMAES.html#a4ed94ed86d47a4903cb11eacd1f703e5">00228</a>   T* <a class="code" href="classCMAES.html#a4ed94ed86d47a4903cb11eacd1f703e5">publicFitness</a>;
<a name="l00229"></a>00229 
<a name="l00231"></a><a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3">00231</a>   T <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a>;
<a name="l00233"></a><a class="code" href="classCMAES.html#a0cef0210cdaaf09dd1d40daf33127765a56c763404afb4ac45e7b81539eeb6fd2">00233</a>   <span class="keyword">enum</span> {<a class="code" href="classCMAES.html#a0cef0210cdaaf09dd1d40daf33127765acdf19eb2e5b851d7af910fa38ac814e7">INITIALIZED</a>, <a class="code" href="classCMAES.html#a0cef0210cdaaf09dd1d40daf33127765abf4219108f9e35e6816d0233af2a2e3e">SAMPLED</a>, <a class="code" href="classCMAES.html#a0cef0210cdaaf09dd1d40daf33127765a56c763404afb4ac45e7b81539eeb6fd2">UPDATED</a>} <a class="code" href="classCMAES.html#a2259ba2fee168dac1aed9a5de7e9703e">state</a>;
<a name="l00234"></a>00234 
<a name="l00235"></a>00235   <span class="comment">// repeatedly used for output</span>
<a name="l00236"></a><a class="code" href="classCMAES.html#a93eee1dc0a955f05fcabb5db15b64886">00236</a>   T <a class="code" href="classCMAES.html#a93eee1dc0a955f05fcabb5db15b64886">maxdiagC</a>;
<a name="l00237"></a><a class="code" href="classCMAES.html#a0fc9beb46f3685e1f49f2575de3ce026">00237</a>   T <a class="code" href="classCMAES.html#a0fc9beb46f3685e1f49f2575de3ce026">mindiagC</a>;
<a name="l00238"></a><a class="code" href="classCMAES.html#ae36bc85cdd41cb3db39b99a0303f6b6e">00238</a>   T <a class="code" href="classCMAES.html#ae36bc85cdd41cb3db39b99a0303f6b6e">maxEW</a>;
<a name="l00239"></a><a class="code" href="classCMAES.html#a9796be17293ba4549946392565368f41">00239</a>   T <a class="code" href="classCMAES.html#a9796be17293ba4549946392565368f41">minEW</a>;
<a name="l00240"></a>00240 
<a name="l00241"></a><a class="code" href="classCMAES.html#ade7b4d250edba249dfcfdc2e2396246e">00241</a>   <span class="keywordtype">bool</span> <a class="code" href="classCMAES.html#ade7b4d250edba249dfcfdc2e2396246e">eigensysIsUptodate</a>;
<a name="l00242"></a><a class="code" href="classCMAES.html#a09f393f2ef964f14f6b668bc91657650">00242</a>   <span class="keywordtype">bool</span> <a class="code" href="classCMAES.html#a09f393f2ef964f14f6b668bc91657650" title="control via signals.par">doCheckEigen</a>; 
<a name="l00243"></a><a class="code" href="classCMAES.html#a6f4acfc9073c8320c00bb0faa9efcdcb">00243</a>   T <a class="code" href="classCMAES.html#a6f4acfc9073c8320c00bb0faa9efcdcb">genOfEigensysUpdate</a>;
<a name="l00244"></a>00244 
<a name="l00245"></a><a class="code" href="classCMAES.html#ae2163bc8eb11b8d28662ae985f51429b">00245</a>   T <a class="code" href="classCMAES.html#ae2163bc8eb11b8d28662ae985f51429b">dMaxSignifKond</a>;
<a name="l00246"></a><a class="code" href="classCMAES.html#a89e9afdc9f28b153f6939039117080f1">00246</a>   T <a class="code" href="classCMAES.html#a89e9afdc9f28b153f6939039117080f1">dLastMinEWgroesserNull</a>;
<a name="l00247"></a>00247 
<a name="l00248"></a><a class="code" href="classCMAES.html#a5ef76c4c2d5833429dc868ed8d2c6709">00248</a>   <span class="keywordtype">bool</span> <a class="code" href="classCMAES.html#a5ef76c4c2d5833429dc868ed8d2c6709">isResumeDone</a>;
<a name="l00249"></a>00249 
<a name="l00250"></a><a class="code" href="classCMAES.html#a31915e1cc29d88faee41c1f45d3d5a2a">00250</a>   time_t <a class="code" href="classCMAES.html#a31915e1cc29d88faee41c1f45d3d5a2a">printtime</a>;
<a name="l00251"></a><a class="code" href="classCMAES.html#a9f27aaa233806a6823b96d83059c68e1">00251</a>   time_t <a class="code" href="classCMAES.html#a9f27aaa233806a6823b96d83059c68e1" title="ideally should keep track for each output file">writetime</a>; 
<a name="l00252"></a><a class="code" href="classCMAES.html#a72e456703b11bdcd7c273a2b764faf70">00252</a>   time_t <a class="code" href="classCMAES.html#a72e456703b11bdcd7c273a2b764faf70">firstwritetime</a>;
<a name="l00253"></a><a class="code" href="classCMAES.html#ae5b668b5b4bacd4048c6742650801356">00253</a>   time_t <a class="code" href="classCMAES.html#ae5b668b5b4bacd4048c6742650801356">firstprinttime</a>;
<a name="l00254"></a>00254 
<a name="l00255"></a><a class="code" href="classCMAES.html#a0146e5c3a576c5f04e33c0ec3978a2e8">00255</a>   std::string <a class="code" href="classCMAES.html#a0146e5c3a576c5f04e33c0ec3978a2e8" title="A message that contains all matched stop criteria.">stopMessage</a>; 
<a name="l00256"></a>00256 
<a name="l00257"></a><a class="code" href="classCMAES.html#aed17d3f1a936b1f640203d17f0422743">00257</a>   std::string <a class="code" href="classCMAES.html#aed17d3f1a936b1f640203d17f0422743">getTimeStr</a>(<span class="keywordtype">void</span>)
<a name="l00258"></a>00258   {
<a name="l00259"></a>00259     time_t tm = time(0);
<a name="l00260"></a>00260     std::string timeStr(ctime(&amp;tm));
<a name="l00261"></a>00261     <span class="keywordflow">return</span> timeStr.substr(0, 24);
<a name="l00262"></a>00262   }
<a name="l00263"></a>00263 
<a name="l00270"></a><a class="code" href="classCMAES.html#a77ac5ff94fbff0bed5ce9e8d83f890ee">00270</a>   <span class="keywordtype">void</span> <a class="code" href="classCMAES.html#a77ac5ff94fbff0bed5ce9e8d83f890ee" title="Calculating eigenvalues and vectors.">eigen</a>(T* diag, T** Q, T* rgtmp)
<a name="l00271"></a>00271   {
<a name="l00272"></a>00272     assert(rgtmp &amp;&amp; <span class="stringliteral">&quot;eigen(): input parameter rgtmp must be non-NULL&quot;</span>);
<a name="l00273"></a>00273 
<a name="l00274"></a>00274     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a> != Q) <span class="comment">// copy C to Q</span>
<a name="l00275"></a>00275     {
<a name="l00276"></a>00276       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00277"></a>00277         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)
<a name="l00278"></a>00278           Q[i][j] = Q[j][i] = <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i][j];
<a name="l00279"></a>00279     }
<a name="l00280"></a>00280 
<a name="l00281"></a>00281     <a class="code" href="classCMAES.html#ae861a4dac0f11adfdc0096cfbcdcbd07" title="Householder transformation of a symmetric matrix V into tridiagonal form.">householder</a>(Q, diag, rgtmp);
<a name="l00282"></a>00282     <a class="code" href="classCMAES.html#a6bb335a1116845d5ef1bb11fc3ac5cd1" title="Symmetric tridiagonal QL algorithm, iterative.">ql</a>(diag, rgtmp, Q);
<a name="l00283"></a>00283   }
<a name="l00284"></a>00284 
<a name="l00290"></a><a class="code" href="classCMAES.html#a770b17733d7d66fae4654823736d9c26">00290</a>   <span class="keywordtype">int</span> <a class="code" href="classCMAES.html#a770b17733d7d66fae4654823736d9c26" title="Exhaustive test of the output of the eigendecomposition, needs O(n^3) operations writes to error file...">checkEigen</a>(T* diag, T** Q)
<a name="l00291"></a>00291   {
<a name="l00292"></a>00292     <span class="comment">// compute Q diag Q^T and Q Q^T to check</span>
<a name="l00293"></a>00293     <span class="keywordtype">int</span> res = 0;
<a name="l00294"></a>00294     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00295"></a>00295       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++j) {
<a name="l00296"></a>00296         T cc = 0., dd = 0.;
<a name="l00297"></a>00297         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++k)
<a name="l00298"></a>00298         {
<a name="l00299"></a>00299           cc += diag[k]*Q[i][k]*Q[j][k];
<a name="l00300"></a>00300           dd += Q[i][k]*Q[j][k];
<a name="l00301"></a>00301         }
<a name="l00302"></a>00302         <span class="comment">// check here, is the normalization the right one?</span>
<a name="l00303"></a>00303         <span class="keyword">const</span> <span class="keywordtype">bool</span> cond1 = fabs(cc - <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i &gt; j ? i : j][i &gt; j ? j : i]) / sqrt(<a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i][i]* <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[j][j]) &gt; T(1e-10);
<a name="l00304"></a>00304         <span class="keyword">const</span> <span class="keywordtype">bool</span> cond2 = fabs(cc - <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i &gt; j ? i : j][i &gt; j ? j : i]) &gt; T(3e-14);
<a name="l00305"></a>00305         <span class="keywordflow">if</span>(cond1 &amp;&amp; cond2)
<a name="l00306"></a>00306         {
<a name="l00307"></a>00307           std::stringstream s;
<a name="l00308"></a>00308           s &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; cc &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i &gt; j ? i : j][i &gt; j ? j : i]
<a name="l00309"></a>00309               &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; cc - <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i &gt; j ? i : j][i &gt; j ? j : i];
<a name="l00310"></a>00310           <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.logWarnings)
<a name="l00311"></a>00311             <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.logStream &lt;&lt; <span class="stringliteral">&quot;eigen(): imprecise result detected &quot;</span> &lt;&lt; s.str()
<a name="l00312"></a>00312                 &lt;&lt; std::endl;
<a name="l00313"></a>00313           ++res;
<a name="l00314"></a>00314         }
<a name="l00315"></a>00315         <span class="keywordflow">if</span>(std::fabs(dd - (i == j)) &gt; T(1e-10))
<a name="l00316"></a>00316         {
<a name="l00317"></a>00317           std::stringstream s;
<a name="l00318"></a>00318           s &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; dd;
<a name="l00319"></a>00319           <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.logWarnings)
<a name="l00320"></a>00320             <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.logStream &lt;&lt; <span class="stringliteral">&quot;eigen(): imprecise result detected (Q not orthog.)&quot;</span>
<a name="l00321"></a>00321                 &lt;&lt; s.str() &lt;&lt; std::endl;
<a name="l00322"></a>00322           ++res;
<a name="l00323"></a>00323         }
<a name="l00324"></a>00324       }
<a name="l00325"></a>00325     <span class="keywordflow">return</span> res;
<a name="l00326"></a>00326   }
<a name="l00327"></a>00327 
<a name="l00337"></a><a class="code" href="classCMAES.html#a6bb335a1116845d5ef1bb11fc3ac5cd1">00337</a>   <span class="keywordtype">void</span> <a class="code" href="classCMAES.html#a6bb335a1116845d5ef1bb11fc3ac5cd1" title="Symmetric tridiagonal QL algorithm, iterative.">ql</a>(T* d, T* e, T** V)
<a name="l00338"></a>00338   {
<a name="l00339"></a>00339     <span class="keyword">const</span> <span class="keywordtype">int</span> n = <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N;
<a name="l00340"></a>00340     T f(0);
<a name="l00341"></a>00341     T tst1(0);
<a name="l00342"></a>00342     <span class="keyword">const</span> T eps(2.22e-16); <span class="comment">// 2.0^-52.0 = 2.22e-16</span>
<a name="l00343"></a>00343 
<a name="l00344"></a>00344     <span class="comment">// shift input e</span>
<a name="l00345"></a>00345     T* ep1 = e;
<a name="l00346"></a>00346     <span class="keywordflow">for</span>(T *ep2 = e+1, *<span class="keyword">const</span> end = e+n; ep2 != end; ep1++, ep2++)
<a name="l00347"></a>00347       *ep1 = *ep2;
<a name="l00348"></a>00348     *ep1 = T(0); <span class="comment">// never changed again</span>
<a name="l00349"></a>00349 
<a name="l00350"></a>00350     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> l = 0; l &lt; n; l++)
<a name="l00351"></a>00351     {
<a name="l00352"></a>00352       <span class="comment">// find small subdiagonal element</span>
<a name="l00353"></a>00353       T&amp; el = e[l];
<a name="l00354"></a>00354       T&amp; dl = d[l];
<a name="l00355"></a>00355       <span class="keyword">const</span> T smallSDElement = std::fabs(dl) + std::fabs(el);
<a name="l00356"></a>00356       <span class="keywordflow">if</span>(tst1 &lt; smallSDElement)
<a name="l00357"></a>00357         tst1 = smallSDElement;
<a name="l00358"></a>00358       <span class="keyword">const</span> T epsTst1 = eps*tst1;
<a name="l00359"></a>00359       <span class="keywordtype">int</span> m = l;
<a name="l00360"></a>00360       <span class="keywordflow">while</span>(m &lt; n)
<a name="l00361"></a>00361       {
<a name="l00362"></a>00362         <span class="keywordflow">if</span>(std::fabs(e[m]) &lt;= epsTst1) <span class="keywordflow">break</span>;
<a name="l00363"></a>00363         m++;
<a name="l00364"></a>00364       }
<a name="l00365"></a>00365 
<a name="l00366"></a>00366       <span class="comment">// if m == l, d[l] is an eigenvalue, otherwise, iterate.</span>
<a name="l00367"></a>00367       <span class="keywordflow">if</span>(m &gt; l)
<a name="l00368"></a>00368       {
<a name="l00369"></a>00369         <span class="keywordflow">do</span> {
<a name="l00370"></a>00370           T h, g = dl;
<a name="l00371"></a>00371           T&amp; dl1r = d[l+1];
<a name="l00372"></a>00372           T p = (dl1r - g) / (T(2)*el);
<a name="l00373"></a>00373           T r = <a class="code" href="utils_8h.html#a3771e75fa9efbea03b99fe1ae4853072" title="sqrt(a^2 + b^2) numerically stable.">myhypot</a>(p, T(1));
<a name="l00374"></a>00374 
<a name="l00375"></a>00375           <span class="comment">// compute implicit shift</span>
<a name="l00376"></a>00376           <span class="keywordflow">if</span>(p &lt; 0) r = -r;
<a name="l00377"></a>00377           <span class="keyword">const</span> T pr = p+r;
<a name="l00378"></a>00378           dl = el/pr;
<a name="l00379"></a>00379           h = g - dl;
<a name="l00380"></a>00380           <span class="keyword">const</span> T dl1 = el*pr;
<a name="l00381"></a>00381           dl1r = dl1;
<a name="l00382"></a>00382           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = l+2; i &lt; n; i++) d[i] -= h;
<a name="l00383"></a>00383           f += h;
<a name="l00384"></a>00384 
<a name="l00385"></a>00385           <span class="comment">// implicit QL transformation.</span>
<a name="l00386"></a>00386           p = d[m];
<a name="l00387"></a>00387           T c(1);
<a name="l00388"></a>00388           T c2(1);
<a name="l00389"></a>00389           T c3(1);
<a name="l00390"></a>00390           <span class="keyword">const</span> T el1 = e[l+1];
<a name="l00391"></a>00391           T s(0);
<a name="l00392"></a>00392           T s2(0);
<a name="l00393"></a>00393           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = m-1; i &gt;= l; i--)
<a name="l00394"></a>00394           {
<a name="l00395"></a>00395             c3 = c2;
<a name="l00396"></a>00396             c2 = c;
<a name="l00397"></a>00397             s2 = s;
<a name="l00398"></a>00398             <span class="keyword">const</span> T&amp; ei = e[i];
<a name="l00399"></a>00399             g = c*ei;
<a name="l00400"></a>00400             h = c*p;
<a name="l00401"></a>00401             r = <a class="code" href="utils_8h.html#a3771e75fa9efbea03b99fe1ae4853072" title="sqrt(a^2 + b^2) numerically stable.">myhypot</a>(p, ei);
<a name="l00402"></a>00402             e[i+1] = s*r;
<a name="l00403"></a>00403             s = ei/r;
<a name="l00404"></a>00404             c = p/r;
<a name="l00405"></a>00405             <span class="keyword">const</span> T&amp; di = d[i];
<a name="l00406"></a>00406             p = c*di - s*g;
<a name="l00407"></a>00407             d[i+1] = h + s*(c*g + s*di);
<a name="l00408"></a>00408 
<a name="l00409"></a>00409             <span class="comment">// accumulate transformation.</span>
<a name="l00410"></a>00410             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; n; k++)
<a name="l00411"></a>00411             {
<a name="l00412"></a>00412               T&amp; Vki1 = V[k][i+1];
<a name="l00413"></a>00413               h = Vki1;
<a name="l00414"></a>00414               T&amp; Vki = V[k][i];
<a name="l00415"></a>00415               Vki1 = s*Vki + c*h;
<a name="l00416"></a>00416               Vki *= c; Vki -= s*h;
<a name="l00417"></a>00417             }
<a name="l00418"></a>00418           }
<a name="l00419"></a>00419           p = -s*s2*c3*el1*el/dl1;
<a name="l00420"></a>00420           el = s*p;
<a name="l00421"></a>00421           dl = c*p;
<a name="l00422"></a>00422         } <span class="keywordflow">while</span>(std::fabs(el) &gt; epsTst1);
<a name="l00423"></a>00423       }
<a name="l00424"></a>00424       dl += f;
<a name="l00425"></a>00425       el = 0.0;
<a name="l00426"></a>00426     }
<a name="l00427"></a>00427   }
<a name="l00428"></a>00428 
<a name="l00437"></a><a class="code" href="classCMAES.html#ae861a4dac0f11adfdc0096cfbcdcbd07">00437</a>   <span class="keywordtype">void</span> <a class="code" href="classCMAES.html#ae861a4dac0f11adfdc0096cfbcdcbd07" title="Householder transformation of a symmetric matrix V into tridiagonal form.">householder</a>(T** V, T* d, T* e)
<a name="l00438"></a>00438   {
<a name="l00439"></a>00439     <span class="keyword">const</span> <span class="keywordtype">int</span> n = <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N;
<a name="l00440"></a>00440 
<a name="l00441"></a>00441     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; n; j++)
<a name="l00442"></a>00442     {
<a name="l00443"></a>00443       d[j] = V[n - 1][j];
<a name="l00444"></a>00444     }
<a name="l00445"></a>00445 
<a name="l00446"></a>00446     <span class="comment">// Householder reduction to tridiagonal form</span>
<a name="l00447"></a>00447 
<a name="l00448"></a>00448     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = n - 1; i &gt; 0; i--)
<a name="l00449"></a>00449     {
<a name="l00450"></a>00450       <span class="comment">// scale to avoid under/overflow</span>
<a name="l00451"></a>00451       T scale = 0.0;
<a name="l00452"></a>00452       T h = 0.0;
<a name="l00453"></a>00453       <span class="keywordflow">for</span>(T *pd = d, *<span class="keyword">const</span> dend = d+i; pd != dend; pd++)
<a name="l00454"></a>00454       {
<a name="l00455"></a>00455         scale += std::fabs(*pd);
<a name="l00456"></a>00456       }
<a name="l00457"></a>00457       <span class="keywordflow">if</span>(scale == 0.0)
<a name="l00458"></a>00458       {
<a name="l00459"></a>00459         e[i] = d[i-1];
<a name="l00460"></a>00460         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; i; j++)
<a name="l00461"></a>00461         {
<a name="l00462"></a>00462           d[j] = V[i-1][j];
<a name="l00463"></a>00463           V[i][j] = 0.0;
<a name="l00464"></a>00464           V[j][i] = 0.0;
<a name="l00465"></a>00465         }
<a name="l00466"></a>00466       }
<a name="l00467"></a>00467       <span class="keywordflow">else</span>
<a name="l00468"></a>00468       {
<a name="l00469"></a>00469         <span class="comment">// generate Householder vector</span>
<a name="l00470"></a>00470         <span class="keywordflow">for</span>(T *pd = d, *<span class="keyword">const</span> dend = d+i; pd != dend; pd++)
<a name="l00471"></a>00471         {
<a name="l00472"></a>00472           *pd /= scale;
<a name="l00473"></a>00473           h += *pd * *pd;
<a name="l00474"></a>00474         }
<a name="l00475"></a>00475         T&amp; dim1 = d[i-1];
<a name="l00476"></a>00476         T f = dim1;
<a name="l00477"></a>00477         T g = f &gt; 0 ? -std::sqrt(h) : std::sqrt(h);
<a name="l00478"></a>00478         e[i] = scale*g;
<a name="l00479"></a>00479         h = h - f* g;
<a name="l00480"></a>00480         dim1 = f - g;
<a name="l00481"></a>00481         memset((<span class="keywordtype">void</span> *) e, 0, (<span class="keywordtype">size_t</span>)i*<span class="keyword">sizeof</span>(T));
<a name="l00482"></a>00482 
<a name="l00483"></a>00483         <span class="comment">// apply similarity transformation to remaining columns</span>
<a name="l00484"></a>00484         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; i; j++)
<a name="l00485"></a>00485         {
<a name="l00486"></a>00486           f = d[j];
<a name="l00487"></a>00487           V[j][i] = f;
<a name="l00488"></a>00488           T&amp; ej = e[j];
<a name="l00489"></a>00489           g = ej + V[j][j]* f;
<a name="l00490"></a>00490           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = j + 1; k &lt;= i - 1; k++)
<a name="l00491"></a>00491           {
<a name="l00492"></a>00492             T&amp; Vkj = V[k][j];
<a name="l00493"></a>00493             g += Vkj*d[k];
<a name="l00494"></a>00494             e[k] += Vkj*f;
<a name="l00495"></a>00495           }
<a name="l00496"></a>00496           ej = g;
<a name="l00497"></a>00497         }
<a name="l00498"></a>00498         f = 0.0;
<a name="l00499"></a>00499         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; i; j++)
<a name="l00500"></a>00500         {
<a name="l00501"></a>00501           T&amp; ej = e[j];
<a name="l00502"></a>00502           ej /= h;
<a name="l00503"></a>00503           f += ej* d[j];
<a name="l00504"></a>00504         }
<a name="l00505"></a>00505         T hh = f / (h + h);
<a name="l00506"></a>00506         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; i; j++)
<a name="l00507"></a>00507         {
<a name="l00508"></a>00508           e[j] -= hh*d[j];
<a name="l00509"></a>00509         }
<a name="l00510"></a>00510         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; i; j++)
<a name="l00511"></a>00511         {
<a name="l00512"></a>00512           T&amp; dj = d[j];
<a name="l00513"></a>00513           f = dj;
<a name="l00514"></a>00514           g = e[j];
<a name="l00515"></a>00515           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = j; k &lt;= i - 1; k++)
<a name="l00516"></a>00516           {
<a name="l00517"></a>00517             V[k][j] -= f*e[k] + g*d[k];
<a name="l00518"></a>00518           }
<a name="l00519"></a>00519           dj = V[i-1][j];
<a name="l00520"></a>00520           V[i][j] = 0.0;
<a name="l00521"></a>00521         }
<a name="l00522"></a>00522       }
<a name="l00523"></a>00523       d[i] = h;
<a name="l00524"></a>00524     }
<a name="l00525"></a>00525 
<a name="l00526"></a>00526     <span class="comment">// accumulate transformations</span>
<a name="l00527"></a>00527     <span class="keyword">const</span> <span class="keywordtype">int</span> nm1 = n-1;
<a name="l00528"></a>00528     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; nm1; i++)
<a name="l00529"></a>00529     {
<a name="l00530"></a>00530       T h;
<a name="l00531"></a>00531       T&amp; Vii = V[i][i];
<a name="l00532"></a>00532       V[n-1][i] = Vii;
<a name="l00533"></a>00533       Vii = 1.0;
<a name="l00534"></a>00534       h = d[i+1];
<a name="l00535"></a>00535       <span class="keywordflow">if</span>(h != 0.0)
<a name="l00536"></a>00536       {
<a name="l00537"></a>00537         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt;= i; k++)
<a name="l00538"></a>00538         {
<a name="l00539"></a>00539           d[k] = V[k][i+1] / h;
<a name="l00540"></a>00540         }
<a name="l00541"></a>00541         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt;= i; j++) {
<a name="l00542"></a>00542           T g = 0.0;
<a name="l00543"></a>00543           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt;= i; k++)
<a name="l00544"></a>00544           {
<a name="l00545"></a>00545             T* Vk = V[k];
<a name="l00546"></a>00546             g += Vk[i+1]* Vk[j];
<a name="l00547"></a>00547           }
<a name="l00548"></a>00548           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt;= i; k++)
<a name="l00549"></a>00549           {
<a name="l00550"></a>00550             V[k][j] -= g*d[k];
<a name="l00551"></a>00551           }
<a name="l00552"></a>00552         }
<a name="l00553"></a>00553       }
<a name="l00554"></a>00554       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt;= i; k++)
<a name="l00555"></a>00555       {
<a name="l00556"></a>00556         V[k][i+1] = 0.0;
<a name="l00557"></a>00557       }
<a name="l00558"></a>00558     }
<a name="l00559"></a>00559     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; n; j++)
<a name="l00560"></a>00560     {
<a name="l00561"></a>00561       T&amp; Vnm1j = V[n-1][j];
<a name="l00562"></a>00562       d[j] = Vnm1j;
<a name="l00563"></a>00563       Vnm1j = 0.0;
<a name="l00564"></a>00564     }
<a name="l00565"></a>00565     V[n-1][n-1] = 1.0;
<a name="l00566"></a>00566     e[0] = 0.0;
<a name="l00567"></a>00567   }
<a name="l00568"></a>00568 
<a name="l00572"></a><a class="code" href="classCMAES.html#a6ec64a4e6821b8d568a18acd524a7611">00572</a>   <span class="keywordtype">void</span> <a class="code" href="classCMAES.html#a6ec64a4e6821b8d568a18acd524a7611" title="Dirty index sort.">sortIndex</a>(<span class="keyword">const</span> T* rgFunVal, <span class="keywordtype">int</span>* iindex, <span class="keywordtype">int</span> n)
<a name="l00573"></a>00573   {
<a name="l00574"></a>00574     <span class="keywordtype">int</span> i, j;
<a name="l00575"></a>00575     <span class="keywordflow">for</span>(i = 1, iindex[0] = 0; i &lt; n; ++i)
<a name="l00576"></a>00576     {
<a name="l00577"></a>00577       <span class="keywordflow">for</span>(j = i; j &gt; 0; --j)
<a name="l00578"></a>00578       {
<a name="l00579"></a>00579         <span class="keywordflow">if</span>(rgFunVal[iindex[j - 1]] &lt; rgFunVal[i])
<a name="l00580"></a>00580           <span class="keywordflow">break</span>;
<a name="l00581"></a>00581         iindex[j] = iindex[j - 1]; <span class="comment">// shift up</span>
<a name="l00582"></a>00582       }
<a name="l00583"></a>00583       iindex[j] = i;
<a name="l00584"></a>00584     }
<a name="l00585"></a>00585   }
<a name="l00586"></a>00586 
<a name="l00587"></a><a class="code" href="classCMAES.html#a2865ab646d4cbab7fa8e9c965b3d2b84">00587</a>   <span class="keywordtype">void</span> <a class="code" href="classCMAES.html#a2865ab646d4cbab7fa8e9c965b3d2b84">adaptC2</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> hsig)
<a name="l00588"></a>00588   {
<a name="l00589"></a>00589     <span class="keyword">const</span> <span class="keywordtype">int</span> N = <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N;
<a name="l00590"></a>00590     <span class="keywordtype">bool</span> diag = <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.diagonalCov == 1 || <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.diagonalCov &gt;= <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a>;
<a name="l00591"></a>00591 
<a name="l00592"></a>00592     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.ccov != T(0))
<a name="l00593"></a>00593     {
<a name="l00594"></a>00594       <span class="comment">// definitions for speeding up inner-most loop</span>
<a name="l00595"></a>00595       <span class="keyword">const</span> T mucovinv = T(1)/<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.mucov;
<a name="l00596"></a>00596       <span class="keyword">const</span> T commonFactor = <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.ccov * (diag ? (N + T(1.5)) / T(3) : T(1));
<a name="l00597"></a>00597       <span class="keyword">const</span> T ccov1 = std::min(commonFactor*mucovinv, T(1));
<a name="l00598"></a>00598       <span class="keyword">const</span> T ccovmu = std::min(commonFactor*(T(1)-mucovinv), T(1)-ccov1);
<a name="l00599"></a>00599       <span class="keyword">const</span> T sigmasquare = <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>*<a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>;
<a name="l00600"></a>00600       <span class="keyword">const</span> T onemccov1ccovmu = T(1)-ccov1-ccovmu;
<a name="l00601"></a>00601       <span class="keyword">const</span> T longFactor = (T(1)-hsig)*<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.ccumcov*(T(2)-<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.ccumcov);
<a name="l00602"></a>00602 
<a name="l00603"></a>00603       <a class="code" href="classCMAES.html#ade7b4d250edba249dfcfdc2e2396246e">eigensysIsUptodate</a> = <span class="keyword">false</span>;
<a name="l00604"></a>00604 
<a name="l00605"></a>00605       <span class="comment">// update covariance matrix</span>
<a name="l00606"></a>00606       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; N; ++i)
<a name="l00607"></a>00607         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = diag ? i : 0; j &lt;= i; ++j)
<a name="l00608"></a>00608         {
<a name="l00609"></a>00609           T&amp; Cij = <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i][j];
<a name="l00610"></a>00610           Cij = onemccov1ccovmu*Cij + ccov1 * (<a class="code" href="classCMAES.html#a978c42dbaee69df8ac0cd5d480835579" title="Anisotropic evolution path (for covariance).">pc</a>[i]*<a class="code" href="classCMAES.html#a978c42dbaee69df8ac0cd5d480835579" title="Anisotropic evolution path (for covariance).">pc</a>[j] + longFactor*Cij);
<a name="l00611"></a>00611           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.mu; ++k)
<a name="l00612"></a>00612           { <span class="comment">// additional rank mu update</span>
<a name="l00613"></a>00613             <span class="keyword">const</span> T* rgrgxindexk = <a class="code" href="classCMAES.html#a46ee9e7f9bb10e7a32af8e991dbc3c4d" title="x-vectors, lambda offspring.">population</a>[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="Sorting index of sample population.">index</a>[k]];
<a name="l00614"></a>00614             Cij += ccovmu*<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.weights[k] * (rgrgxindexk[i] - <a class="code" href="classCMAES.html#a62c5a6a980a0a2fd13d3ba5b257dfc4f" title="Last mean.">xold</a>[i])
<a name="l00615"></a>00615                 * (rgrgxindexk[j] - <a class="code" href="classCMAES.html#a62c5a6a980a0a2fd13d3ba5b257dfc4f" title="Last mean.">xold</a>[j]) / sigmasquare;
<a name="l00616"></a>00616           }
<a name="l00617"></a>00617         }
<a name="l00618"></a>00618       <span class="comment">// update maximal and minimal diagonal value</span>
<a name="l00619"></a>00619       <a class="code" href="classCMAES.html#a93eee1dc0a955f05fcabb5db15b64886">maxdiagC</a> = <a class="code" href="classCMAES.html#a0fc9beb46f3685e1f49f2575de3ce026">mindiagC</a> = <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[0][0];
<a name="l00620"></a>00620       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1; i &lt; N; ++i)
<a name="l00621"></a>00621       {
<a name="l00622"></a>00622         <span class="keyword">const</span> T&amp; Cii = <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i][i];
<a name="l00623"></a>00623         <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a93eee1dc0a955f05fcabb5db15b64886">maxdiagC</a> &lt; Cii)
<a name="l00624"></a>00624           <a class="code" href="classCMAES.html#a93eee1dc0a955f05fcabb5db15b64886">maxdiagC</a> = Cii;
<a name="l00625"></a>00625         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a0fc9beb46f3685e1f49f2575de3ce026">mindiagC</a> &gt; Cii)
<a name="l00626"></a>00626           <a class="code" href="classCMAES.html#a0fc9beb46f3685e1f49f2575de3ce026">mindiagC</a> = Cii;
<a name="l00627"></a>00627       }
<a name="l00628"></a>00628     }
<a name="l00629"></a>00629   }
<a name="l00630"></a>00630 
<a name="l00634"></a><a class="code" href="classCMAES.html#a0acb1ad8ffd57032a1be02654a9d0d4a">00634</a>   <span class="keywordtype">void</span> <a class="code" href="classCMAES.html#a0acb1ad8ffd57032a1be02654a9d0d4a" title="Treats minimal standard deviations and numeric problems.">testMinStdDevs</a>(<span class="keywordtype">void</span>)
<a name="l00635"></a>00635   {
<a name="l00636"></a>00636     <span class="keywordflow">if</span>(!this-&gt;<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.rgDiffMinChange)
<a name="l00637"></a>00637       <span class="keywordflow">return</span>;
<a name="l00638"></a>00638 
<a name="l00639"></a>00639     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00640"></a>00640       <span class="keywordflow">while</span>(this-&gt;<a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>*std::sqrt(this-&gt;<a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i][i]) &lt; this-&gt;<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.rgDiffMinChange[i])
<a name="l00641"></a>00641         this-&gt;<a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a> *= std::exp(T(0.05) + this-&gt;<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.cs / this-&gt;params.damps);
<a name="l00642"></a>00642   }
<a name="l00643"></a>00643 
<a name="l00649"></a><a class="code" href="classCMAES.html#af5d3c51b5b233cb684ba40bfa564fc98">00649</a>   <span class="keywordtype">void</span> <a class="code" href="classCMAES.html#af5d3c51b5b233cb684ba40bfa564fc98" title="Adds the mutation sigma*B*(D*z).">addMutation</a>(T* x, T eps = 1.0)
<a name="l00650"></a>00650   {
<a name="l00651"></a>00651     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00652"></a>00652       <a class="code" href="classCMAES.html#a9aa6c060f3f33a4e07b20133c429b3bb" title="Temporary (random) vector used in different places.">tempRandom</a>[i] = <a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>[i]*<a class="code" href="classCMAES.html#a73e60929e1e08ea6f9f4a5cec6f020b4" title="CMA-ES parameters.">rand</a>.gauss();
<a name="l00653"></a>00653     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00654"></a>00654     {
<a name="l00655"></a>00655       T sum = 0.0;
<a name="l00656"></a>00656       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++j)
<a name="l00657"></a>00657         sum += <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="Matrix with normalize eigenvectors in columns.">B</a>[i][j]*<a class="code" href="classCMAES.html#a9aa6c060f3f33a4e07b20133c429b3bb" title="Temporary (random) vector used in different places.">tempRandom</a>[j];
<a name="l00658"></a>00658       x[i] = <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="Mean x vector, &quot;parent&quot;.">xmean</a>[i] + eps*<a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>*sum;
<a name="l00659"></a>00659     }
<a name="l00660"></a>00660   }
<a name="l00661"></a>00661 
<a name="l00668"></a><a class="code" href="classCMAES.html#a886643be9124a2910aa765ad04e4ca84">00668</a>   <span class="keywordtype">void</span> <a class="code" href="classCMAES.html#a886643be9124a2910aa765ad04e4ca84" title="This hack reads key words from input key for data to be written to a file, see file signals...">writeToStream</a>(<span class="keywordtype">int</span> key, std::ostream&amp; file)
<a name="l00669"></a>00669   {
<a name="l00670"></a>00670     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5aa149aa30989f563b45db616cf69a375b">WKResume</a>)
<a name="l00671"></a>00671     {
<a name="l00672"></a>00672       file &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;# resume &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N &lt;&lt; std::endl;
<a name="l00673"></a>00673       file &lt;&lt; <span class="stringliteral">&quot;xmean&quot;</span> &lt;&lt; std::endl;
<a name="l00674"></a>00674       <a class="code" href="classCMAES.html#a886643be9124a2910aa765ad04e4ca84" title="This hack reads key words from input key for data to be written to a file, see file signals...">writeToStream</a>(<a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5ab430a1a4c4f6030e67f76d49dc1acd76">WKXMean</a>, file);
<a name="l00675"></a>00675       file &lt;&lt; <span class="stringliteral">&quot;path for sigma&quot;</span> &lt;&lt; std::endl;
<a name="l00676"></a>00676       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00677"></a>00677         file &lt;&lt; <a class="code" href="classCMAES.html#ab025d43841c37ded96cdc76f834d82ba" title="Isotropic evolution path (for step length).">ps</a>[i] &lt;&lt; (i == <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N-1 ? <span class="stringliteral">&quot;\n&quot;</span> : <span class="stringliteral">&quot;\t&quot;</span>);
<a name="l00678"></a>00678       file &lt;&lt; <span class="stringliteral">&quot;path for C&quot;</span> &lt;&lt; std::endl;
<a name="l00679"></a>00679       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00680"></a>00680         file &lt;&lt; <a class="code" href="classCMAES.html#a978c42dbaee69df8ac0cd5d480835579" title="Anisotropic evolution path (for covariance).">pc</a>[i] &lt;&lt; (i == <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N-1 ? <span class="stringliteral">&quot;\n&quot;</span> : <span class="stringliteral">&quot;\t&quot;</span>);
<a name="l00681"></a>00681       file &lt;&lt; <span class="stringliteral">&quot;sigma &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a> &lt;&lt; std::endl;
<a name="l00682"></a>00682       <span class="comment">// note than B and D might not be up-to-date</span>
<a name="l00683"></a>00683       file &lt;&lt; <span class="stringliteral">&quot;covariance matrix&quot;</span> &lt;&lt; std::endl;
<a name="l00684"></a>00684       <a class="code" href="classCMAES.html#a886643be9124a2910aa765ad04e4ca84" title="This hack reads key words from input key for data to be written to a file, see file signals...">writeToStream</a>(<a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a61d330c96de9b673a0076606bea2b59b">WKC</a>, file);
<a name="l00685"></a>00685     }
<a name="l00686"></a>00686     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5ab430a1a4c4f6030e67f76d49dc1acd76">WKXMean</a>)
<a name="l00687"></a>00687     {
<a name="l00688"></a>00688       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00689"></a>00689         file &lt;&lt; (i == 0 ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;\t&quot;</span>) &lt;&lt; <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="Mean x vector, &quot;parent&quot;.">xmean</a>[i];
<a name="l00690"></a>00690       file &lt;&lt; std::endl;
<a name="l00691"></a>00691     }
<a name="l00692"></a>00692     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a61d330c96de9b673a0076606bea2b59b">WKC</a>)
<a name="l00693"></a>00693     {
<a name="l00694"></a>00694       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00695"></a>00695         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)
<a name="l00696"></a>00696         {
<a name="l00697"></a>00697           file &lt;&lt; <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i][j];
<a name="l00698"></a>00698           <span class="keywordflow">if</span>(j == i)
<a name="l00699"></a>00699             file &lt;&lt; std::endl;
<a name="l00700"></a>00700           <span class="keywordflow">else</span>
<a name="l00701"></a>00701             file &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;
<a name="l00702"></a>00702         }
<a name="l00703"></a>00703       file &lt;&lt; std::endl;
<a name="l00704"></a>00704     }
<a name="l00705"></a>00705     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5abbf04a8ffe5c7bccecf352e294e9c099">WKAll</a>)
<a name="l00706"></a>00706     {
<a name="l00707"></a>00707       time_t ti = time(0);
<a name="l00708"></a>00708       file &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;# --------- &quot;</span> &lt;&lt; asctime(localtime(&amp;ti)) &lt;&lt; std::endl;
<a name="l00709"></a>00709       file &lt;&lt; <span class="stringliteral">&quot; N &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N &lt;&lt; std::endl;
<a name="l00710"></a>00710       file &lt;&lt; <span class="stringliteral">&quot;function evaluations &quot;</span> &lt;&lt; (long) <a class="code" href="classCMAES.html#a4e328b09739d2fb1a220a3d7cf4bc82c" title="objective function evaluations">countevals</a> &lt;&lt; std::endl;
<a name="l00711"></a>00711       file &lt;&lt; <span class="stringliteral">&quot;elapsed (CPU) time [s] &quot;</span> &lt;&lt; std::setprecision(2) &lt;&lt; <a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">eigenTimings</a>.<a class="code" href="classTiming.html#aaf5612cb0d03c6b03c904f574fdcc929" title="zeroed by re-calling timings_start">totaltotaltime</a> &lt;&lt; std::endl;
<a name="l00712"></a>00712       file &lt;&lt; <span class="stringliteral">&quot;function value f(x)=&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a46ee9e7f9bb10e7a32af8e991dbc3c4d" title="x-vectors, lambda offspring.">population</a>[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="Sorting index of sample population.">index</a>[0]][<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N] &lt;&lt; std::endl;
<a name="l00713"></a>00713       file &lt;&lt; <span class="stringliteral">&quot;maximal standard deviation &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#a93eee1dc0a955f05fcabb5db15b64886">maxdiagC</a>) &lt;&lt; std::endl;
<a name="l00714"></a>00714       file &lt;&lt; <span class="stringliteral">&quot;minimal standard deviation &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#a0fc9beb46f3685e1f49f2575de3ce026">mindiagC</a>) &lt;&lt; std::endl;
<a name="l00715"></a>00715       file &lt;&lt; <span class="stringliteral">&quot;sigma &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a> &lt;&lt; std::endl;
<a name="l00716"></a>00716       file &lt;&lt; <span class="stringliteral">&quot;axisratio &quot;</span> &lt;&lt; (<a class="code" href="utils_8h.html#a607a38043b6aa6f8501b8bfca777536f">maxElement</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>, <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N) / <a class="code" href="utils_8h.html#a5ab74da4f5c22d49151fd4c7c9a41dee">minElement</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>, <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N)) &lt;&lt; std::endl;
<a name="l00717"></a>00717       file &lt;&lt; <span class="stringliteral">&quot;xbestever found after &quot;</span> &lt;&lt; std::setprecision(0) &lt;&lt; <a class="code" href="classCMAES.html#a0b94ac84584f832f79084141bc768068" title="Best sample ever.">xBestEver</a>[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N+1]
<a name="l00718"></a>00718           &lt;&lt; <span class="stringliteral">&quot;evaluations, function value &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a0b94ac84584f832f79084141bc768068" title="Best sample ever.">xBestEver</a>[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N] &lt;&lt; std::endl;
<a name="l00719"></a>00719       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00720"></a>00720         file &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::setw(12) &lt;&lt; <a class="code" href="classCMAES.html#a0b94ac84584f832f79084141bc768068" title="Best sample ever.">xBestEver</a>[i] &lt;&lt; (i % 5 == 4 || i == <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N-1 ? <span class="charliteral">&#39;\n&#39;</span> : <span class="charliteral">&#39; &#39;</span>);
<a name="l00721"></a>00721       file &lt;&lt; <span class="stringliteral">&quot;xbest (of last generation, function value &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a46ee9e7f9bb10e7a32af8e991dbc3c4d" title="x-vectors, lambda offspring.">population</a>[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="Sorting index of sample population.">index</a>[0]][<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N] &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;
<a name="l00722"></a>00722       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00723"></a>00723         file &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::setw(12) &lt;&lt; <a class="code" href="classCMAES.html#a46ee9e7f9bb10e7a32af8e991dbc3c4d" title="x-vectors, lambda offspring.">population</a>[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="Sorting index of sample population.">index</a>[0]][i] &lt;&lt; (i % 5 == 4 || i == <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N-1 ? <span class="charliteral">&#39;\n&#39;</span> : <span class="charliteral">&#39; &#39;</span>);
<a name="l00724"></a>00724       file &lt;&lt; <span class="stringliteral">&quot;xmean&quot;</span> &lt;&lt; std::endl;
<a name="l00725"></a>00725       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00726"></a>00726         file &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::setw(12) &lt;&lt; <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="Mean x vector, &quot;parent&quot;.">xmean</a>[i] &lt;&lt; (i % 5 == 4 || i == <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N-1 ? <span class="charliteral">&#39;\n&#39;</span> : <span class="charliteral">&#39; &#39;</span>);
<a name="l00727"></a>00727       file &lt;&lt; <span class="stringliteral">&quot;Standard deviation of coordinate axes (sigma*sqrt(diag(C)))&quot;</span> &lt;&lt; std::endl;
<a name="l00728"></a>00728       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00729"></a>00729         file &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::setw(12) &lt;&lt; <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i][i]) &lt;&lt; (i % 5 == 4 || i == <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N-1 ? <span class="charliteral">&#39;\n&#39;</span> : <span class="charliteral">&#39; &#39;</span>);
<a name="l00730"></a>00730       file &lt;&lt; <span class="stringliteral">&quot;Main axis lengths of mutation ellipsoid (sigma*diag(D))&quot;</span> &lt;&lt; std::endl;
<a name="l00731"></a>00731       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00732"></a>00732           <a class="code" href="classCMAES.html#a9aa6c060f3f33a4e07b20133c429b3bb" title="Temporary (random) vector used in different places.">tempRandom</a>[i] = <a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>[i];
<a name="l00733"></a>00733       std::sort(<a class="code" href="classCMAES.html#a9aa6c060f3f33a4e07b20133c429b3bb" title="Temporary (random) vector used in different places.">tempRandom</a>, <a class="code" href="classCMAES.html#a9aa6c060f3f33a4e07b20133c429b3bb" title="Temporary (random) vector used in different places.">tempRandom</a> + <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N);
<a name="l00734"></a>00734       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00735"></a>00735         file &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::setw(12) &lt;&lt; <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>*<a class="code" href="classCMAES.html#a9aa6c060f3f33a4e07b20133c429b3bb" title="Temporary (random) vector used in different places.">tempRandom</a>[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N-1-i] &lt;&lt; (i % 5 == 4 || i == <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N-1 ? <span class="charliteral">&#39;\n&#39;</span> : <span class="charliteral">&#39; &#39;</span>);
<a name="l00736"></a>00736       file &lt;&lt; <span class="stringliteral">&quot;Longest axis (b_i where d_ii=max(diag(D))&quot;</span> &lt;&lt; std::endl;
<a name="l00737"></a>00737       <span class="keywordtype">int</span> k = <a class="code" href="utils_8h.html#add614d252f8c2ae3543a6771602d2d59">maxIndex</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>, <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N);
<a name="l00738"></a>00738       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00739"></a>00739         file &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::setw(12) &lt;&lt; <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="Matrix with normalize eigenvectors in columns.">B</a>[i][k] &lt;&lt; (i % 5 == 4 || i == <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N-1 ? <span class="charliteral">&#39;\n&#39;</span> : <span class="charliteral">&#39; &#39;</span>);
<a name="l00740"></a>00740       file &lt;&lt; <span class="stringliteral">&quot;Shortest axis (b_i where d_ii=max(diag(D))&quot;</span> &lt;&lt; std::endl;
<a name="l00741"></a>00741       k = <a class="code" href="utils_8h.html#a6613dfd27c8d1c4238f313b5b33da2a3">minIndex</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>, <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N);
<a name="l00742"></a>00742       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00743"></a>00743         file &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::setw(12) &lt;&lt; <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="Matrix with normalize eigenvectors in columns.">B</a>[i][k] &lt;&lt; (i % 5 == 4 || i == <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N-1 ? <span class="charliteral">&#39;\n&#39;</span> : <span class="charliteral">&#39; &#39;</span>);
<a name="l00744"></a>00744       file &lt;&lt; std::endl;
<a name="l00745"></a>00745     }
<a name="l00746"></a>00746     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a07d0282b9c7d9719df60fbc03f5a6eab">WKFewInfo</a>)
<a name="l00747"></a>00747     {
<a name="l00748"></a>00748       file &lt;&lt; <span class="stringliteral">&quot; Iter\tFevals\tFunction Value\tSigma\tMaxCoorDev\tMinCoorDev\t&quot;</span>
<a name="l00749"></a>00749           &lt;&lt; <span class="stringliteral">&quot;AxisRatio\tMinDii\tTime in eig&quot;</span> &lt;&lt; std::endl;
<a name="l00750"></a>00750       file &lt;&lt; std::endl;
<a name="l00751"></a>00751     }
<a name="l00752"></a>00752     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5ac8b7485532d066b19565db85e060aeac">WKFew</a>)
<a name="l00753"></a>00753     {
<a name="l00754"></a>00754       file &lt;&lt; (int) <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; (<span class="keywordtype">int</span>) <a class="code" href="classCMAES.html#a4e328b09739d2fb1a220a3d7cf4bc82c" title="objective function evaluations">countevals</a> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>
<a name="l00755"></a>00755           &lt;&lt; <a class="code" href="classCMAES.html#aa1ad648deeabde4621b932ec378551fc" title="Objective function values of the population.">functionValues</a>[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="Sorting index of sample population.">index</a>[0]] &lt;&lt; <span class="stringliteral">&quot;\t\t&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a> &lt;&lt; <span class="stringliteral">&quot;  &quot;</span>
<a name="l00756"></a>00756           &lt;&lt; <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#a93eee1dc0a955f05fcabb5db15b64886">maxdiagC</a>) &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#a0fc9beb46f3685e1f49f2575de3ce026">mindiagC</a>)
<a name="l00757"></a>00757           &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; std::scientific &lt;&lt; std::setprecision(2)
<a name="l00758"></a>00758           &lt;&lt; std::sqrt(<a class="code" href="classCMAES.html#ae36bc85cdd41cb3db39b99a0303f6b6e">maxEW</a> / <a class="code" href="classCMAES.html#a9796be17293ba4549946392565368f41">minEW</a>) &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; std::sqrt(<a class="code" href="classCMAES.html#a9796be17293ba4549946392565368f41">minEW</a>)
<a name="l00759"></a>00759           &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">eigenTimings</a>.<a class="code" href="classTiming.html#aaf5612cb0d03c6b03c904f574fdcc929" title="zeroed by re-calling timings_start">totaltotaltime</a>;
<a name="l00760"></a>00760       file &lt;&lt; std::endl;
<a name="l00761"></a>00761     }
<a name="l00762"></a>00762     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a92d1998fb46900bceb39a60e3ed35746">WKEval</a>)
<a name="l00763"></a>00763     {
<a name="l00764"></a>00764       file &lt;&lt; <a class="code" href="classCMAES.html#a4e328b09739d2fb1a220a3d7cf4bc82c" title="objective function evaluations">countevals</a>;
<a name="l00765"></a>00765       file &lt;&lt; std::endl;
<a name="l00766"></a>00766     }
<a name="l00767"></a>00767     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a3bab88222e97d560b05cdcd7f5d967f0">WKFitness</a>)
<a name="l00768"></a>00768     {
<a name="l00769"></a>00769       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00770"></a>00770         file &lt;&lt; (i == 0 ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;\t&quot;</span>) &lt;&lt; <a class="code" href="classCMAES.html#aa1ad648deeabde4621b932ec378551fc" title="Objective function values of the population.">functionValues</a>[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="Sorting index of sample population.">index</a>[i]];
<a name="l00771"></a>00771       file &lt;&lt; std::endl;
<a name="l00772"></a>00772     }
<a name="l00773"></a>00773     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a689dedaccffee9f44f969a838f62b2a3">WKFBestEver</a>)
<a name="l00774"></a>00774     {
<a name="l00775"></a>00775       file &lt;&lt; <a class="code" href="classCMAES.html#a0b94ac84584f832f79084141bc768068" title="Best sample ever.">xBestEver</a>[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N] &lt;&lt; std::endl;
<a name="l00776"></a>00776     }
<a name="l00777"></a>00777     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5af74d31e6940d9c55b13935971bfd764d">WKCGeneration</a>)
<a name="l00778"></a>00778     {
<a name="l00779"></a>00779       file &lt;&lt; <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a> &lt;&lt; std::endl;
<a name="l00780"></a>00780     }
<a name="l00781"></a>00781     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a393a8956a826379f2918b1a0193ceead">WKSigma</a>)
<a name="l00782"></a>00782     {
<a name="l00783"></a>00783       file &lt;&lt; <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a> &lt;&lt; std::endl;
<a name="l00784"></a>00784     }
<a name="l00785"></a>00785     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5ab3b3919789e241ae3ae2c855d17c7528">WKLambda</a>)
<a name="l00786"></a>00786     {
<a name="l00787"></a>00787       file &lt;&lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.lambda &lt;&lt; std::endl;
<a name="l00788"></a>00788     }
<a name="l00789"></a>00789     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a407d38eb1d75495aa388416be4fb9673">WKB</a>)
<a name="l00790"></a>00790     {
<a name="l00791"></a>00791       <span class="keywordtype">int</span>* iindex = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N];
<a name="l00792"></a>00792       <a class="code" href="classCMAES.html#a6ec64a4e6821b8d568a18acd524a7611" title="Dirty index sort.">sortIndex</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>, iindex, <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N);
<a name="l00793"></a>00793       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00794"></a>00794         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++j)
<a name="l00795"></a>00795         {
<a name="l00796"></a>00796           file &lt;&lt; <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="Matrix with normalize eigenvectors in columns.">B</a>[j][iindex[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N-1-i]];
<a name="l00797"></a>00797           <span class="keywordflow">if</span>(j != <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N-1)
<a name="l00798"></a>00798             file &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;
<a name="l00799"></a>00799           <span class="keywordflow">else</span>
<a name="l00800"></a>00800             file &lt;&lt; std::endl;
<a name="l00801"></a>00801         }
<a name="l00802"></a>00802       <span class="keyword">delete</span>[] iindex;
<a name="l00803"></a>00803       iindex = 0;
<a name="l00804"></a>00804       file &lt;&lt; std::endl;
<a name="l00805"></a>00805     }
<a name="l00806"></a>00806     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a9b15493966d6f12f6e3135046cd6ae24">WKXBest</a>)
<a name="l00807"></a>00807     {
<a name="l00808"></a>00808       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00809"></a>00809         file &lt;&lt; (i == 0 ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;\t&quot;</span>) &lt;&lt; <a class="code" href="classCMAES.html#a46ee9e7f9bb10e7a32af8e991dbc3c4d" title="x-vectors, lambda offspring.">population</a>[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="Sorting index of sample population.">index</a>[0]][i];
<a name="l00810"></a>00810       file &lt;&lt; std::endl;
<a name="l00811"></a>00811     }
<a name="l00812"></a>00812     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a939618e4c01b55a93ead6992a16e7d80">WKClock</a>)
<a name="l00813"></a>00813     {
<a name="l00814"></a>00814       <a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">eigenTimings</a>.<a class="code" href="classTiming.html#a9973978adb63702db5affd6f77b98fc5">update</a>();
<a name="l00815"></a>00815       file &lt;&lt; <a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">eigenTimings</a>.<a class="code" href="classTiming.html#aaf5612cb0d03c6b03c904f574fdcc929" title="zeroed by re-calling timings_start">totaltotaltime</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">eigenTimings</a>.<a class="code" href="classTiming.html#adfb11a76f87914807cdfe39bcef0a0af">tictoctime</a>
<a name="l00816"></a>00816           &lt;&lt; std::endl;
<a name="l00817"></a>00817     }
<a name="l00818"></a>00818     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a7213701c32edd96cbca9697368af03ae">WKDim</a>)
<a name="l00819"></a>00819     {
<a name="l00820"></a>00820       file &lt;&lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N;
<a name="l00821"></a>00821       file &lt;&lt; std::endl;
<a name="l00822"></a>00822     }
<a name="l00823"></a>00823   }
<a name="l00824"></a>00824 
<a name="l00825"></a>00825 <span class="keyword">public</span>:
<a name="l00826"></a>00826 
<a name="l00827"></a><a class="code" href="classCMAES.html#a4e328b09739d2fb1a220a3d7cf4bc82c">00827</a>   T <a class="code" href="classCMAES.html#a4e328b09739d2fb1a220a3d7cf4bc82c" title="objective function evaluations">countevals</a>; 
<a name="l00828"></a><a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">00828</a>   <a class="code" href="classTiming.html" title="A class for time measurements of the eigen decomposition.">Timing</a> <a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">eigenTimings</a>;
<a name="l00829"></a>00829 
<a name="l00830"></a><a class="code" href="classCMAES.html#aff85cc1b8fd2403a6b54829ffbf01b6f">00830</a>   <a class="code" href="classCMAES.html#aff85cc1b8fd2403a6b54829ffbf01b6f">CMAES</a>()
<a name="l00831"></a>00831     : <a class="code" href="classCMAES.html#a39f33a47d224feccbb0f31bc3b24f922" title="Implementation version.">version</a>(<span class="stringliteral">&quot;1.0alpha&quot;</span>)
<a name="l00832"></a>00832   {
<a name="l00833"></a>00833   }
<a name="l00834"></a>00834 
<a name="l00839"></a><a class="code" href="classCMAES.html#a1dafd6714642367224020c2b8bd6573a">00839</a>   <a class="code" href="classCMAES.html#a1dafd6714642367224020c2b8bd6573a" title="Releases the dynamically allocated memory, including that of the return value of init().">~CMAES</a>()
<a name="l00840"></a>00840   {
<a name="l00841"></a>00841     <span class="keyword">delete</span>[] <a class="code" href="classCMAES.html#a978c42dbaee69df8ac0cd5d480835579" title="Anisotropic evolution path (for covariance).">pc</a>;
<a name="l00842"></a>00842     <span class="keyword">delete</span>[] <a class="code" href="classCMAES.html#ab025d43841c37ded96cdc76f834d82ba" title="Isotropic evolution path (for step length).">ps</a>;
<a name="l00843"></a>00843     <span class="keyword">delete</span>[] <a class="code" href="classCMAES.html#a9aa6c060f3f33a4e07b20133c429b3bb" title="Temporary (random) vector used in different places.">tempRandom</a>;
<a name="l00844"></a>00844     <span class="keyword">delete</span>[] <a class="code" href="classCMAES.html#a73714d5cec116bef33aed344991536a2" title="B*D*z.">BDz</a>;
<a name="l00845"></a>00845     <span class="keyword">delete</span>[] --<a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="Mean x vector, &quot;parent&quot;.">xmean</a>;
<a name="l00846"></a>00846     <span class="keyword">delete</span>[] --<a class="code" href="classCMAES.html#a62c5a6a980a0a2fd13d3ba5b257dfc4f" title="Last mean.">xold</a>;
<a name="l00847"></a>00847     <span class="keyword">delete</span>[] --<a class="code" href="classCMAES.html#a0b94ac84584f832f79084141bc768068" title="Best sample ever.">xBestEver</a>;
<a name="l00848"></a>00848     <span class="keyword">delete</span>[] --<a class="code" href="classCMAES.html#aeb4c1c5be50edcc7ed39c9599191c3e5" title="Output vector.">output</a>;
<a name="l00849"></a>00849     <span class="keyword">delete</span>[] <a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>;
<a name="l00850"></a>00850     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00851"></a>00851     {
<a name="l00852"></a>00852       <span class="keyword">delete</span>[] <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i];
<a name="l00853"></a>00853       <span class="keyword">delete</span>[] <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="Matrix with normalize eigenvectors in columns.">B</a>[i];
<a name="l00854"></a>00854     }
<a name="l00855"></a>00855     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.lambda; ++i)
<a name="l00856"></a>00856       <span class="keyword">delete</span>[] --<a class="code" href="classCMAES.html#a46ee9e7f9bb10e7a32af8e991dbc3c4d" title="x-vectors, lambda offspring.">population</a>[i];
<a name="l00857"></a>00857     <span class="keyword">delete</span>[] <a class="code" href="classCMAES.html#a46ee9e7f9bb10e7a32af8e991dbc3c4d" title="x-vectors, lambda offspring.">population</a>;
<a name="l00858"></a>00858     <span class="keyword">delete</span>[] <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>;
<a name="l00859"></a>00859     <span class="keyword">delete</span>[] <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="Matrix with normalize eigenvectors in columns.">B</a>;
<a name="l00860"></a>00860     <span class="keyword">delete</span>[] <a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="Sorting index of sample population.">index</a>;
<a name="l00861"></a>00861     <span class="keyword">delete</span>[] <a class="code" href="classCMAES.html#a4ed94ed86d47a4903cb11eacd1f703e5">publicFitness</a>;
<a name="l00862"></a>00862     <span class="keyword">delete</span>[] --<a class="code" href="classCMAES.html#aa1ad648deeabde4621b932ec378551fc" title="Objective function values of the population.">functionValues</a>;
<a name="l00863"></a>00863     <span class="keyword">delete</span>[] --<a class="code" href="classCMAES.html#a2e91522e80428b2abd40947b2fb3ed4e" title="History of function values.">funcValueHistory</a>;
<a name="l00864"></a>00864   }
<a name="l00865"></a>00865 
<a name="l00873"></a><a class="code" href="classCMAES.html#ad9f4e1888c672a88821fef4de2d71193">00873</a>   T* <a class="code" href="classCMAES.html#ad9f4e1888c672a88821fef4de2d71193" title="Initializes the CMA-ES algorithm.">init</a>(<span class="keyword">const</span> <a class="code" href="classParameters.html" title="Holds all parameters that can be adjusted by the user.">Parameters&lt;T&gt;</a>&amp; parameters)
<a name="l00874"></a>00874   {
<a name="l00875"></a>00875     <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a> = parameters;
<a name="l00876"></a>00876 
<a name="l00877"></a>00877     <a class="code" href="classCMAES.html#a0146e5c3a576c5f04e33c0ec3978a2e8" title="A message that contains all matched stop criteria.">stopMessage</a> = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00878"></a>00878 
<a name="l00879"></a>00879     T trace(0);
<a name="l00880"></a>00880     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00881"></a>00881       trace += <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.rgInitialStds[i]*<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.rgInitialStds[i];
<a name="l00882"></a>00882     <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a> = std::sqrt(trace/<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N);
<a name="l00883"></a>00883 
<a name="l00884"></a>00884     <a class="code" href="classCMAES.html#af5aff4dfec9d1eabe488c5f03395158f">chiN</a> = std::sqrt((T) <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N) * (T(1) - T(1)/(T(4)*<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N) + T(1)/(T(21)*<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N*<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N));
<a name="l00885"></a>00885     <a class="code" href="classCMAES.html#ade7b4d250edba249dfcfdc2e2396246e">eigensysIsUptodate</a> = <span class="keyword">true</span>;
<a name="l00886"></a>00886     <a class="code" href="classCMAES.html#a09f393f2ef964f14f6b668bc91657650" title="control via signals.par">doCheckEigen</a> = <span class="keyword">false</span>;
<a name="l00887"></a>00887     <a class="code" href="classCMAES.html#a6f4acfc9073c8320c00bb0faa9efcdcb">genOfEigensysUpdate</a> = 0;
<a name="l00888"></a>00888     <a class="code" href="classCMAES.html#a5ef76c4c2d5833429dc868ed8d2c6709">isResumeDone</a> = <span class="keyword">false</span>;
<a name="l00889"></a>00889 
<a name="l00890"></a>00890     T dtest;
<a name="l00891"></a>00891     <span class="keywordflow">for</span>(dtest = T(1); dtest &amp;&amp; dtest &lt; T(1.1)*dtest; dtest *= T(2))
<a name="l00892"></a>00892       <span class="keywordflow">if</span>(dtest == dtest + T(1))
<a name="l00893"></a>00893         <span class="keywordflow">break</span>;
<a name="l00894"></a>00894     <a class="code" href="classCMAES.html#ae2163bc8eb11b8d28662ae985f51429b">dMaxSignifKond</a> = dtest / T(1000); <span class="comment">// not sure whether this is really save, 100 does not work well enough</span>
<a name="l00895"></a>00895 
<a name="l00896"></a>00896     <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a> = 0;
<a name="l00897"></a>00897     <a class="code" href="classCMAES.html#a4e328b09739d2fb1a220a3d7cf4bc82c" title="objective function evaluations">countevals</a> = 0;
<a name="l00898"></a>00898     <a class="code" href="classCMAES.html#a2259ba2fee168dac1aed9a5de7e9703e">state</a> = <a class="code" href="classCMAES.html#a0cef0210cdaaf09dd1d40daf33127765acdf19eb2e5b851d7af910fa38ac814e7">INITIALIZED</a>;
<a name="l00899"></a>00899     <a class="code" href="classCMAES.html#a89e9afdc9f28b153f6939039117080f1">dLastMinEWgroesserNull</a> = T(1);
<a name="l00900"></a>00900     <a class="code" href="classCMAES.html#a31915e1cc29d88faee41c1f45d3d5a2a">printtime</a> = <a class="code" href="classCMAES.html#a9f27aaa233806a6823b96d83059c68e1" title="ideally should keep track for each output file">writetime</a> = <a class="code" href="classCMAES.html#a72e456703b11bdcd7c273a2b764faf70">firstwritetime</a> = <a class="code" href="classCMAES.html#ae5b668b5b4bacd4048c6742650801356">firstprinttime</a> = 0;
<a name="l00901"></a>00901 
<a name="l00902"></a>00902     <a class="code" href="classCMAES.html#a978c42dbaee69df8ac0cd5d480835579" title="Anisotropic evolution path (for covariance).">pc</a> = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N];
<a name="l00903"></a>00903     <a class="code" href="classCMAES.html#ab025d43841c37ded96cdc76f834d82ba" title="Isotropic evolution path (for step length).">ps</a> = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N];
<a name="l00904"></a>00904     <a class="code" href="classCMAES.html#a9aa6c060f3f33a4e07b20133c429b3bb" title="Temporary (random) vector used in different places.">tempRandom</a> = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N+1];
<a name="l00905"></a>00905     <a class="code" href="classCMAES.html#a73714d5cec116bef33aed344991536a2" title="B*D*z.">BDz</a> = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N];
<a name="l00906"></a>00906     <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="Mean x vector, &quot;parent&quot;.">xmean</a> = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N+2];
<a name="l00907"></a>00907     <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="Mean x vector, &quot;parent&quot;.">xmean</a>[0] = <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N;
<a name="l00908"></a>00908     ++<a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="Mean x vector, &quot;parent&quot;.">xmean</a>;
<a name="l00909"></a>00909     <a class="code" href="classCMAES.html#a62c5a6a980a0a2fd13d3ba5b257dfc4f" title="Last mean.">xold</a> = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N+2];
<a name="l00910"></a>00910     <a class="code" href="classCMAES.html#a62c5a6a980a0a2fd13d3ba5b257dfc4f" title="Last mean.">xold</a>[0] = <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N;
<a name="l00911"></a>00911     ++<a class="code" href="classCMAES.html#a62c5a6a980a0a2fd13d3ba5b257dfc4f" title="Last mean.">xold</a>;
<a name="l00912"></a>00912     <a class="code" href="classCMAES.html#a0b94ac84584f832f79084141bc768068" title="Best sample ever.">xBestEver</a> = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N+3];
<a name="l00913"></a>00913     <a class="code" href="classCMAES.html#a0b94ac84584f832f79084141bc768068" title="Best sample ever.">xBestEver</a>[0] = <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N;
<a name="l00914"></a>00914     ++<a class="code" href="classCMAES.html#a0b94ac84584f832f79084141bc768068" title="Best sample ever.">xBestEver</a>;
<a name="l00915"></a>00915     <a class="code" href="classCMAES.html#a0b94ac84584f832f79084141bc768068" title="Best sample ever.">xBestEver</a>[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N] = std::numeric_limits&lt;T&gt;::max();
<a name="l00916"></a>00916     <a class="code" href="classCMAES.html#aeb4c1c5be50edcc7ed39c9599191c3e5" title="Output vector.">output</a> = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N+2];
<a name="l00917"></a>00917     <a class="code" href="classCMAES.html#aeb4c1c5be50edcc7ed39c9599191c3e5" title="Output vector.">output</a>[0] = <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N;
<a name="l00918"></a>00918     ++<a class="code" href="classCMAES.html#aeb4c1c5be50edcc7ed39c9599191c3e5" title="Output vector.">output</a>;
<a name="l00919"></a>00919     <a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a> = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N];
<a name="l00920"></a>00920     <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a> = <span class="keyword">new</span> T*[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N];
<a name="l00921"></a>00921     <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="Matrix with normalize eigenvectors in columns.">B</a> = <span class="keyword">new</span> T*[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N];
<a name="l00922"></a>00922     <a class="code" href="classCMAES.html#a4ed94ed86d47a4903cb11eacd1f703e5">publicFitness</a> = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.lambda];
<a name="l00923"></a>00923     <a class="code" href="classCMAES.html#aa1ad648deeabde4621b932ec378551fc" title="Objective function values of the population.">functionValues</a> = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.lambda+1];
<a name="l00924"></a>00924     <a class="code" href="classCMAES.html#aa1ad648deeabde4621b932ec378551fc" title="Objective function values of the population.">functionValues</a>[0] = <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.lambda;
<a name="l00925"></a>00925     ++<a class="code" href="classCMAES.html#aa1ad648deeabde4621b932ec378551fc" title="Objective function values of the population.">functionValues</a>;
<a name="l00926"></a>00926     <span class="keyword">const</span> <span class="keywordtype">int</span> historySize = 10 + (int) ceil(3.*10.*<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N/<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.lambda);
<a name="l00927"></a>00927     <a class="code" href="classCMAES.html#a2e91522e80428b2abd40947b2fb3ed4e" title="History of function values.">funcValueHistory</a> = <span class="keyword">new</span> T[historySize + 1];
<a name="l00928"></a>00928     <a class="code" href="classCMAES.html#a2e91522e80428b2abd40947b2fb3ed4e" title="History of function values.">funcValueHistory</a>[0] = (T) historySize;
<a name="l00929"></a>00929     <a class="code" href="classCMAES.html#a2e91522e80428b2abd40947b2fb3ed4e" title="History of function values.">funcValueHistory</a>++;
<a name="l00930"></a>00930 
<a name="l00931"></a>00931     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00932"></a>00932     {
<a name="l00933"></a>00933       <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i] = <span class="keyword">new</span> T[i+1];
<a name="l00934"></a>00934       <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="Matrix with normalize eigenvectors in columns.">B</a>[i] = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N];
<a name="l00935"></a>00935     }
<a name="l00936"></a>00936     <a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="Sorting index of sample population.">index</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.lambda];
<a name="l00937"></a>00937     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.lambda; ++i)
<a name="l00938"></a>00938         <a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="Sorting index of sample population.">index</a>[i] = i;
<a name="l00939"></a>00939     <a class="code" href="classCMAES.html#a46ee9e7f9bb10e7a32af8e991dbc3c4d" title="x-vectors, lambda offspring.">population</a> = <span class="keyword">new</span> T*[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.lambda];
<a name="l00940"></a>00940     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.lambda; ++i)
<a name="l00941"></a>00941     {
<a name="l00942"></a>00942       <a class="code" href="classCMAES.html#a46ee9e7f9bb10e7a32af8e991dbc3c4d" title="x-vectors, lambda offspring.">population</a>[i] = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N+2];
<a name="l00943"></a>00943       <a class="code" href="classCMAES.html#a46ee9e7f9bb10e7a32af8e991dbc3c4d" title="x-vectors, lambda offspring.">population</a>[i][0] = <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N;
<a name="l00944"></a>00944       <a class="code" href="classCMAES.html#a46ee9e7f9bb10e7a32af8e991dbc3c4d" title="x-vectors, lambda offspring.">population</a>[i]++;
<a name="l00945"></a>00945       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; j++)
<a name="l00946"></a>00946         <a class="code" href="classCMAES.html#a46ee9e7f9bb10e7a32af8e991dbc3c4d" title="x-vectors, lambda offspring.">population</a>[i][j] = 0.0;
<a name="l00947"></a>00947     }
<a name="l00948"></a>00948 
<a name="l00949"></a>00949     <span class="comment">// initialize newed space</span>
<a name="l00950"></a>00950     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.lambda; i++)
<a name="l00951"></a>00951     {
<a name="l00952"></a>00952       <a class="code" href="classCMAES.html#aa1ad648deeabde4621b932ec378551fc" title="Objective function values of the population.">functionValues</a>[i] = std::numeric_limits&lt;T&gt;::max();
<a name="l00953"></a>00953     }
<a name="l00954"></a>00954     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; historySize; i++)
<a name="l00955"></a>00955     {
<a name="l00956"></a>00956       <a class="code" href="classCMAES.html#a2e91522e80428b2abd40947b2fb3ed4e" title="History of function values.">funcValueHistory</a>[i] = std::numeric_limits&lt;T&gt;::max();
<a name="l00957"></a>00957     }
<a name="l00958"></a>00958     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00959"></a>00959       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; i; ++j)
<a name="l00960"></a>00960         <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i][j] = <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="Matrix with normalize eigenvectors in columns.">B</a>[i][j] = <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="Matrix with normalize eigenvectors in columns.">B</a>[j][i] = 0.;
<a name="l00961"></a>00961 
<a name="l00962"></a>00962     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00963"></a>00963     {
<a name="l00964"></a>00964       <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="Matrix with normalize eigenvectors in columns.">B</a>[i][i] = T(1);
<a name="l00965"></a>00965       <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i][i] = <a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>[i] = <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.rgInitialStds[i]*std::sqrt(<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N/trace);
<a name="l00966"></a>00966       <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i][i] *= <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i][i];
<a name="l00967"></a>00967       <a class="code" href="classCMAES.html#a978c42dbaee69df8ac0cd5d480835579" title="Anisotropic evolution path (for covariance).">pc</a>[i] = <a class="code" href="classCMAES.html#ab025d43841c37ded96cdc76f834d82ba" title="Isotropic evolution path (for step length).">ps</a>[i] = T(0);
<a name="l00968"></a>00968     }
<a name="l00969"></a>00969     <a class="code" href="classCMAES.html#a9796be17293ba4549946392565368f41">minEW</a> = <a class="code" href="utils_8h.html#a5ab74da4f5c22d49151fd4c7c9a41dee">minElement</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>, <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N);
<a name="l00970"></a>00970     <a class="code" href="classCMAES.html#a9796be17293ba4549946392565368f41">minEW</a> = <a class="code" href="classCMAES.html#a9796be17293ba4549946392565368f41">minEW</a>*<a class="code" href="classCMAES.html#a9796be17293ba4549946392565368f41">minEW</a>;
<a name="l00971"></a>00971     <a class="code" href="classCMAES.html#ae36bc85cdd41cb3db39b99a0303f6b6e">maxEW</a> = <a class="code" href="utils_8h.html#a607a38043b6aa6f8501b8bfca777536f">maxElement</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>, <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N);
<a name="l00972"></a>00972     <a class="code" href="classCMAES.html#ae36bc85cdd41cb3db39b99a0303f6b6e">maxEW</a> = <a class="code" href="classCMAES.html#ae36bc85cdd41cb3db39b99a0303f6b6e">maxEW</a>*<a class="code" href="classCMAES.html#ae36bc85cdd41cb3db39b99a0303f6b6e">maxEW</a>;
<a name="l00973"></a>00973 
<a name="l00974"></a>00974     <a class="code" href="classCMAES.html#a93eee1dc0a955f05fcabb5db15b64886">maxdiagC</a> = <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[0][0];
<a name="l00975"></a>00975     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i) <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a93eee1dc0a955f05fcabb5db15b64886">maxdiagC</a> &lt; <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i][i]) <a class="code" href="classCMAES.html#a93eee1dc0a955f05fcabb5db15b64886">maxdiagC</a> = <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i][i];
<a name="l00976"></a>00976     <a class="code" href="classCMAES.html#a0fc9beb46f3685e1f49f2575de3ce026">mindiagC</a> = <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[0][0];
<a name="l00977"></a>00977     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i) <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a0fc9beb46f3685e1f49f2575de3ce026">mindiagC</a> &gt; <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i][i]) <a class="code" href="classCMAES.html#a0fc9beb46f3685e1f49f2575de3ce026">mindiagC</a> = <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i][i];
<a name="l00978"></a>00978 
<a name="l00979"></a>00979     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00980"></a>00980       <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="Mean x vector, &quot;parent&quot;.">xmean</a>[i] = <a class="code" href="classCMAES.html#a62c5a6a980a0a2fd13d3ba5b257dfc4f" title="Last mean.">xold</a>[i] = <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.xstart[i];
<a name="l00981"></a>00981     <span class="comment">// use in case xstart as typicalX</span>
<a name="l00982"></a>00982     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.typicalXcase)
<a name="l00983"></a>00983       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l00984"></a>00984         <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="Mean x vector, &quot;parent&quot;.">xmean</a>[i] += <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>*<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>[i]*<a class="code" href="classCMAES.html#a73e60929e1e08ea6f9f4a5cec6f020b4" title="CMA-ES parameters.">rand</a>.gauss();
<a name="l00985"></a>00985 
<a name="l00986"></a>00986     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.resumefile != <span class="stringliteral">&quot;&quot;</span>)
<a name="l00987"></a>00987       <a class="code" href="classCMAES.html#a6fb584672adf0a856b638cadbe2e3b84" title="Allows to restart with saved internal state (distribution) variables (use writeToFile() for saving)...">resumeDistribution</a>(<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.resumefile);
<a name="l00988"></a>00988 
<a name="l00989"></a>00989     <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a4ed94ed86d47a4903cb11eacd1f703e5">publicFitness</a>;
<a name="l00990"></a>00990   }
<a name="l00991"></a>00991 
<a name="l00996"></a><a class="code" href="classCMAES.html#a514dd76a8dd20a33a3c52f0cc6af74d2">00996</a>   std::string <a class="code" href="classCMAES.html#a514dd76a8dd20a33a3c52f0cc6af74d2" title="Well, says hello.">sayHello</a>()
<a name="l00997"></a>00997   {
<a name="l00998"></a>00998     std::stringstream stream;
<a name="l00999"></a>00999     stream &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.mu &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.lambda &lt;&lt; <span class="stringliteral">&quot;)-CMA-ES(mu_eff=&quot;</span>
<a name="l01000"></a>01000         &lt;&lt; std::setprecision(1) &lt;&lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.mueff &lt;&lt; <span class="stringliteral">&quot;), Ver=\&quot;&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a39f33a47d224feccbb0f31bc3b24f922" title="Implementation version.">version</a>
<a name="l01001"></a>01001         &lt;&lt; <span class="stringliteral">&quot;\&quot;, dimension=&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N &lt;&lt; <span class="stringliteral">&quot;, diagonalIterations=&quot;</span>
<a name="l01002"></a>01002         &lt;&lt; (long) <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.diagonalCov &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#aed17d3f1a936b1f640203d17f0422743">getTimeStr</a>() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;
<a name="l01003"></a>01003     <span class="keywordflow">return</span> stream.str();
<a name="l01004"></a>01004   }
<a name="l01005"></a>01005 
<a name="l01023"></a><a class="code" href="classCMAES.html#a6fb584672adf0a856b638cadbe2e3b84">01023</a>   <span class="keywordtype">void</span> <a class="code" href="classCMAES.html#a6fb584672adf0a856b638cadbe2e3b84" title="Allows to restart with saved internal state (distribution) variables (use writeToFile() for saving)...">resumeDistribution</a>(<span class="keyword">const</span> std::string&amp; filename)
<a name="l01024"></a>01024   {
<a name="l01025"></a>01025     std::ifstream file(filename.c_str());
<a name="l01026"></a>01026     <span class="keywordflow">if</span>(!file.is_open())
<a name="l01027"></a>01027       <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;resumeDistribution(): could not open &#39;&quot;</span> + filename + <span class="stringliteral">&quot;&#39;&quot;</span>);
<a name="l01028"></a>01028 
<a name="l01029"></a>01029     std::streampos lastResume = 0;
<a name="l01030"></a>01030     std::string entry = <span class="stringliteral">&quot;&quot;</span>;
<a name="l01031"></a>01031     <span class="keywordflow">while</span>(!file.eof())
<a name="l01032"></a>01032     {
<a name="l01033"></a>01033       file &gt;&gt; entry;
<a name="l01034"></a>01034       <span class="keywordflow">if</span>(entry == <span class="stringliteral">&quot;resume&quot;</span>)
<a name="l01035"></a>01035       {
<a name="l01036"></a>01036         lastResume = file.tellg();
<a name="l01037"></a>01037         <span class="keywordflow">break</span>;
<a name="l01038"></a>01038       }
<a name="l01039"></a>01039     }
<a name="l01040"></a>01040     file.clear();
<a name="l01041"></a>01041     file.seekg(lastResume);
<a name="l01042"></a>01042 
<a name="l01043"></a>01043     <span class="keywordtype">int</span> n = 0;
<a name="l01044"></a>01044     file &gt;&gt; n;
<a name="l01045"></a>01045     <span class="keywordflow">if</span>(n != <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N)
<a name="l01046"></a>01046       <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;resumeDistribution(): Dimension numbers do not match&quot;</span>);
<a name="l01047"></a>01047 
<a name="l01048"></a>01048     <span class="comment">// find next &quot;xmean&quot; entry</span>
<a name="l01049"></a>01049     <span class="keywordflow">while</span>(!file.eof())
<a name="l01050"></a>01050     {
<a name="l01051"></a>01051       file &gt;&gt; entry;
<a name="l01052"></a>01052       <span class="keywordflow">if</span>(entry == <span class="stringliteral">&quot;xmean&quot;</span>)
<a name="l01053"></a>01053         <span class="keywordflow">break</span>;
<a name="l01054"></a>01054     }
<a name="l01055"></a>01055     <span class="comment">// read xmean</span>
<a name="l01056"></a>01056     <span class="keywordflow">if</span>(file.eof())
<a name="l01057"></a>01057       <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;resumeDistribution(): &#39;xmean&#39; not found&quot;</span>);
<a name="l01058"></a>01058     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; n; i++)
<a name="l01059"></a>01059       file &gt;&gt; <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="Mean x vector, &quot;parent&quot;.">xmean</a>[i];
<a name="l01060"></a>01060     file.clear();
<a name="l01061"></a>01061     file.seekg(lastResume);
<a name="l01062"></a>01062 
<a name="l01063"></a>01063     <span class="comment">// find next &quot;path for sigma&quot; entry</span>
<a name="l01064"></a>01064     <span class="keywordflow">while</span>(!file.eof())
<a name="l01065"></a>01065     {
<a name="l01066"></a>01066       file &gt;&gt; entry;
<a name="l01067"></a>01067       <span class="keywordflow">if</span>(entry == <span class="stringliteral">&quot;path&quot;</span>)
<a name="l01068"></a>01068       {
<a name="l01069"></a>01069         std::string temp = <span class="stringliteral">&quot;&quot;</span>;
<a name="l01070"></a>01070         file &gt;&gt; temp;
<a name="l01071"></a>01071         entry += <span class="stringliteral">&quot; &quot;</span> + temp;
<a name="l01072"></a>01072         file &gt;&gt; temp;
<a name="l01073"></a>01073         entry += <span class="stringliteral">&quot; &quot;</span> + temp;
<a name="l01074"></a>01074         <span class="keywordflow">if</span>(entry == <span class="stringliteral">&quot;path for sigma&quot;</span>)
<a name="l01075"></a>01075           <span class="keywordflow">break</span>;
<a name="l01076"></a>01076       }
<a name="l01077"></a>01077     }
<a name="l01078"></a>01078     <span class="comment">// read ps</span>
<a name="l01079"></a>01079     <span class="keywordflow">if</span>(file.eof())
<a name="l01080"></a>01080       <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;resumeDistribution(): &#39;path for sigma&#39; not found&quot;</span>);
<a name="l01081"></a>01081     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; n; i++)
<a name="l01082"></a>01082       file &gt;&gt; <a class="code" href="classCMAES.html#ab025d43841c37ded96cdc76f834d82ba" title="Isotropic evolution path (for step length).">ps</a>[i];
<a name="l01083"></a>01083     file.clear();
<a name="l01084"></a>01084     file.seekg(lastResume);
<a name="l01085"></a>01085 
<a name="l01086"></a>01086     <span class="comment">// find next &quot;path for C&quot; entry</span>
<a name="l01087"></a>01087     <span class="keywordflow">while</span>(!file.eof())
<a name="l01088"></a>01088     {
<a name="l01089"></a>01089       file &gt;&gt; entry;
<a name="l01090"></a>01090       <span class="keywordflow">if</span>(entry == <span class="stringliteral">&quot;path&quot;</span>)
<a name="l01091"></a>01091       {
<a name="l01092"></a>01092         std::string temp = <span class="stringliteral">&quot;&quot;</span>;
<a name="l01093"></a>01093         file &gt;&gt; temp;
<a name="l01094"></a>01094         entry += <span class="stringliteral">&quot; &quot;</span> + temp;
<a name="l01095"></a>01095         file &gt;&gt; temp;
<a name="l01096"></a>01096         entry += <span class="stringliteral">&quot; &quot;</span> + temp;
<a name="l01097"></a>01097         <span class="keywordflow">if</span>(entry == <span class="stringliteral">&quot;path for C&quot;</span>)
<a name="l01098"></a>01098           <span class="keywordflow">break</span>;
<a name="l01099"></a>01099       }
<a name="l01100"></a>01100     }
<a name="l01101"></a>01101     <span class="comment">// read pc</span>
<a name="l01102"></a>01102     <span class="keywordflow">if</span>(file.eof())
<a name="l01103"></a>01103       <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;resumeDistribution(): &#39;path for C&#39; not found&quot;</span>);
<a name="l01104"></a>01104     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; n; i++)
<a name="l01105"></a>01105       file &gt;&gt; <a class="code" href="classCMAES.html#a978c42dbaee69df8ac0cd5d480835579" title="Anisotropic evolution path (for covariance).">pc</a>[i];
<a name="l01106"></a>01106     file.clear();
<a name="l01107"></a>01107     file.seekg(lastResume);
<a name="l01108"></a>01108 
<a name="l01109"></a>01109     <span class="comment">// find next &quot;sigma&quot; entry</span>
<a name="l01110"></a>01110     <span class="keywordflow">while</span>(!file.eof())
<a name="l01111"></a>01111     {
<a name="l01112"></a>01112       file &gt;&gt; entry;
<a name="l01113"></a>01113       <span class="keywordflow">if</span>(entry == <span class="stringliteral">&quot;sigma&quot;</span>)
<a name="l01114"></a>01114         <span class="keywordflow">break</span>;
<a name="l01115"></a>01115     }
<a name="l01116"></a>01116     <span class="comment">// read pc</span>
<a name="l01117"></a>01117     <span class="keywordflow">if</span>(file.eof())
<a name="l01118"></a>01118       <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;resumeDistribution(): &#39;sigma&#39; not found&quot;</span>);
<a name="l01119"></a>01119     file &gt;&gt; <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>;
<a name="l01120"></a>01120     file.clear();
<a name="l01121"></a>01121     file.seekg(lastResume);
<a name="l01122"></a>01122 
<a name="l01123"></a>01123     <span class="comment">// find next &quot;covariance matrix&quot; entry</span>
<a name="l01124"></a>01124     <span class="keywordflow">while</span>(!file.eof())
<a name="l01125"></a>01125     {
<a name="l01126"></a>01126       file &gt;&gt; entry;
<a name="l01127"></a>01127       <span class="keywordflow">if</span>(entry == <span class="stringliteral">&quot;covariance&quot;</span>)
<a name="l01128"></a>01128       {
<a name="l01129"></a>01129         std::string temp = <span class="stringliteral">&quot;&quot;</span>;
<a name="l01130"></a>01130         file &gt;&gt; temp;
<a name="l01131"></a>01131         entry += <span class="stringliteral">&quot; &quot;</span> + temp;
<a name="l01132"></a>01132         <span class="keywordflow">if</span>(entry == <span class="stringliteral">&quot;covariance matrix&quot;</span>)
<a name="l01133"></a>01133           <span class="keywordflow">break</span>;
<a name="l01134"></a>01134       }
<a name="l01135"></a>01135     }
<a name="l01136"></a>01136     <span class="comment">// read C</span>
<a name="l01137"></a>01137     <span class="keywordflow">if</span>(file.eof())
<a name="l01138"></a>01138       <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;resumeDistribution(): &#39;covariance matrix&#39; not found&quot;</span>);
<a name="l01139"></a>01139     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l01140"></a>01140       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)
<a name="l01141"></a>01141         file &gt;&gt; <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i][j];
<a name="l01142"></a>01142 
<a name="l01143"></a>01143     <a class="code" href="classCMAES.html#ade7b4d250edba249dfcfdc2e2396246e">eigensysIsUptodate</a> = <span class="keyword">false</span>;
<a name="l01144"></a>01144     <a class="code" href="classCMAES.html#a5ef76c4c2d5833429dc868ed8d2c6709">isResumeDone</a> = <span class="keyword">true</span>;
<a name="l01145"></a>01145     <a class="code" href="classCMAES.html#ae0dcc966a2b41a9f35724c5f65e87cf5" title="Conducts the eigendecomposition of C into B and D such that  and  and D diagonal and positive...">updateEigensystem</a>(<span class="keyword">true</span>);
<a name="l01146"></a>01146   }
<a name="l01147"></a>01147 
<a name="l01154"></a><a class="code" href="classCMAES.html#a125e113c39476688c546f3e065fd18f1">01154</a>   T* <span class="keyword">const</span>* <a class="code" href="classCMAES.html#a125e113c39476688c546f3e065fd18f1" title="The search space vectors have a special form: they are arrays with N+1 entries.">samplePopulation</a>()
<a name="l01155"></a>01155   {
<a name="l01156"></a>01156     <span class="keywordtype">bool</span> diag = <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.diagonalCov == 1 || <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.diagonalCov &gt;= <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a>;
<a name="l01157"></a>01157 
<a name="l01158"></a>01158     <span class="comment">// calculate eigensystem</span>
<a name="l01159"></a>01159     <span class="keywordflow">if</span>(!<a class="code" href="classCMAES.html#ade7b4d250edba249dfcfdc2e2396246e">eigensysIsUptodate</a>)
<a name="l01160"></a>01160     {
<a name="l01161"></a>01161       <span class="keywordflow">if</span>(!diag)
<a name="l01162"></a>01162         <a class="code" href="classCMAES.html#ae0dcc966a2b41a9f35724c5f65e87cf5" title="Conducts the eigendecomposition of C into B and D such that  and  and D diagonal and positive...">updateEigensystem</a>(<span class="keyword">false</span>);
<a name="l01163"></a>01163       <span class="keywordflow">else</span>
<a name="l01164"></a>01164       {
<a name="l01165"></a>01165         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l01166"></a>01166           <a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>[i] = std::sqrt(<a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i][i]);
<a name="l01167"></a>01167         <a class="code" href="classCMAES.html#a9796be17293ba4549946392565368f41">minEW</a> = <a class="code" href="utils_8h.html#a989667debd678779d780857cc650eb86">square</a>(<a class="code" href="utils_8h.html#a5ab74da4f5c22d49151fd4c7c9a41dee">minElement</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>, <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N));
<a name="l01168"></a>01168         <a class="code" href="classCMAES.html#ae36bc85cdd41cb3db39b99a0303f6b6e">maxEW</a> = <a class="code" href="utils_8h.html#a989667debd678779d780857cc650eb86">square</a>(<a class="code" href="utils_8h.html#a607a38043b6aa6f8501b8bfca777536f">maxElement</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>, <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N));
<a name="l01169"></a>01169         <a class="code" href="classCMAES.html#ade7b4d250edba249dfcfdc2e2396246e">eigensysIsUptodate</a> = <span class="keyword">true</span>;
<a name="l01170"></a>01170         <a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">eigenTimings</a>.<a class="code" href="classTiming.html#a5110c4f7949fbd326ee071c82473b611">start</a>();
<a name="l01171"></a>01171       }
<a name="l01172"></a>01172     }
<a name="l01173"></a>01173 
<a name="l01174"></a>01174     <a class="code" href="classCMAES.html#a0acb1ad8ffd57032a1be02654a9d0d4a" title="Treats minimal standard deviations and numeric problems.">testMinStdDevs</a>();
<a name="l01175"></a>01175 
<a name="l01176"></a>01176     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iNk = 0; iNk &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.lambda; ++iNk)
<a name="l01177"></a>01177     { <span class="comment">// generate scaled random vector D*z</span>
<a name="l01178"></a>01178       T* rgrgxink = <a class="code" href="classCMAES.html#a46ee9e7f9bb10e7a32af8e991dbc3c4d" title="x-vectors, lambda offspring.">population</a>[iNk];
<a name="l01179"></a>01179       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l01180"></a>01180         <span class="keywordflow">if</span>(diag)
<a name="l01181"></a>01181           rgrgxink[i] = <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="Mean x vector, &quot;parent&quot;.">xmean</a>[i] + <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>*<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>[i]*<a class="code" href="classCMAES.html#a73e60929e1e08ea6f9f4a5cec6f020b4" title="CMA-ES parameters.">rand</a>.gauss();
<a name="l01182"></a>01182         <span class="keywordflow">else</span>
<a name="l01183"></a>01183           <a class="code" href="classCMAES.html#a9aa6c060f3f33a4e07b20133c429b3bb" title="Temporary (random) vector used in different places.">tempRandom</a>[i] = <a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>[i]*<a class="code" href="classCMAES.html#a73e60929e1e08ea6f9f4a5cec6f020b4" title="CMA-ES parameters.">rand</a>.gauss();
<a name="l01184"></a>01184       <span class="keywordflow">if</span>(!diag)
<a name="l01185"></a>01185         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i) <span class="comment">// add mutation sigma*B*(D*z)</span>
<a name="l01186"></a>01186         {
<a name="l01187"></a>01187           T sum = 0.0;
<a name="l01188"></a>01188           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++j)
<a name="l01189"></a>01189             sum += <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="Matrix with normalize eigenvectors in columns.">B</a>[i][j]*<a class="code" href="classCMAES.html#a9aa6c060f3f33a4e07b20133c429b3bb" title="Temporary (random) vector used in different places.">tempRandom</a>[j];
<a name="l01190"></a>01190           rgrgxink[i] = <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="Mean x vector, &quot;parent&quot;.">xmean</a>[i] + <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>*sum;
<a name="l01191"></a>01191         }
<a name="l01192"></a>01192     }
<a name="l01193"></a>01193 
<a name="l01194"></a>01194     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a2259ba2fee168dac1aed9a5de7e9703e">state</a> == <a class="code" href="classCMAES.html#a0cef0210cdaaf09dd1d40daf33127765a56c763404afb4ac45e7b81539eeb6fd2">UPDATED</a> || <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a> == 0)
<a name="l01195"></a>01195       ++<a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a>;
<a name="l01196"></a>01196     <a class="code" href="classCMAES.html#a2259ba2fee168dac1aed9a5de7e9703e">state</a> = <a class="code" href="classCMAES.html#a0cef0210cdaaf09dd1d40daf33127765abf4219108f9e35e6816d0233af2a2e3e">SAMPLED</a>;
<a name="l01197"></a>01197 
<a name="l01198"></a>01198     <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a46ee9e7f9bb10e7a32af8e991dbc3c4d" title="x-vectors, lambda offspring.">population</a>;
<a name="l01199"></a>01199   }
<a name="l01200"></a>01200 
<a name="l01210"></a><a class="code" href="classCMAES.html#af4080d6c8baeda354674c5e94f15c682">01210</a>   T* <span class="keyword">const</span>* <a class="code" href="classCMAES.html#af4080d6c8baeda354674c5e94f15c682" title="Can be called after samplePopulation() to resample single solutions of the population as often as des...">reSampleSingle</a>(<span class="keywordtype">int</span> i)
<a name="l01211"></a>01211   {
<a name="l01212"></a>01212     T* x;
<a name="l01213"></a>01213     assert(i &gt;= 0 &amp;&amp; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.lambda &amp;&amp;
<a name="l01214"></a>01214         <span class="stringliteral">&quot;reSampleSingle(): index must be between 0 and sp.lambda&quot;</span>);
<a name="l01215"></a>01215     x = <a class="code" href="classCMAES.html#a46ee9e7f9bb10e7a32af8e991dbc3c4d" title="x-vectors, lambda offspring.">population</a>[i];
<a name="l01216"></a>01216     <a class="code" href="classCMAES.html#af5d3c51b5b233cb684ba40bfa564fc98" title="Adds the mutation sigma*B*(D*z).">addMutation</a>(x);
<a name="l01217"></a>01217     <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a46ee9e7f9bb10e7a32af8e991dbc3c4d" title="x-vectors, lambda offspring.">population</a>;
<a name="l01218"></a>01218   }
<a name="l01219"></a>01219 
<a name="l01234"></a><a class="code" href="classCMAES.html#a5e691eef09ff825b48b1db0aed3f5cd8">01234</a>   T* <a class="code" href="classCMAES.html#a5e691eef09ff825b48b1db0aed3f5cd8" title="Can be called after samplePopulation() to resample single solutions.">sampleSingleInto</a>(T* x)
<a name="l01235"></a>01235   {
<a name="l01236"></a>01236     <span class="keywordflow">if</span>(!x)
<a name="l01237"></a>01237       x = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N];
<a name="l01238"></a>01238     <a class="code" href="classCMAES.html#af5d3c51b5b233cb684ba40bfa564fc98" title="Adds the mutation sigma*B*(D*z).">addMutation</a>(x);
<a name="l01239"></a>01239     <span class="keywordflow">return</span> x;
<a name="l01240"></a>01240   }
<a name="l01241"></a>01241 
<a name="l01251"></a><a class="code" href="classCMAES.html#a0b63182a2fe2b4e977b3f0931153d166">01251</a>   T <span class="keyword">const</span>* <a class="code" href="classCMAES.html#a0b63182a2fe2b4e977b3f0931153d166" title="Can be called after samplePopulation() to resample single solutions.">reSampleSingleOld</a>(T* x)
<a name="l01252"></a>01252   {
<a name="l01253"></a>01253     assert(x &amp;&amp; <span class="stringliteral">&quot;reSampleSingleOld(): Missing input x&quot;</span>);
<a name="l01254"></a>01254     <a class="code" href="classCMAES.html#af5d3c51b5b233cb684ba40bfa564fc98" title="Adds the mutation sigma*B*(D*z).">addMutation</a>(x);
<a name="l01255"></a>01255     <span class="keywordflow">return</span> x;
<a name="l01256"></a>01256   }
<a name="l01257"></a>01257 
<a name="l01271"></a><a class="code" href="classCMAES.html#ad567c3fb26738c797f4312dcacb48d52">01271</a>   T* <a class="code" href="classCMAES.html#ad567c3fb26738c797f4312dcacb48d52" title="Used to reevaluate a slightly disturbed solution for an uncertaintly measurement.">perturbSolutionInto</a>(T* x, T <span class="keyword">const</span>* pxmean, T eps)
<a name="l01272"></a>01272   {
<a name="l01273"></a>01273     <span class="keywordflow">if</span>(!x)
<a name="l01274"></a>01274       x = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N];
<a name="l01275"></a>01275     assert(pxmean &amp;&amp; <span class="stringliteral">&quot;perturbSolutionInto(): pxmean was not given&quot;</span>);
<a name="l01276"></a>01276     <a class="code" href="classCMAES.html#af5d3c51b5b233cb684ba40bfa564fc98" title="Adds the mutation sigma*B*(D*z).">addMutation</a>(x, eps);
<a name="l01277"></a>01277     <span class="keywordflow">return</span> x;
<a name="l01278"></a>01278   }
<a name="l01279"></a>01279 
<a name="l01287"></a><a class="code" href="classCMAES.html#aca72ba65586cc02ecd9325eb0cc420a0">01287</a>   T* <a class="code" href="classCMAES.html#aca72ba65586cc02ecd9325eb0cc420a0" title="Core procedure of the CMA-ES algorithm.">updateDistribution</a>(<span class="keyword">const</span> T* fitnessValues)
<a name="l01288"></a>01288   {
<a name="l01289"></a>01289     <span class="keyword">const</span> <span class="keywordtype">int</span> N = <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N;
<a name="l01290"></a>01290     <span class="keywordtype">bool</span> diag = <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.diagonalCov == 1 || <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.diagonalCov &gt;= <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a>;
<a name="l01291"></a>01291 
<a name="l01292"></a>01292     assert(<a class="code" href="classCMAES.html#a2259ba2fee168dac1aed9a5de7e9703e">state</a> != <a class="code" href="classCMAES.html#a0cef0210cdaaf09dd1d40daf33127765a56c763404afb4ac45e7b81539eeb6fd2">UPDATED</a> &amp;&amp; <span class="stringliteral">&quot;updateDistribution(): You need to call &quot;</span>
<a name="l01293"></a>01293           <span class="stringliteral">&quot;samplePopulation() before update can take place.&quot;</span>);
<a name="l01294"></a>01294     assert(fitnessValues &amp;&amp; <span class="stringliteral">&quot;updateDistribution(): No fitness function value array input.&quot;</span>);
<a name="l01295"></a>01295 
<a name="l01296"></a>01296     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a2259ba2fee168dac1aed9a5de7e9703e">state</a> == <a class="code" href="classCMAES.html#a0cef0210cdaaf09dd1d40daf33127765abf4219108f9e35e6816d0233af2a2e3e">SAMPLED</a>) <span class="comment">// function values are delivered here</span>
<a name="l01297"></a>01297       <a class="code" href="classCMAES.html#a4e328b09739d2fb1a220a3d7cf4bc82c" title="objective function evaluations">countevals</a> += <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.lambda;
<a name="l01298"></a>01298     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.logWarnings)
<a name="l01299"></a>01299       <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.logStream &lt;&lt;  <span class="stringliteral">&quot;updateDistribution(): unexpected state&quot;</span> &lt;&lt; std::endl;
<a name="l01300"></a>01300 
<a name="l01301"></a>01301     <span class="comment">// assign function values</span>
<a name="l01302"></a>01302     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.lambda; ++i)
<a name="l01303"></a>01303       <a class="code" href="classCMAES.html#a46ee9e7f9bb10e7a32af8e991dbc3c4d" title="x-vectors, lambda offspring.">population</a>[i][N] = <a class="code" href="classCMAES.html#aa1ad648deeabde4621b932ec378551fc" title="Objective function values of the population.">functionValues</a>[i] = fitnessValues[i];
<a name="l01304"></a>01304 
<a name="l01305"></a>01305     <span class="comment">// Generate index</span>
<a name="l01306"></a>01306     <a class="code" href="classCMAES.html#a6ec64a4e6821b8d568a18acd524a7611" title="Dirty index sort.">sortIndex</a>(fitnessValues, <a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="Sorting index of sample population.">index</a>, <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.lambda);
<a name="l01307"></a>01307 
<a name="l01308"></a>01308     <span class="comment">// Test if function values are identical, escape flat fitness</span>
<a name="l01309"></a>01309     <span class="keywordflow">if</span>(fitnessValues[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="Sorting index of sample population.">index</a>[0]] == fitnessValues[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="Sorting index of sample population.">index</a>[(<span class="keywordtype">int</span>) <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.lambda / 2]])
<a name="l01310"></a>01310     {
<a name="l01311"></a>01311       <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a> *= std::exp(T(0.2) + <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.cs / <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.damps);
<a name="l01312"></a>01312       <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.logWarnings)
<a name="l01313"></a>01313       {
<a name="l01314"></a>01314         <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.logStream &lt;&lt; <span class="stringliteral">&quot;Warning: sigma increased due to equal function values&quot;</span>
<a name="l01315"></a>01315             &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;   Reconsider the formulation of the objective function&quot;</span>;
<a name="l01316"></a>01316       }
<a name="l01317"></a>01317     }
<a name="l01318"></a>01318 
<a name="l01319"></a>01319     <span class="comment">// update function value history</span>
<a name="l01320"></a>01320     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = (<span class="keywordtype">int</span>) *(<a class="code" href="classCMAES.html#a2e91522e80428b2abd40947b2fb3ed4e" title="History of function values.">funcValueHistory</a> - 1) - 1; i &gt; 0; --i)
<a name="l01321"></a>01321       <a class="code" href="classCMAES.html#a2e91522e80428b2abd40947b2fb3ed4e" title="History of function values.">funcValueHistory</a>[i] = <a class="code" href="classCMAES.html#a2e91522e80428b2abd40947b2fb3ed4e" title="History of function values.">funcValueHistory</a>[i - 1];
<a name="l01322"></a>01322     <a class="code" href="classCMAES.html#a2e91522e80428b2abd40947b2fb3ed4e" title="History of function values.">funcValueHistory</a>[0] = fitnessValues[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="Sorting index of sample population.">index</a>[0]];
<a name="l01323"></a>01323 
<a name="l01324"></a>01324     <span class="comment">// update xbestever</span>
<a name="l01325"></a>01325     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a0b94ac84584f832f79084141bc768068" title="Best sample ever.">xBestEver</a>[N] &gt; <a class="code" href="classCMAES.html#a46ee9e7f9bb10e7a32af8e991dbc3c4d" title="x-vectors, lambda offspring.">population</a>[index[0]][N] || <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a> == 1)
<a name="l01326"></a>01326       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt;= N; ++i)
<a name="l01327"></a>01327       {
<a name="l01328"></a>01328         <a class="code" href="classCMAES.html#a0b94ac84584f832f79084141bc768068" title="Best sample ever.">xBestEver</a>[i] = <a class="code" href="classCMAES.html#a46ee9e7f9bb10e7a32af8e991dbc3c4d" title="x-vectors, lambda offspring.">population</a>[index[0]][i];
<a name="l01329"></a>01329         <a class="code" href="classCMAES.html#a0b94ac84584f832f79084141bc768068" title="Best sample ever.">xBestEver</a>[N+1] = <a class="code" href="classCMAES.html#a4e328b09739d2fb1a220a3d7cf4bc82c" title="objective function evaluations">countevals</a>;
<a name="l01330"></a>01330       }
<a name="l01331"></a>01331 
<a name="l01332"></a>01332     <span class="keyword">const</span> T sqrtmueffdivsigma = std::sqrt(<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.mueff) / <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>;
<a name="l01333"></a>01333     <span class="comment">// calculate xmean and rgBDz~N(0,C)</span>
<a name="l01334"></a>01334     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; N; ++i)
<a name="l01335"></a>01335     {
<a name="l01336"></a>01336       <a class="code" href="classCMAES.html#a62c5a6a980a0a2fd13d3ba5b257dfc4f" title="Last mean.">xold</a>[i] = <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="Mean x vector, &quot;parent&quot;.">xmean</a>[i];
<a name="l01337"></a>01337       <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="Mean x vector, &quot;parent&quot;.">xmean</a>[i] = 0.;
<a name="l01338"></a>01338       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iNk = 0; iNk &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.mu; ++iNk)
<a name="l01339"></a>01339         <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="Mean x vector, &quot;parent&quot;.">xmean</a>[i] += <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.weights[iNk]*<a class="code" href="classCMAES.html#a46ee9e7f9bb10e7a32af8e991dbc3c4d" title="x-vectors, lambda offspring.">population</a>[index[iNk]][i];
<a name="l01340"></a>01340       <a class="code" href="classCMAES.html#a73714d5cec116bef33aed344991536a2" title="B*D*z.">BDz</a>[i] = sqrtmueffdivsigma*(<a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="Mean x vector, &quot;parent&quot;.">xmean</a>[i]-<a class="code" href="classCMAES.html#a62c5a6a980a0a2fd13d3ba5b257dfc4f" title="Last mean.">xold</a>[i]);
<a name="l01341"></a>01341     }
<a name="l01342"></a>01342 
<a name="l01343"></a>01343     <span class="comment">// calculate z := D^(-1)* B^(-1)* rgBDz into rgdTmp</span>
<a name="l01344"></a>01344     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; N; ++i)
<a name="l01345"></a>01345     {
<a name="l01346"></a>01346       T sum;
<a name="l01347"></a>01347       <span class="keywordflow">if</span>(diag)
<a name="l01348"></a>01348         sum = <a class="code" href="classCMAES.html#a73714d5cec116bef33aed344991536a2" title="B*D*z.">BDz</a>[i];
<a name="l01349"></a>01349       <span class="keywordflow">else</span>
<a name="l01350"></a>01350       {
<a name="l01351"></a>01351         sum = 0.;
<a name="l01352"></a>01352         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; N; ++j)
<a name="l01353"></a>01353           sum += <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="Matrix with normalize eigenvectors in columns.">B</a>[j][i]*<a class="code" href="classCMAES.html#a73714d5cec116bef33aed344991536a2" title="B*D*z.">BDz</a>[j];
<a name="l01354"></a>01354       }
<a name="l01355"></a>01355       <a class="code" href="classCMAES.html#a9aa6c060f3f33a4e07b20133c429b3bb" title="Temporary (random) vector used in different places.">tempRandom</a>[i] = sum/<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>[i];
<a name="l01356"></a>01356     }
<a name="l01357"></a>01357 
<a name="l01358"></a>01358     <span class="comment">// cumulation for sigma (ps) using B*z</span>
<a name="l01359"></a>01359     <span class="keyword">const</span> T sqrtFactor = std::sqrt(<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.cs*(T(2)-<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.cs));
<a name="l01360"></a>01360     <span class="keyword">const</span> T invps = T(1)-<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.cs;
<a name="l01361"></a>01361     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; N; ++i)
<a name="l01362"></a>01362     {
<a name="l01363"></a>01363       T sum;
<a name="l01364"></a>01364       <span class="keywordflow">if</span>(diag)
<a name="l01365"></a>01365         sum = <a class="code" href="classCMAES.html#a9aa6c060f3f33a4e07b20133c429b3bb" title="Temporary (random) vector used in different places.">tempRandom</a>[i];
<a name="l01366"></a>01366       <span class="keywordflow">else</span>
<a name="l01367"></a>01367       {
<a name="l01368"></a>01368         sum = T(0);
<a name="l01369"></a>01369         T* Bi = <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="Matrix with normalize eigenvectors in columns.">B</a>[i];
<a name="l01370"></a>01370         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; N; ++j)
<a name="l01371"></a>01371           sum += Bi[j]*<a class="code" href="classCMAES.html#a9aa6c060f3f33a4e07b20133c429b3bb" title="Temporary (random) vector used in different places.">tempRandom</a>[j];
<a name="l01372"></a>01372       }
<a name="l01373"></a>01373       <a class="code" href="classCMAES.html#ab025d43841c37ded96cdc76f834d82ba" title="Isotropic evolution path (for step length).">ps</a>[i] = invps*<a class="code" href="classCMAES.html#ab025d43841c37ded96cdc76f834d82ba" title="Isotropic evolution path (for step length).">ps</a>[i] + sqrtFactor*sum;
<a name="l01374"></a>01374     }
<a name="l01375"></a>01375 
<a name="l01376"></a>01376     <span class="comment">// calculate norm(ps)^2</span>
<a name="l01377"></a>01377     T psxps(0);
<a name="l01378"></a>01378     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; N; ++i)
<a name="l01379"></a>01379     {
<a name="l01380"></a>01380       <span class="keyword">const</span> T&amp; rgpsi = <a class="code" href="classCMAES.html#ab025d43841c37ded96cdc76f834d82ba" title="Isotropic evolution path (for step length).">ps</a>[i];
<a name="l01381"></a>01381       psxps += rgpsi*rgpsi;
<a name="l01382"></a>01382     }
<a name="l01383"></a>01383 
<a name="l01384"></a>01384     <span class="comment">// cumulation for covariance matrix (pc) using B*D*z~N(0,C)</span>
<a name="l01385"></a>01385     <span class="keywordtype">int</span> hsig = std::sqrt(psxps) / std::sqrt(T(1) - std::pow(T(1) - <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.cs, T(2)* <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a>))
<a name="l01386"></a>01386         / <a class="code" href="classCMAES.html#af5aff4dfec9d1eabe488c5f03395158f">chiN</a> &lt; T(1.4) + T(2) / (N + 1);
<a name="l01387"></a>01387     <span class="keyword">const</span> T ccumcovinv = 1.-<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.ccumcov;
<a name="l01388"></a>01388     <span class="keyword">const</span> T hsigFactor = hsig*std::sqrt(<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.ccumcov*(T(2)-<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.ccumcov));
<a name="l01389"></a>01389     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; N; ++i)
<a name="l01390"></a>01390       <a class="code" href="classCMAES.html#a978c42dbaee69df8ac0cd5d480835579" title="Anisotropic evolution path (for covariance).">pc</a>[i] = ccumcovinv*<a class="code" href="classCMAES.html#a978c42dbaee69df8ac0cd5d480835579" title="Anisotropic evolution path (for covariance).">pc</a>[i] + hsigFactor*<a class="code" href="classCMAES.html#a73714d5cec116bef33aed344991536a2" title="B*D*z.">BDz</a>[i];
<a name="l01391"></a>01391 
<a name="l01392"></a>01392     <span class="comment">// update of C</span>
<a name="l01393"></a>01393     <a class="code" href="classCMAES.html#a2865ab646d4cbab7fa8e9c965b3d2b84">adaptC2</a>(hsig);
<a name="l01394"></a>01394 
<a name="l01395"></a>01395     <span class="comment">// update of sigma</span>
<a name="l01396"></a>01396     <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a> *= std::exp(((std::sqrt(psxps) / <a class="code" href="classCMAES.html#af5aff4dfec9d1eabe488c5f03395158f">chiN</a>) - T(1))* <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.cs / <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.damps);
<a name="l01397"></a>01397 
<a name="l01398"></a>01398     <a class="code" href="classCMAES.html#a2259ba2fee168dac1aed9a5de7e9703e">state</a> = <a class="code" href="classCMAES.html#a0cef0210cdaaf09dd1d40daf33127765a56c763404afb4ac45e7b81539eeb6fd2">UPDATED</a>;
<a name="l01399"></a>01399     <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="Mean x vector, &quot;parent&quot;.">xmean</a>;
<a name="l01400"></a>01400   }
<a name="l01401"></a>01401 
<a name="l01407"></a><a class="code" href="classCMAES.html#a45e773741a707a9f95a5c2bab07fcfca">01407</a>   T <span class="keyword">get</span>(<a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8" title="Keys for get().">GetScalar</a> key)
<a name="l01408"></a>01408   {
<a name="l01409"></a>01409     <span class="keywordflow">switch</span>(key)
<a name="l01410"></a>01410     {
<a name="l01411"></a>01411       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a80b1da110476f59b1dd637f86abcff6d">AxisRatio</a>:
<a name="l01412"></a>01412         <span class="keywordflow">return</span> <a class="code" href="utils_8h.html#a607a38043b6aa6f8501b8bfca777536f">maxElement</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>, <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N) / <a class="code" href="utils_8h.html#a5ab74da4f5c22d49151fd4c7c9a41dee">minElement</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>, <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N);
<a name="l01413"></a>01413       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a792dc72137eae9dff32d3d0ec7e520a0">Eval</a>:
<a name="l01414"></a>01414         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a4e328b09739d2fb1a220a3d7cf4bc82c" title="objective function evaluations">countevals</a>;
<a name="l01415"></a>01415       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8addcdd74505b48ad4a541db7b829e335b">Fitness</a>:
<a name="l01416"></a>01416         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#aa1ad648deeabde4621b932ec378551fc" title="Objective function values of the population.">functionValues</a>[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="Sorting index of sample population.">index</a>[0]];
<a name="l01417"></a>01417       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8ad21c49f13a72548684969bd0efadee5b">FBestEver</a>:
<a name="l01418"></a>01418         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a0b94ac84584f832f79084141bc768068" title="Best sample ever.">xBestEver</a>[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N];
<a name="l01419"></a>01419       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8acc3da801ee825cfe1d4546e7ff1df445">Generation</a>:
<a name="l01420"></a>01420         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a>;
<a name="l01421"></a>01421       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8aa6d0a2c0e925ea13fbc4eafdb0d73212">MaxEval</a>:
<a name="l01422"></a>01422         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.stopMaxFunEvals;
<a name="l01423"></a>01423       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a2f5dc38e6e11ee72a99131f66ac96ec6">MaxIter</a>:
<a name="l01424"></a>01424         <span class="keywordflow">return</span> std::ceil(<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.stopMaxIter);
<a name="l01425"></a>01425       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8ad08dc0a35ffc83e74e5ee207facfd9ae">MaxAxisLength</a>:
<a name="l01426"></a>01426         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#ae36bc85cdd41cb3db39b99a0303f6b6e">maxEW</a>);
<a name="l01427"></a>01427       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a69531e25f35ad31c729d8cbbdb0919ce">MinAxisLength</a>:
<a name="l01428"></a>01428         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#a9796be17293ba4549946392565368f41">minEW</a>);
<a name="l01429"></a>01429       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a2255eb5bbe0790bd7d8a59ebd6adcefc">MaxStdDev</a>:
<a name="l01430"></a>01430         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#a93eee1dc0a955f05fcabb5db15b64886">maxdiagC</a>);
<a name="l01431"></a>01431       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8ad2a4cb103c2cde9298f960900d82d9e5">MinStdDev</a>:
<a name="l01432"></a>01432         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#a0fc9beb46f3685e1f49f2575de3ce026">mindiagC</a>);
<a name="l01433"></a>01433       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8aa3da33927ee647a3f48e408b11c37946">Dimension</a>:
<a name="l01434"></a>01434         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N;
<a name="l01435"></a>01435       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a525cb5a156ebe9191586e97830aede31">SampleSize</a>:
<a name="l01436"></a>01436         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.lambda;
<a name="l01437"></a>01437       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a06a4d432f0d0783509dd88456ecd07ea">Sigma</a>:
<a name="l01438"></a>01438         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>;
<a name="l01439"></a>01439       <span class="keywordflow">default</span>:
<a name="l01440"></a>01440         <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;get(): No match found for key&quot;</span>);
<a name="l01441"></a>01441     }
<a name="l01442"></a>01442   }
<a name="l01443"></a>01443 
<a name="l01451"></a><a class="code" href="classCMAES.html#a818196db6e0a2bfcf800d4b6e644988e">01451</a>   <span class="keyword">const</span> T* <a class="code" href="classCMAES.html#a818196db6e0a2bfcf800d4b6e644988e" title="Request a vector parameter from CMA-ES.">getPtr</a>(<a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82" title="Keys for getPtr().">GetVector</a> key)
<a name="l01452"></a>01452   {
<a name="l01453"></a>01453     <span class="keywordflow">switch</span>(key)
<a name="l01454"></a>01454     {
<a name="l01455"></a>01455       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82ae17b1c54a0a0ab7c76d07eed386d9322">DiagC</a>:
<a name="l01456"></a>01456       {
<a name="l01457"></a>01457         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l01458"></a>01458           <a class="code" href="classCMAES.html#aeb4c1c5be50edcc7ed39c9599191c3e5" title="Output vector.">output</a>[i] = <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i][i];
<a name="l01459"></a>01459         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#aeb4c1c5be50edcc7ed39c9599191c3e5" title="Output vector.">output</a>;
<a name="l01460"></a>01460       }
<a name="l01461"></a>01461       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82a5bdd7c9d31b8273f97e54e30f6119399">DiagD</a>:
<a name="l01462"></a>01462         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>;
<a name="l01463"></a>01463       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82a0ec1a5126c8afaa5de18d488631e0694">StdDev</a>:
<a name="l01464"></a>01464       {
<a name="l01465"></a>01465         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l01466"></a>01466           <a class="code" href="classCMAES.html#aeb4c1c5be50edcc7ed39c9599191c3e5" title="Output vector.">output</a>[i] = <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i][i]);
<a name="l01467"></a>01467         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#aeb4c1c5be50edcc7ed39c9599191c3e5" title="Output vector.">output</a>;
<a name="l01468"></a>01468       }
<a name="l01469"></a>01469       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82aee6ad973ab7973ed05fbd787af5f4241">XBestEver</a>:
<a name="l01470"></a>01470         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a0b94ac84584f832f79084141bc768068" title="Best sample ever.">xBestEver</a>;
<a name="l01471"></a>01471       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82aeb635f2a8c23f4e25bd9ae0e0804bb7a">XBest</a>:
<a name="l01472"></a>01472         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a46ee9e7f9bb10e7a32af8e991dbc3c4d" title="x-vectors, lambda offspring.">population</a>[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="Sorting index of sample population.">index</a>[0]];
<a name="l01473"></a>01473       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82abe10ba6036cb0771e308fb1f9af27f48">XMean</a>:
<a name="l01474"></a>01474         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="Mean x vector, &quot;parent&quot;.">xmean</a>;
<a name="l01475"></a>01475       <span class="keywordflow">default</span>:
<a name="l01476"></a>01476         <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;getPtr(): No match found for key&quot;</span>);
<a name="l01477"></a>01477     }
<a name="l01478"></a>01478   }
<a name="l01479"></a>01479 
<a name="l01487"></a><a class="code" href="classCMAES.html#a573360ecfe2684493e0e256f9d5ea60d">01487</a>   T* <a class="code" href="classCMAES.html#a573360ecfe2684493e0e256f9d5ea60d" title="Request a vector parameter from CMA-ES.">getNew</a>(<a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82" title="Keys for getPtr().">GetVector</a> key)
<a name="l01488"></a>01488   {
<a name="l01489"></a>01489     <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a26ea206fe46a5bc687716dfb0802d74c" title="Request a vector parameter from CMA-ES.">getInto</a>(key, 0);
<a name="l01490"></a>01490   }
<a name="l01491"></a>01491 
<a name="l01499"></a><a class="code" href="classCMAES.html#a26ea206fe46a5bc687716dfb0802d74c">01499</a>   T* <a class="code" href="classCMAES.html#a26ea206fe46a5bc687716dfb0802d74c" title="Request a vector parameter from CMA-ES.">getInto</a>(<a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82" title="Keys for getPtr().">GetVector</a> key, T* res)
<a name="l01500"></a>01500   {
<a name="l01501"></a>01501     T <span class="keyword">const</span>* res0 = <a class="code" href="classCMAES.html#a818196db6e0a2bfcf800d4b6e644988e" title="Request a vector parameter from CMA-ES.">getPtr</a>(key);
<a name="l01502"></a>01502     <span class="keywordflow">if</span>(!res)
<a name="l01503"></a>01503       res = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N];
<a name="l01504"></a>01504     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l01505"></a>01505       res[i] = res0[i];
<a name="l01506"></a>01506     <span class="keywordflow">return</span> res;
<a name="l01507"></a>01507   }
<a name="l01508"></a>01508 
<a name="l01517"></a><a class="code" href="classCMAES.html#a5d3fb0bbff460e5901ef0e8a2bb2f839">01517</a>   <span class="keywordtype">bool</span> <a class="code" href="classCMAES.html#a5d3fb0bbff460e5901ef0e8a2bb2f839" title="Some stopping criteria can be set in initials.par, with names starting with stop...">testForTermination</a>()
<a name="l01518"></a>01518   {
<a name="l01519"></a>01519     T range, fac;
<a name="l01520"></a>01520     <span class="keywordtype">int</span> iAchse, iKoo;
<a name="l01521"></a>01521     <span class="keywordtype">int</span> diag = <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.diagonalCov == 1 || <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.diagonalCov &gt;= <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a>;
<a name="l01522"></a>01522     <span class="keywordtype">int</span> N = <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N;
<a name="l01523"></a>01523     std::stringstream message;
<a name="l01524"></a>01524 
<a name="l01525"></a>01525     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a0146e5c3a576c5f04e33c0ec3978a2e8" title="A message that contains all matched stop criteria.">stopMessage</a> != <span class="stringliteral">&quot;&quot;</span>)
<a name="l01526"></a>01526     {
<a name="l01527"></a>01527       message &lt;&lt; <a class="code" href="classCMAES.html#a0146e5c3a576c5f04e33c0ec3978a2e8" title="A message that contains all matched stop criteria.">stopMessage</a> &lt;&lt; std::endl;
<a name="l01528"></a>01528     }
<a name="l01529"></a>01529 
<a name="l01530"></a>01530     <span class="comment">// function value reached</span>
<a name="l01531"></a>01531     <span class="keywordflow">if</span>((<a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a> &gt; 1 || <a class="code" href="classCMAES.html#a2259ba2fee168dac1aed9a5de7e9703e">state</a> &gt; <a class="code" href="classCMAES.html#a0cef0210cdaaf09dd1d40daf33127765abf4219108f9e35e6816d0233af2a2e3e">SAMPLED</a>) &amp;&amp; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.stStopFitness.flg &amp;&amp;
<a name="l01532"></a>01532         <a class="code" href="classCMAES.html#aa1ad648deeabde4621b932ec378551fc" title="Objective function values of the population.">functionValues</a>[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="Sorting index of sample population.">index</a>[0]] &lt;= <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.stStopFitness.val)
<a name="l01533"></a>01533     {
<a name="l01534"></a>01534       message &lt;&lt; <span class="stringliteral">&quot;Fitness: function value &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#aa1ad648deeabde4621b932ec378551fc" title="Objective function values of the population.">functionValues</a>[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="Sorting index of sample population.">index</a>[0]]
<a name="l01535"></a>01535           &lt;&lt; <span class="stringliteral">&quot; &lt;= stopFitness (&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.stStopFitness.val &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;
<a name="l01536"></a>01536     }
<a name="l01537"></a>01537 
<a name="l01538"></a>01538     <span class="comment">// TolFun</span>
<a name="l01539"></a>01539     range = std::max(<a class="code" href="utils_8h.html#a607a38043b6aa6f8501b8bfca777536f">maxElement</a>(<a class="code" href="classCMAES.html#a2e91522e80428b2abd40947b2fb3ed4e" title="History of function values.">funcValueHistory</a>, (<span class="keywordtype">int</span>) std::min(<a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a>, *(<a class="code" href="classCMAES.html#a2e91522e80428b2abd40947b2fb3ed4e" title="History of function values.">funcValueHistory</a> - 1))),
<a name="l01540"></a>01540         <a class="code" href="utils_8h.html#a607a38043b6aa6f8501b8bfca777536f">maxElement</a>(<a class="code" href="classCMAES.html#aa1ad648deeabde4621b932ec378551fc" title="Objective function values of the population.">functionValues</a>, <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.lambda)) -
<a name="l01541"></a>01541         std::min(<a class="code" href="utils_8h.html#a5ab74da4f5c22d49151fd4c7c9a41dee">minElement</a>(<a class="code" href="classCMAES.html#a2e91522e80428b2abd40947b2fb3ed4e" title="History of function values.">funcValueHistory</a>, (<span class="keywordtype">int</span>) std::min(<a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a>, *(<a class="code" href="classCMAES.html#a2e91522e80428b2abd40947b2fb3ed4e" title="History of function values.">funcValueHistory</a> - 1))),
<a name="l01542"></a>01542         <a class="code" href="utils_8h.html#a5ab74da4f5c22d49151fd4c7c9a41dee">minElement</a>(<a class="code" href="classCMAES.html#aa1ad648deeabde4621b932ec378551fc" title="Objective function values of the population.">functionValues</a>, <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.lambda));
<a name="l01543"></a>01543 
<a name="l01544"></a>01544     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a> &gt; 0 &amp;&amp; range &lt;= <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.stopTolFun)
<a name="l01545"></a>01545     {
<a name="l01546"></a>01546       message &lt;&lt; <span class="stringliteral">&quot;TolFun: function value differences &quot;</span> &lt;&lt; range
<a name="l01547"></a>01547           &lt;&lt; <span class="stringliteral">&quot; &lt; stopTolFun=&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.stopTolFun &lt;&lt; std::endl;
<a name="l01548"></a>01548     }
<a name="l01549"></a>01549 
<a name="l01550"></a>01550     <span class="comment">// TolFunHist</span>
<a name="l01551"></a>01551     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a> &gt; *(<a class="code" href="classCMAES.html#a2e91522e80428b2abd40947b2fb3ed4e" title="History of function values.">funcValueHistory</a> - 1))
<a name="l01552"></a>01552     {
<a name="l01553"></a>01553       range = <a class="code" href="utils_8h.html#a607a38043b6aa6f8501b8bfca777536f">maxElement</a>(<a class="code" href="classCMAES.html#a2e91522e80428b2abd40947b2fb3ed4e" title="History of function values.">funcValueHistory</a>, (<span class="keywordtype">int</span>) *(<a class="code" href="classCMAES.html#a2e91522e80428b2abd40947b2fb3ed4e" title="History of function values.">funcValueHistory</a> - 1))
<a name="l01554"></a>01554           - <a class="code" href="utils_8h.html#a5ab74da4f5c22d49151fd4c7c9a41dee">minElement</a>(<a class="code" href="classCMAES.html#a2e91522e80428b2abd40947b2fb3ed4e" title="History of function values.">funcValueHistory</a>, (<span class="keywordtype">int</span>) *(<a class="code" href="classCMAES.html#a2e91522e80428b2abd40947b2fb3ed4e" title="History of function values.">funcValueHistory</a> - 1));
<a name="l01555"></a>01555       <span class="keywordflow">if</span>(range &lt;= <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.stopTolFunHist)
<a name="l01556"></a>01556         message &lt;&lt; <span class="stringliteral">&quot;TolFunHist: history of function value changes &quot;</span> &lt;&lt; range
<a name="l01557"></a>01557             &lt;&lt; <span class="stringliteral">&quot; stopTolFunHist=&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.stopTolFunHist &lt;&lt; std::endl;
<a name="l01558"></a>01558     }
<a name="l01559"></a>01559 
<a name="l01560"></a>01560     <span class="comment">// TolX</span>
<a name="l01561"></a>01561     <span class="keywordtype">int</span> cTemp = 0;
<a name="l01562"></a>01562     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; N; ++i)
<a name="l01563"></a>01563     {
<a name="l01564"></a>01564       cTemp += (<a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i][i]) &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.stopTolX) ? 1 : 0;
<a name="l01565"></a>01565       cTemp += (<a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>*<a class="code" href="classCMAES.html#a978c42dbaee69df8ac0cd5d480835579" title="Anisotropic evolution path (for covariance).">pc</a>[i] &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.stopTolX) ? 1 : 0;
<a name="l01566"></a>01566     }
<a name="l01567"></a>01567     <span class="keywordflow">if</span>(cTemp == 2*N)
<a name="l01568"></a>01568     {
<a name="l01569"></a>01569       message &lt;&lt; <span class="stringliteral">&quot;TolX: object variable changes below &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.stopTolX &lt;&lt; std::endl;
<a name="l01570"></a>01570     }
<a name="l01571"></a>01571 
<a name="l01572"></a>01572     <span class="comment">// TolUpX</span>
<a name="l01573"></a>01573     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; N; ++i)
<a name="l01574"></a>01574     {
<a name="l01575"></a>01575       <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[i][i]) &gt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.stopTolUpXFactor*<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.rgInitialStds[i])
<a name="l01576"></a>01576       {
<a name="l01577"></a>01577         message &lt;&lt; <span class="stringliteral">&quot;TolUpX: standard deviation increased by more than &quot;</span>
<a name="l01578"></a>01578             &lt;&lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.stopTolUpXFactor &lt;&lt; <span class="stringliteral">&quot;, larger initial standard deviation recommended.&quot;</span>
<a name="l01579"></a>01579             &lt;&lt; std::endl;
<a name="l01580"></a>01580         <span class="keywordflow">break</span>;
<a name="l01581"></a>01581       }
<a name="l01582"></a>01582     }
<a name="l01583"></a>01583 
<a name="l01584"></a>01584     <span class="comment">// Condition of C greater than dMaxSignifKond</span>
<a name="l01585"></a>01585     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#ae36bc85cdd41cb3db39b99a0303f6b6e">maxEW</a> &gt;= <a class="code" href="classCMAES.html#a9796be17293ba4549946392565368f41">minEW</a>* <a class="code" href="classCMAES.html#ae2163bc8eb11b8d28662ae985f51429b">dMaxSignifKond</a>)
<a name="l01586"></a>01586     {
<a name="l01587"></a>01587       message &lt;&lt; <span class="stringliteral">&quot;ConditionNumber: maximal condition number &quot;</span> &lt;&lt; dMaxSignifKond
<a name="l01588"></a>01588           &lt;&lt; <span class="stringliteral">&quot; reached. maxEW=&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#ae36bc85cdd41cb3db39b99a0303f6b6e">maxEW</a> &lt;&lt;  <span class="stringliteral">&quot;,minEW=&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a9796be17293ba4549946392565368f41">minEW</a> &lt;&lt; <span class="stringliteral">&quot;,maxdiagC=&quot;</span>
<a name="l01589"></a>01589           &lt;&lt; <a class="code" href="classCMAES.html#a93eee1dc0a955f05fcabb5db15b64886">maxdiagC</a> &lt;&lt; <span class="stringliteral">&quot;,mindiagC=&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a0fc9beb46f3685e1f49f2575de3ce026">mindiagC</a> &lt;&lt; std::endl;
<a name="l01590"></a>01590     }
<a name="l01591"></a>01591 
<a name="l01592"></a>01592     <span class="comment">// Principal axis i has no effect on xmean, ie. x == x + 0.1* sigma* rgD[i]* B[i]</span>
<a name="l01593"></a>01593     <span class="keywordflow">if</span>(!diag)
<a name="l01594"></a>01594     {
<a name="l01595"></a>01595       <span class="keywordflow">for</span>(iAchse = 0; iAchse &lt; N; ++iAchse)
<a name="l01596"></a>01596       {
<a name="l01597"></a>01597         fac = 0.1* <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>* <a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>[iAchse];
<a name="l01598"></a>01598         <span class="keywordflow">for</span>(iKoo = 0; iKoo &lt; N; ++iKoo)
<a name="l01599"></a>01599         {
<a name="l01600"></a>01600           <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="Mean x vector, &quot;parent&quot;.">xmean</a>[iKoo] != <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="Mean x vector, &quot;parent&quot;.">xmean</a>[iKoo] + fac* <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="Matrix with normalize eigenvectors in columns.">B</a>[iKoo][iAchse])
<a name="l01601"></a>01601             <span class="keywordflow">break</span>;
<a name="l01602"></a>01602         }
<a name="l01603"></a>01603         <span class="keywordflow">if</span>(iKoo == N)
<a name="l01604"></a>01604         {
<a name="l01605"></a>01605           message &lt;&lt; <span class="stringliteral">&quot;NoEffectAxis: standard deviation 0.1*&quot;</span> &lt;&lt; (fac / 0.1)
<a name="l01606"></a>01606               &lt;&lt; <span class="stringliteral">&quot; in principal axis &quot;</span> &lt;&lt; iAchse &lt;&lt; <span class="stringliteral">&quot; without effect&quot;</span> &lt;&lt; std::endl;
<a name="l01607"></a>01607           <span class="keywordflow">break</span>;
<a name="l01608"></a>01608         }
<a name="l01609"></a>01609       }
<a name="l01610"></a>01610     }
<a name="l01611"></a>01611     <span class="comment">// Component of xmean is not changed anymore</span>
<a name="l01612"></a>01612     <span class="keywordflow">for</span>(iKoo = 0; iKoo &lt; N; ++iKoo)
<a name="l01613"></a>01613     {
<a name="l01614"></a>01614       <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="Mean x vector, &quot;parent&quot;.">xmean</a>[iKoo] == <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="Mean x vector, &quot;parent&quot;.">xmean</a>[iKoo] + <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[iKoo][iKoo])/T(5))
<a name="l01615"></a>01615       {
<a name="l01616"></a>01616         message &lt;&lt; <span class="stringliteral">&quot;NoEffectCoordinate: standard deviation 0.2*&quot;</span>
<a name="l01617"></a>01617             &lt;&lt; (<a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="Step size.">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="Lower triangular matrix: i&gt;=j for C[i][j].">C</a>[iKoo][iKoo])) &lt;&lt; <span class="stringliteral">&quot; in coordinate &quot;</span> &lt;&lt; iKoo
<a name="l01618"></a>01618             &lt;&lt; <span class="stringliteral">&quot; without effect&quot;</span> &lt;&lt; std::endl;
<a name="l01619"></a>01619         <span class="keywordflow">break</span>;
<a name="l01620"></a>01620       }
<a name="l01621"></a>01621     }
<a name="l01622"></a>01622 
<a name="l01623"></a>01623     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a4e328b09739d2fb1a220a3d7cf4bc82c" title="objective function evaluations">countevals</a> &gt;= <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.stopMaxFunEvals)
<a name="l01624"></a>01624     {
<a name="l01625"></a>01625       message &lt;&lt; <span class="stringliteral">&quot;MaxFunEvals: conducted function evaluations &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a4e328b09739d2fb1a220a3d7cf4bc82c" title="objective function evaluations">countevals</a>
<a name="l01626"></a>01626           &lt;&lt; <span class="stringliteral">&quot; &gt;= &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.stopMaxFunEvals &lt;&lt; std::endl;
<a name="l01627"></a>01627     }
<a name="l01628"></a>01628     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a> &gt;= <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.stopMaxIter)
<a name="l01629"></a>01629     {
<a name="l01630"></a>01630       message &lt;&lt; <span class="stringliteral">&quot;MaxIter: number of iterations &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a> &lt;&lt; <span class="stringliteral">&quot; &gt;= &quot;</span>
<a name="l01631"></a>01631           &lt;&lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.stopMaxIter &lt;&lt; std::endl;
<a name="l01632"></a>01632     }
<a name="l01633"></a>01633 
<a name="l01634"></a>01634     <a class="code" href="classCMAES.html#a0146e5c3a576c5f04e33c0ec3978a2e8" title="A message that contains all matched stop criteria.">stopMessage</a> = message.str();
<a name="l01635"></a>01635     <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a0146e5c3a576c5f04e33c0ec3978a2e8" title="A message that contains all matched stop criteria.">stopMessage</a> != <span class="stringliteral">&quot;&quot;</span>;
<a name="l01636"></a>01636   }
<a name="l01637"></a>01637 
<a name="l01642"></a><a class="code" href="classCMAES.html#a3a09215b6efefde35c9faa5c2201c7a7">01642</a>   std::string <a class="code" href="classCMAES.html#a3a09215b6efefde35c9faa5c2201c7a7" title="A message that contains a detailed description of the matched stop criteria.">getStopMessage</a>()
<a name="l01643"></a>01643   {
<a name="l01644"></a>01644     <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a0146e5c3a576c5f04e33c0ec3978a2e8" title="A message that contains all matched stop criteria.">stopMessage</a>;
<a name="l01645"></a>01645   }
<a name="l01646"></a>01646 
<a name="l01652"></a><a class="code" href="classCMAES.html#a57ea7bb50956aed2aa9eb03f7233f71e">01652</a>   <span class="keywordtype">void</span> <a class="code" href="classCMAES.html#a57ea7bb50956aed2aa9eb03f7233f71e">writeToFile</a>(<span class="keywordtype">int</span> key, <span class="keyword">const</span> std::string&amp; filename)
<a name="l01653"></a>01653   {
<a name="l01654"></a>01654     std::ofstream file;
<a name="l01655"></a>01655     file.open(filename.c_str(), std::ios_base::app);
<a name="l01656"></a>01656 
<a name="l01657"></a>01657     <span class="keywordflow">if</span>(file.is_open())
<a name="l01658"></a>01658     {
<a name="l01659"></a>01659       <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a> &gt; 0 || filename.substr(0, 11) != <span class="stringliteral">&quot;outcmaesfit&quot;</span>)
<a name="l01660"></a>01660         <a class="code" href="classCMAES.html#a886643be9124a2910aa765ad04e4ca84" title="This hack reads key words from input key for data to be written to a file, see file signals...">writeToStream</a>(key, file); <span class="comment">/* do not write fitness for gen==0 */</span>
<a name="l01661"></a>01661       file.close();
<a name="l01662"></a>01662     }
<a name="l01663"></a>01663     <span class="keywordflow">else</span>
<a name="l01664"></a>01664     {
<a name="l01665"></a>01665       <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;writeToFile(): could not open &#39;&quot;</span> + filename + <span class="stringliteral">&quot;&#39;&quot;</span>);
<a name="l01666"></a>01666     }
<a name="l01667"></a>01667   }
<a name="l01668"></a>01668 
<a name="l01676"></a><a class="code" href="classCMAES.html#ae0dcc966a2b41a9f35724c5f65e87cf5">01676</a>   <span class="keywordtype">void</span> <a class="code" href="classCMAES.html#ae0dcc966a2b41a9f35724c5f65e87cf5" title="Conducts the eigendecomposition of C into B and D such that  and  and D diagonal and positive...">updateEigensystem</a>(<span class="keywordtype">bool</span> force)
<a name="l01677"></a>01677   {
<a name="l01678"></a>01678     <a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">eigenTimings</a>.<a class="code" href="classTiming.html#a9973978adb63702db5affd6f77b98fc5">update</a>();
<a name="l01679"></a>01679 
<a name="l01680"></a>01680     <span class="keywordflow">if</span>(!force)
<a name="l01681"></a>01681     {
<a name="l01682"></a>01682       <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#ade7b4d250edba249dfcfdc2e2396246e">eigensysIsUptodate</a>)
<a name="l01683"></a>01683         <span class="keywordflow">return</span>;
<a name="l01684"></a>01684       <span class="comment">// return on modulo generation number</span>
<a name="l01685"></a>01685       <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a> &lt; <a class="code" href="classCMAES.html#a6f4acfc9073c8320c00bb0faa9efcdcb">genOfEigensysUpdate</a> + <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.updateCmode.modulo)
<a name="l01686"></a>01686         <span class="keywordflow">return</span>;
<a name="l01687"></a>01687       <span class="comment">// return on time percentage</span>
<a name="l01688"></a>01688       <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.updateCmode.maxtime &lt; 1.00
<a name="l01689"></a>01689           &amp;&amp; <a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">eigenTimings</a>.<a class="code" href="classTiming.html#adfb11a76f87914807cdfe39bcef0a0af">tictoctime</a> &gt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.updateCmode.maxtime* <a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">eigenTimings</a>.<a class="code" href="classTiming.html#acbd8393d5e1bd7d78e6e6f26cf1850c3">totaltime</a>
<a name="l01690"></a>01690           &amp;&amp; <a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">eigenTimings</a>.<a class="code" href="classTiming.html#adfb11a76f87914807cdfe39bcef0a0af">tictoctime</a> &gt; 0.0002)
<a name="l01691"></a>01691         <span class="keywordflow">return</span>;
<a name="l01692"></a>01692     }
<a name="l01693"></a>01693 
<a name="l01694"></a>01694     <a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">eigenTimings</a>.<a class="code" href="classTiming.html#ac7c5f73d8c5595cb6a2f02f9df913851">tic</a>();
<a name="l01695"></a>01695     <a class="code" href="classCMAES.html#a77ac5ff94fbff0bed5ce9e8d83f890ee" title="Calculating eigenvalues and vectors.">eigen</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>, <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="Matrix with normalize eigenvectors in columns.">B</a>, <a class="code" href="classCMAES.html#a9aa6c060f3f33a4e07b20133c429b3bb" title="Temporary (random) vector used in different places.">tempRandom</a>);
<a name="l01696"></a>01696     <a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">eigenTimings</a>.<a class="code" href="classTiming.html#a173ec27a4c1feb364370a920d28ec23b">toc</a>();
<a name="l01697"></a>01697 
<a name="l01698"></a>01698     <span class="comment">// find largest and smallest eigenvalue, they are supposed to be sorted anyway</span>
<a name="l01699"></a>01699     <a class="code" href="classCMAES.html#a9796be17293ba4549946392565368f41">minEW</a> = <a class="code" href="utils_8h.html#a5ab74da4f5c22d49151fd4c7c9a41dee">minElement</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>, <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N);
<a name="l01700"></a>01700     <a class="code" href="classCMAES.html#ae36bc85cdd41cb3db39b99a0303f6b6e">maxEW</a> = <a class="code" href="utils_8h.html#a607a38043b6aa6f8501b8bfca777536f">maxElement</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>, <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N);
<a name="l01701"></a>01701 
<a name="l01702"></a>01702     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a09f393f2ef964f14f6b668bc91657650" title="control via signals.par">doCheckEigen</a>) <span class="comment">// needs O(n^3)! writes, in case, error message in error file</span>
<a name="l01703"></a>01703       <a class="code" href="classCMAES.html#a770b17733d7d66fae4654823736d9c26" title="Exhaustive test of the output of the eigendecomposition, needs O(n^3) operations writes to error file...">checkEigen</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>, <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="Matrix with normalize eigenvectors in columns.">B</a>);
<a name="l01704"></a>01704 
<a name="l01705"></a>01705     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l01706"></a>01706       <a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>[i] = std::sqrt(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="Axis lengths.">rgD</a>[i]);
<a name="l01707"></a>01707 
<a name="l01708"></a>01708     <a class="code" href="classCMAES.html#ade7b4d250edba249dfcfdc2e2396246e">eigensysIsUptodate</a> = <span class="keyword">true</span>;
<a name="l01709"></a>01709     <a class="code" href="classCMAES.html#a6f4acfc9073c8320c00bb0faa9efcdcb">genOfEigensysUpdate</a> = <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a>;
<a name="l01710"></a>01710   }
<a name="l01711"></a>01711 
<a name="l01718"></a><a class="code" href="classCMAES.html#aa61a791319fb10455ed26a77edded44d">01718</a>   T <span class="keyword">const</span>* <a class="code" href="classCMAES.html#aa61a791319fb10455ed26a77edded44d" title="Distribution mean could be changed before samplePopulation().">setMean</a>(<span class="keyword">const</span> T* newxmean)
<a name="l01719"></a>01719   {
<a name="l01720"></a>01720     assert(<a class="code" href="classCMAES.html#a2259ba2fee168dac1aed9a5de7e9703e">state</a> != <a class="code" href="classCMAES.html#a0cef0210cdaaf09dd1d40daf33127765abf4219108f9e35e6816d0233af2a2e3e">SAMPLED</a> &amp;&amp; <span class="stringliteral">&quot;setMean: mean cannot be set inbetween the calls&quot;</span>
<a name="l01721"></a>01721         <span class="stringliteral">&quot;of samplePopulation and updateDistribution&quot;</span>);
<a name="l01722"></a>01722 
<a name="l01723"></a>01723     <span class="keywordflow">if</span>(newxmean &amp;&amp; newxmean != <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="Mean x vector, &quot;parent&quot;.">xmean</a>)
<a name="l01724"></a>01724       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a199cccfa1c04c5825d1a1555b96e6ed0">params</a>.N; ++i)
<a name="l01725"></a>01725         <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="Mean x vector, &quot;parent&quot;.">xmean</a>[i] = newxmean[i];
<a name="l01726"></a>01726     <span class="keywordflow">else</span>
<a name="l01727"></a>01727       newxmean = <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="Mean x vector, &quot;parent&quot;.">xmean</a>;
<a name="l01728"></a>01728 
<a name="l01729"></a>01729     <span class="keywordflow">return</span> newxmean;
<a name="l01730"></a>01730   }
<a name="l01731"></a>01731 };
</pre></div></div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Friends</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Sun Mar 4 2012 00:44:45 for CMA-ES by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
