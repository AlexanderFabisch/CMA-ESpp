<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>CMA-ES: cma-es/cmaes.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CMA-ES</div>
   <div id="projectbrief">A C++ implementation of CMA-ES.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_31cc3052683361e99e57b7ec16c064ae.html">cma-es</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>cmaes.h</h1>  </div>
</div>
<div class="contents">
<a href="cmaes_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00096"></a>00096 <span class="preprocessor">#pragma once</span>
<a name="l00097"></a>00097 <span class="preprocessor"></span>
<a name="l00098"></a>00098 <span class="preprocessor">#include &quot;<a class="code" href="parameters_8h.html">parameters.h</a>&quot;</span>
<a name="l00099"></a>00099 <span class="preprocessor">#include &quot;<a class="code" href="random_8h.html">random.h</a>&quot;</span>
<a name="l00100"></a>00100 <span class="preprocessor">#include &quot;<a class="code" href="timings_8h.html">timings.h</a>&quot;</span>
<a name="l00101"></a>00101 <span class="preprocessor">#include &quot;<a class="code" href="utils_8h.html" title="Contains some utility functions.">utils.h</a>&quot;</span>
<a name="l00102"></a>00102 <span class="preprocessor">#include &lt;cassert&gt;</span>
<a name="l00103"></a>00103 <span class="preprocessor">#include &lt;cmath&gt;</span>
<a name="l00104"></a>00104 <span class="preprocessor">#include &lt;cstdio&gt;</span>
<a name="l00105"></a>00105 <span class="preprocessor">#include &lt;cstring&gt;</span>
<a name="l00106"></a>00106 <span class="preprocessor">#include &lt;fstream&gt;</span>
<a name="l00107"></a>00107 <span class="preprocessor">#include &lt;limits&gt;</span>
<a name="l00108"></a>00108 <span class="preprocessor">#include &lt;iomanip&gt;</span>
<a name="l00109"></a>00109 <span class="preprocessor">#include &lt;sstream&gt;</span>
<a name="l00110"></a>00110 <span class="preprocessor">#include &lt;stdexcept&gt;</span>
<a name="l00111"></a>00111 <span class="preprocessor">#include &lt;string&gt;</span>
<a name="l00112"></a>00112 
<a name="l00118"></a>00118 <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;
<a name="l00119"></a><a class="code" href="classCMAES.html">00119</a> <span class="keyword">class </span><a class="code" href="classCMAES.html" title="Evolution Strategies with Covariance Matrix Adaptation.">CMAES</a>
<a name="l00120"></a>00120 {
<a name="l00121"></a>00121 <span class="keyword">public</span>:
<a name="l00122"></a>00122 
<a name="l00126"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8">00126</a>   <span class="keyword">enum</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8" title="Keys for get().">GetScalar</a>
<a name="l00127"></a>00127   {
<a name="l00128"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a0eac9fcd31997fbce7b050fea059146c">00128</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a0eac9fcd31997fbce7b050fea059146c">NoScalar</a> = 0,
<a name="l00129"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a80b1da110476f59b1dd637f86abcff6d">00129</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a80b1da110476f59b1dd637f86abcff6d">AxisRatio</a> = 1,
<a name="l00130"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a3d094cfa5259537cb5866df1aa30dabf">00130</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a792dc72137eae9dff32d3d0ec7e520a0">Eval</a> = 2, <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a3d094cfa5259537cb5866df1aa30dabf">Evaluations</a> = 2,
<a name="l00131"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a24a927cfe7f5c73c47e8f5395abc0e7a">00131</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8abda053a0cb2db42a16e0acfcdffc1f5d">FctValue</a> = 3, <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a0a185991edec9d5597e958a825ccef8b">FuncValue</a> = 3, <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a24a927cfe7f5c73c47e8f5395abc0e7a">FunValue</a> = 3, <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8addcdd74505b48ad4a541db7b829e335b">Fitness</a> = 3,
<a name="l00132"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8ad21c49f13a72548684969bd0efadee5b">00132</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8ad21c49f13a72548684969bd0efadee5b">FBestEver</a> = 4,
<a name="l00133"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a227350ef92ae76a118395539614413ea">00133</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8acc3da801ee825cfe1d4546e7ff1df445">Generation</a> = 5, <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a227350ef92ae76a118395539614413ea">Iteration</a> = 5,
<a name="l00134"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8ac2a58bc5ffa24f12ec92e11c18e8d4a1">00134</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8aa6d0a2c0e925ea13fbc4eafdb0d73212">MaxEval</a> = 6, <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8ae9d7f8b79143385c7b106bbbf3c2d412">MaxFunEvals</a> = 6, <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8ac2a58bc5ffa24f12ec92e11c18e8d4a1">StopMaxFunEvals</a> = 6,
<a name="l00135"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8aeb3dce345e47ca1fcc222d4fde877a3a">00135</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8af273a71dfa8af4b2512e63b85255c57b">MaxGen</a> = 7, <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a2f5dc38e6e11ee72a99131f66ac96ec6">MaxIter</a> = 7, <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8aeb3dce345e47ca1fcc222d4fde877a3a">StopMaxIter</a> = 7,
<a name="l00136"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8ad08dc0a35ffc83e74e5ee207facfd9ae">00136</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8ad08dc0a35ffc83e74e5ee207facfd9ae">MaxAxisLength</a> = 8,
<a name="l00137"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a69531e25f35ad31c729d8cbbdb0919ce">00137</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a69531e25f35ad31c729d8cbbdb0919ce">MinAxisLength</a> = 9,
<a name="l00138"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a2255eb5bbe0790bd7d8a59ebd6adcefc">00138</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a2255eb5bbe0790bd7d8a59ebd6adcefc">MaxStdDev</a> = 10,
<a name="l00139"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8ad2a4cb103c2cde9298f960900d82d9e5">00139</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8ad2a4cb103c2cde9298f960900d82d9e5">MinStdDev</a> = 11,
<a name="l00140"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8aa3da33927ee647a3f48e408b11c37946">00140</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a75e12eda134ea0f0eca86ee1833e561e">Dim</a> = 12, <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8aa3da33927ee647a3f48e408b11c37946">Dimension</a> = 12,
<a name="l00141"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a525cb5a156ebe9191586e97830aede31">00141</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a0a7cf2fff11dd8b8ad79f21540313a76">Lambda</a> = 13, <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a525cb5a156ebe9191586e97830aede31">SampleSize</a> = 13, <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a8fa009b49ad74ed50cb8639d94ce4d00">PopSize</a> = 13,
<a name="l00142"></a><a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a06a4d432f0d0783509dd88456ecd07ea">00142</a>     <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a06a4d432f0d0783509dd88456ecd07ea">Sigma</a> = 14
<a name="l00143"></a>00143   };
<a name="l00144"></a>00144 
<a name="l00148"></a><a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82">00148</a>   <span class="keyword">enum</span> <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82" title="Keys for getPtr().">GetVector</a>
<a name="l00149"></a>00149   {
<a name="l00150"></a><a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82af40a2e44d652a00a9ccd9edec2009af0">00150</a>     <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82af40a2e44d652a00a9ccd9edec2009af0">NoVector</a> = 0,
<a name="l00151"></a><a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82ae17b1c54a0a0ab7c76d07eed386d9322">00151</a>     <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82ae17b1c54a0a0ab7c76d07eed386d9322">DiagC</a> = 1,
<a name="l00152"></a><a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82a5bdd7c9d31b8273f97e54e30f6119399">00152</a>     <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82a5bdd7c9d31b8273f97e54e30f6119399">DiagD</a> = 2,
<a name="l00153"></a><a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82a0ec1a5126c8afaa5de18d488631e0694">00153</a>     <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82a0ec1a5126c8afaa5de18d488631e0694">StdDev</a> = 3,
<a name="l00154"></a><a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82aee6ad973ab7973ed05fbd787af5f4241">00154</a>     <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82aee6ad973ab7973ed05fbd787af5f4241">XBestEver</a> = 4,
<a name="l00155"></a><a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82aeb635f2a8c23f4e25bd9ae0e0804bb7a">00155</a>     <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82aeb635f2a8c23f4e25bd9ae0e0804bb7a">XBest</a> = 5,
<a name="l00156"></a><a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82abe10ba6036cb0771e308fb1f9af27f48">00156</a>     <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82abe10ba6036cb0771e308fb1f9af27f48">XMean</a> = 6
<a name="l00157"></a>00157   };
<a name="l00158"></a>00158 
<a name="l00162"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5">00162</a>   <span class="keyword">enum</span> <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5" title="Keys for writeToFile().">WriteKey</a>
<a name="l00163"></a>00163   {
<a name="l00164"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a21e38dd471b82a293b061500ada251c6">00164</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a21e38dd471b82a293b061500ada251c6">WCNone</a> = 0,
<a name="l00165"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5aa149aa30989f563b45db616cf69a375b">00165</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5aa149aa30989f563b45db616cf69a375b">WKResume</a> = 1,
<a name="l00166"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5ab430a1a4c4f6030e67f76d49dc1acd76">00166</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5ab430a1a4c4f6030e67f76d49dc1acd76">WKXMean</a> = 2,
<a name="l00167"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a61d330c96de9b673a0076606bea2b59b">00167</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a61d330c96de9b673a0076606bea2b59b">WKC</a> = 4,
<a name="l00168"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5abbf04a8ffe5c7bccecf352e294e9c099">00168</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5abbf04a8ffe5c7bccecf352e294e9c099">WKAll</a> = 8,
<a name="l00169"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a07d0282b9c7d9719df60fbc03f5a6eab">00169</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a07d0282b9c7d9719df60fbc03f5a6eab">WKFewInfo</a> = 16,
<a name="l00170"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5ac8b7485532d066b19565db85e060aeac">00170</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5ac8b7485532d066b19565db85e060aeac">WKFew</a> = 32,
<a name="l00171"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a92d1998fb46900bceb39a60e3ed35746">00171</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a92d1998fb46900bceb39a60e3ed35746">WKEval</a> = 64,
<a name="l00172"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a3bab88222e97d560b05cdcd7f5d967f0">00172</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a3bab88222e97d560b05cdcd7f5d967f0">WKFitness</a> = 128,
<a name="l00173"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a689dedaccffee9f44f969a838f62b2a3">00173</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a689dedaccffee9f44f969a838f62b2a3">WKFBestEver</a> = 256,
<a name="l00174"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5af74d31e6940d9c55b13935971bfd764d">00174</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5af74d31e6940d9c55b13935971bfd764d">WKCGeneration</a> = 512,
<a name="l00175"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a393a8956a826379f2918b1a0193ceead">00175</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a393a8956a826379f2918b1a0193ceead">WKSigma</a> = 1024,
<a name="l00176"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5ab3b3919789e241ae3ae2c855d17c7528">00176</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5ab3b3919789e241ae3ae2c855d17c7528">WKLambda</a> = 2048,
<a name="l00177"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a407d38eb1d75495aa388416be4fb9673">00177</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a407d38eb1d75495aa388416be4fb9673">WKB</a> = 4096,
<a name="l00178"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a9b15493966d6f12f6e3135046cd6ae24">00178</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a9b15493966d6f12f6e3135046cd6ae24">WKXBest</a> = 8192,
<a name="l00179"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a939618e4c01b55a93ead6992a16e7d80">00179</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a939618e4c01b55a93ead6992a16e7d80">WKClock</a> = 16384,
<a name="l00180"></a><a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a7213701c32edd96cbca9697368af03ae">00180</a>     <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a7213701c32edd96cbca9697368af03ae">WKDim</a> = 32768
<a name="l00181"></a>00181   };
<a name="l00182"></a>00182 
<a name="l00183"></a>00183 <span class="keyword">private</span>:
<a name="l00184"></a>00184 
<a name="l00185"></a><a class="code" href="classCMAES.html#a39f33a47d224feccbb0f31bc3b24f922">00185</a>   std::string <a class="code" href="classCMAES.html#a39f33a47d224feccbb0f31bc3b24f922" title="Implementation version.">version</a>; 
<a name="l00186"></a><a class="code" href="classCMAES.html#a73e60929e1e08ea6f9f4a5cec6f020b4">00186</a>   <a class="code" href="classRandom.html" title="A pseudo random number generator.">Random&lt;T&gt;</a> <a class="code" href="classCMAES.html#a73e60929e1e08ea6f9f4a5cec6f020b4" title="Random number generator.">rand</a>; 
<a name="l00187"></a><a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab">00187</a>   <a class="code" href="classParameters.html" title="Holds all parameters that can be adjusted by the user.">Parameters&lt;T&gt;</a> <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>; 
<a name="l00188"></a>00188 
<a name="l00189"></a><a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4">00189</a>   T <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>; 
<a name="l00190"></a><a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191">00190</a>   T* <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="mean x vector, &amp;quot;parent&amp;quot;">xmean</a>; 
<a name="l00191"></a><a class="code" href="classCMAES.html#a33b5fc42be0304dc3ca66f3923d6d6ed">00191</a>   T* <a class="code" href="classCMAES.html#a33b5fc42be0304dc3ca66f3923d6d6ed" title="best sample ever">rgxbestever</a>; 
<a name="l00192"></a><a class="code" href="classCMAES.html#ae85f01391da333e830437e46671b5b4d">00192</a>   T** <a class="code" href="classCMAES.html#ae85f01391da333e830437e46671b5b4d" title="x-vectors, lambda offspring">rgrgx</a>; 
<a name="l00193"></a><a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3">00193</a>   <span class="keywordtype">int</span>* <a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="sorting index of sample pop.">index</a>; 
<a name="l00194"></a><a class="code" href="classCMAES.html#ad5c0bde5c3688de59e830e852ef17e44">00194</a>   T* <a class="code" href="classCMAES.html#ad5c0bde5c3688de59e830e852ef17e44">arFuncValueHist</a>;
<a name="l00195"></a>00195 
<a name="l00196"></a><a class="code" href="classCMAES.html#af5aff4dfec9d1eabe488c5f03395158f">00196</a>   T <a class="code" href="classCMAES.html#af5aff4dfec9d1eabe488c5f03395158f">chiN</a>;
<a name="l00197"></a><a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d">00197</a>   T** <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>; 
<a name="l00198"></a><a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0">00198</a>   T** <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="matrix with normalize eigenvectors in columns">B</a>; 
<a name="l00199"></a><a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1">00199</a>   T* <a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>; 
<a name="l00200"></a>00200 
<a name="l00204"></a><a class="code" href="classCMAES.html#a959adefafdb32f8e1f56a478c28cc2b7">00204</a>   T* <a class="code" href="classCMAES.html#a959adefafdb32f8e1f56a478c28cc2b7" title="anisotropic evolution path (for covariance)">rgpc</a>;
<a name="l00208"></a><a class="code" href="classCMAES.html#af032f05a04ebce55701225bccc9c60f7">00208</a>   T* <a class="code" href="classCMAES.html#af032f05a04ebce55701225bccc9c60f7" title="isotropic evolution path (for step length)">rgps</a>;
<a name="l00209"></a><a class="code" href="classCMAES.html#a09e7f98cfed00b8847c411faaa28a935">00209</a>   T* <a class="code" href="classCMAES.html#a09e7f98cfed00b8847c411faaa28a935">rgxold</a>;
<a name="l00210"></a><a class="code" href="classCMAES.html#a0632e9bfd6e6f6db52df1e988b7d3758">00210</a>   T* <a class="code" href="classCMAES.html#a0632e9bfd6e6f6db52df1e988b7d3758">rgout</a>;
<a name="l00211"></a><a class="code" href="classCMAES.html#af70aca7676a8a393591e3813dfd244c6">00211</a>   T* <a class="code" href="classCMAES.html#af70aca7676a8a393591e3813dfd244c6" title="for B*D*z">rgBDz</a>; 
<a name="l00212"></a><a class="code" href="classCMAES.html#a75bd9d32b150084d1e6771c7806367b9">00212</a>   T* <a class="code" href="classCMAES.html#a75bd9d32b150084d1e6771c7806367b9" title="temporary (random) vector used in different places">rgdTmp</a>; 
<a name="l00213"></a><a class="code" href="classCMAES.html#a3766a33cf5871b68715921aa5df60118">00213</a>   T* <a class="code" href="classCMAES.html#a3766a33cf5871b68715921aa5df60118">rgFuncValue</a>;
<a name="l00214"></a><a class="code" href="classCMAES.html#a4ed94ed86d47a4903cb11eacd1f703e5">00214</a>   T* <a class="code" href="classCMAES.html#a4ed94ed86d47a4903cb11eacd1f703e5" title="returned by init()">publicFitness</a>; 
<a name="l00215"></a>00215 
<a name="l00216"></a><a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3">00216</a>   T <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a>; 
<a name="l00217"></a><a class="code" href="classCMAES.html#a0cef0210cdaaf09dd1d40daf33127765a56c763404afb4ac45e7b81539eeb6fd2">00217</a>   <span class="keyword">enum</span> {<a class="code" href="classCMAES.html#a0cef0210cdaaf09dd1d40daf33127765acdf19eb2e5b851d7af910fa38ac814e7">INITIALIZED</a>, <a class="code" href="classCMAES.html#a0cef0210cdaaf09dd1d40daf33127765abf4219108f9e35e6816d0233af2a2e3e">SAMPLED</a>, <a class="code" href="classCMAES.html#a0cef0210cdaaf09dd1d40daf33127765a56c763404afb4ac45e7b81539eeb6fd2">UPDATED</a>} <a class="code" href="classCMAES.html#a2259ba2fee168dac1aed9a5de7e9703e" title="algorithm state">state</a>; 
<a name="l00218"></a>00218 
<a name="l00219"></a><a class="code" href="classCMAES.html#a93eee1dc0a955f05fcabb5db15b64886">00219</a>   T <a class="code" href="classCMAES.html#a93eee1dc0a955f05fcabb5db15b64886" title="repeatedly used for output">maxdiagC</a>; 
<a name="l00220"></a><a class="code" href="classCMAES.html#a0fc9beb46f3685e1f49f2575de3ce026">00220</a>   T <a class="code" href="classCMAES.html#a0fc9beb46f3685e1f49f2575de3ce026">mindiagC</a>;
<a name="l00221"></a><a class="code" href="classCMAES.html#ae36bc85cdd41cb3db39b99a0303f6b6e">00221</a>   T <a class="code" href="classCMAES.html#ae36bc85cdd41cb3db39b99a0303f6b6e">maxEW</a>;
<a name="l00222"></a><a class="code" href="classCMAES.html#a9796be17293ba4549946392565368f41">00222</a>   T <a class="code" href="classCMAES.html#a9796be17293ba4549946392565368f41">minEW</a>;
<a name="l00223"></a>00223 
<a name="l00224"></a><a class="code" href="classCMAES.html#ade7b4d250edba249dfcfdc2e2396246e">00224</a>   <span class="keywordtype">bool</span> <a class="code" href="classCMAES.html#ade7b4d250edba249dfcfdc2e2396246e">eigensysIsUptodate</a>;
<a name="l00225"></a><a class="code" href="classCMAES.html#a09f393f2ef964f14f6b668bc91657650">00225</a>   <span class="keywordtype">bool</span> <a class="code" href="classCMAES.html#a09f393f2ef964f14f6b668bc91657650" title="control via signals.par">doCheckEigen</a>; 
<a name="l00226"></a><a class="code" href="classCMAES.html#a6f4acfc9073c8320c00bb0faa9efcdcb">00226</a>   T <a class="code" href="classCMAES.html#a6f4acfc9073c8320c00bb0faa9efcdcb">genOfEigensysUpdate</a>;
<a name="l00227"></a>00227 
<a name="l00228"></a><a class="code" href="classCMAES.html#ae2163bc8eb11b8d28662ae985f51429b">00228</a>   T <a class="code" href="classCMAES.html#ae2163bc8eb11b8d28662ae985f51429b">dMaxSignifKond</a>;
<a name="l00229"></a><a class="code" href="classCMAES.html#a89e9afdc9f28b153f6939039117080f1">00229</a>   T <a class="code" href="classCMAES.html#a89e9afdc9f28b153f6939039117080f1">dLastMinEWgroesserNull</a>;
<a name="l00230"></a>00230 
<a name="l00231"></a><a class="code" href="classCMAES.html#a5ef76c4c2d5833429dc868ed8d2c6709">00231</a>   <span class="keywordtype">bool</span> <a class="code" href="classCMAES.html#a5ef76c4c2d5833429dc868ed8d2c6709">isResumeDone</a>;
<a name="l00232"></a>00232 
<a name="l00233"></a><a class="code" href="classCMAES.html#a31915e1cc29d88faee41c1f45d3d5a2a">00233</a>   time_t <a class="code" href="classCMAES.html#a31915e1cc29d88faee41c1f45d3d5a2a">printtime</a>;
<a name="l00234"></a><a class="code" href="classCMAES.html#a9f27aaa233806a6823b96d83059c68e1">00234</a>   time_t <a class="code" href="classCMAES.html#a9f27aaa233806a6823b96d83059c68e1" title="ideally should keep track for each output file">writetime</a>; 
<a name="l00235"></a><a class="code" href="classCMAES.html#a72e456703b11bdcd7c273a2b764faf70">00235</a>   time_t <a class="code" href="classCMAES.html#a72e456703b11bdcd7c273a2b764faf70">firstwritetime</a>;
<a name="l00236"></a><a class="code" href="classCMAES.html#ae5b668b5b4bacd4048c6742650801356">00236</a>   time_t <a class="code" href="classCMAES.html#ae5b668b5b4bacd4048c6742650801356">firstprinttime</a>;
<a name="l00237"></a>00237 
<a name="l00238"></a><a class="code" href="classCMAES.html#a0146e5c3a576c5f04e33c0ec3978a2e8">00238</a>   std::string <a class="code" href="classCMAES.html#a0146e5c3a576c5f04e33c0ec3978a2e8" title="A message that contains all matched stop criteria.">stopMessage</a>; 
<a name="l00239"></a>00239 
<a name="l00240"></a><a class="code" href="classCMAES.html#aed17d3f1a936b1f640203d17f0422743">00240</a>   std::string <a class="code" href="classCMAES.html#aed17d3f1a936b1f640203d17f0422743">getTimeStr</a>(<span class="keywordtype">void</span>)
<a name="l00241"></a>00241   {
<a name="l00242"></a>00242     time_t tm = time(0);
<a name="l00243"></a>00243     std::string timeStr(ctime(&amp;tm));
<a name="l00244"></a>00244     <span class="keywordflow">return</span> timeStr.substr(0, 24);
<a name="l00245"></a>00245   }
<a name="l00246"></a>00246 
<a name="l00253"></a><a class="code" href="classCMAES.html#a77ac5ff94fbff0bed5ce9e8d83f890ee">00253</a>   <span class="keywordtype">void</span> <a class="code" href="classCMAES.html#a77ac5ff94fbff0bed5ce9e8d83f890ee" title="Calculating eigenvalues and vectors.">eigen</a>(T* diag, T** Q, T* rgtmp)
<a name="l00254"></a>00254   {
<a name="l00255"></a>00255     assert(rgtmp &amp;&amp; <span class="stringliteral">&quot;eigen(): input parameter rgtmp must be non-NULL&quot;</span>);
<a name="l00256"></a>00256 
<a name="l00257"></a>00257     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a> != Q) <span class="comment">// copy C to Q</span>
<a name="l00258"></a>00258     {
<a name="l00259"></a>00259       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00260"></a>00260         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)
<a name="l00261"></a>00261           Q[i][j] = Q[j][i] = <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i][j];
<a name="l00262"></a>00262     }
<a name="l00263"></a>00263 
<a name="l00264"></a>00264     <a class="code" href="classCMAES.html#ae861a4dac0f11adfdc0096cfbcdcbd07" title="Householder transformation of a symmetric matrix V into tridiagonal form.">householder</a>(Q, diag, rgtmp);
<a name="l00265"></a>00265     <a class="code" href="classCMAES.html#a6bb335a1116845d5ef1bb11fc3ac5cd1" title="Symmetric tridiagonal QL algorithm, iterative.">ql</a>(diag, rgtmp, Q);
<a name="l00266"></a>00266   }
<a name="l00267"></a>00267 
<a name="l00273"></a><a class="code" href="classCMAES.html#a770b17733d7d66fae4654823736d9c26">00273</a>   <span class="keywordtype">int</span> <a class="code" href="classCMAES.html#a770b17733d7d66fae4654823736d9c26" title="Exhaustive test of the output of the eigendecomposition, needs O(n^3) operations writes to error file...">checkEigen</a>(T* diag, T** Q)
<a name="l00274"></a>00274   {
<a name="l00275"></a>00275     <span class="comment">// compute Q diag Q^T and Q Q^T to check</span>
<a name="l00276"></a>00276     <span class="keywordtype">int</span> res = 0;
<a name="l00277"></a>00277     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00278"></a>00278       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++j) {
<a name="l00279"></a>00279         T cc = 0., dd = 0.;
<a name="l00280"></a>00280         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++k)
<a name="l00281"></a>00281         {
<a name="l00282"></a>00282           cc += diag[k]*Q[i][k]*Q[j][k];
<a name="l00283"></a>00283           dd += Q[i][k]*Q[j][k];
<a name="l00284"></a>00284         }
<a name="l00285"></a>00285         <span class="comment">// check here, is the normalization the right one?</span>
<a name="l00286"></a>00286         <span class="keyword">const</span> <span class="keywordtype">bool</span> cond1 = fabs(cc - <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i &gt; j ? i : j][i &gt; j ? j : i]) / sqrt(<a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i][i]* <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[j][j]) &gt; T(1e-10);
<a name="l00287"></a>00287         <span class="keyword">const</span> <span class="keywordtype">bool</span> cond2 = fabs(cc - <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i &gt; j ? i : j][i &gt; j ? j : i]) &gt; T(3e-14);
<a name="l00288"></a>00288         <span class="keywordflow">if</span>(cond1 &amp;&amp; cond2)
<a name="l00289"></a>00289         {
<a name="l00290"></a>00290           std::stringstream s;
<a name="l00291"></a>00291           s &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; cc &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i &gt; j ? i : j][i &gt; j ? j : i]
<a name="l00292"></a>00292               &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; cc - <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i &gt; j ? i : j][i &gt; j ? j : i];
<a name="l00293"></a>00293           assert(<span class="keyword">false</span> &amp;&amp; (<span class="stringliteral">&quot;eigen(): imprecise result detected &quot;</span> + s.str()).c_str());
<a name="l00294"></a>00294           ++res;
<a name="l00295"></a>00295         }
<a name="l00296"></a>00296         <span class="keywordflow">if</span>(std::fabs(dd - (i == j)) &gt; T(1e-10))
<a name="l00297"></a>00297         {
<a name="l00298"></a>00298           std::stringstream s;
<a name="l00299"></a>00299           s &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; dd;
<a name="l00300"></a>00300           assert(<span class="keyword">false</span> &amp;&amp; (<span class="stringliteral">&quot;eigen(): imprecise result detected (Q not orthog.)&quot;</span> + s.str()).c_str());
<a name="l00301"></a>00301           ++res;
<a name="l00302"></a>00302         }
<a name="l00303"></a>00303       }
<a name="l00304"></a>00304     <span class="keywordflow">return</span> res;
<a name="l00305"></a>00305   }
<a name="l00306"></a>00306 
<a name="l00316"></a><a class="code" href="classCMAES.html#a6bb335a1116845d5ef1bb11fc3ac5cd1">00316</a>   <span class="keywordtype">void</span> <a class="code" href="classCMAES.html#a6bb335a1116845d5ef1bb11fc3ac5cd1" title="Symmetric tridiagonal QL algorithm, iterative.">ql</a>(T* d, T* e, T** V)
<a name="l00317"></a>00317   {
<a name="l00318"></a>00318     <span class="keyword">const</span> <span class="keywordtype">int</span> n = <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N;
<a name="l00319"></a>00319     T f(0);
<a name="l00320"></a>00320     T tst1(0);
<a name="l00321"></a>00321     <span class="keyword">const</span> T eps(2.22e-16); <span class="comment">// 2.0^-52.0 = 2.22e-16</span>
<a name="l00322"></a>00322 
<a name="l00323"></a>00323     <span class="comment">// shift input e</span>
<a name="l00324"></a>00324     T* ep1 = e;
<a name="l00325"></a>00325     <span class="keywordflow">for</span>(T *ep2 = e+1, *<span class="keyword">const</span> end = e+n; ep2 != end; ep1++, ep2++)
<a name="l00326"></a>00326       *ep1 = *ep2;
<a name="l00327"></a>00327     *ep1 = T(0); <span class="comment">// never changed again</span>
<a name="l00328"></a>00328 
<a name="l00329"></a>00329     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> l = 0; l &lt; n; l++)
<a name="l00330"></a>00330     {
<a name="l00331"></a>00331       <span class="comment">// find small subdiagonal element</span>
<a name="l00332"></a>00332       T&amp; el = e[l];
<a name="l00333"></a>00333       T&amp; dl = d[l];
<a name="l00334"></a>00334       <span class="keyword">const</span> T smallSDElement = std::fabs(dl) + std::fabs(el);
<a name="l00335"></a>00335       <span class="keywordflow">if</span>(tst1 &lt; smallSDElement)
<a name="l00336"></a>00336         tst1 = smallSDElement;
<a name="l00337"></a>00337       <span class="keyword">const</span> T epsTst1 = eps*tst1;
<a name="l00338"></a>00338       <span class="keywordtype">int</span> m = l;
<a name="l00339"></a>00339       <span class="keywordflow">while</span>(m &lt; n)
<a name="l00340"></a>00340       {
<a name="l00341"></a>00341         <span class="keywordflow">if</span>(std::fabs(e[m]) &lt;= epsTst1) <span class="keywordflow">break</span>;
<a name="l00342"></a>00342         m++;
<a name="l00343"></a>00343       }
<a name="l00344"></a>00344 
<a name="l00345"></a>00345       <span class="comment">// if m == l, d[l] is an eigenvalue, otherwise, iterate.</span>
<a name="l00346"></a>00346       <span class="keywordflow">if</span>(m &gt; l)
<a name="l00347"></a>00347       {
<a name="l00348"></a>00348         <span class="keywordflow">do</span> {
<a name="l00349"></a>00349           T h, g = dl;
<a name="l00350"></a>00350           T&amp; dl1r = d[l+1];
<a name="l00351"></a>00351           T p = (dl1r - g) / (T(2)*el);
<a name="l00352"></a>00352           T r = <a class="code" href="utils_8h.html#a3771e75fa9efbea03b99fe1ae4853072" title="sqrt(a^2 + b^2) numerically stable.">myhypot</a>(p, T(1));
<a name="l00353"></a>00353 
<a name="l00354"></a>00354           <span class="comment">// compute implicit shift</span>
<a name="l00355"></a>00355           <span class="keywordflow">if</span>(p &lt; 0) r = -r;
<a name="l00356"></a>00356           <span class="keyword">const</span> T pr = p+r;
<a name="l00357"></a>00357           dl = el/pr;
<a name="l00358"></a>00358           h = g - dl;
<a name="l00359"></a>00359           <span class="keyword">const</span> T dl1 = el*pr;
<a name="l00360"></a>00360           dl1r = dl1;
<a name="l00361"></a>00361           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = l+2; i &lt; n; i++) d[i] -= h;
<a name="l00362"></a>00362           f += h;
<a name="l00363"></a>00363 
<a name="l00364"></a>00364           <span class="comment">// implicit QL transformation.</span>
<a name="l00365"></a>00365           p = d[m];
<a name="l00366"></a>00366           T c(1);
<a name="l00367"></a>00367           T c2(1);
<a name="l00368"></a>00368           T c3(1);
<a name="l00369"></a>00369           <span class="keyword">const</span> T el1 = e[l+1];
<a name="l00370"></a>00370           T s(0);
<a name="l00371"></a>00371           T s2(0);
<a name="l00372"></a>00372           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = m-1; i &gt;= l; i--)
<a name="l00373"></a>00373           {
<a name="l00374"></a>00374             c3 = c2;
<a name="l00375"></a>00375             c2 = c;
<a name="l00376"></a>00376             s2 = s;
<a name="l00377"></a>00377             <span class="keyword">const</span> T&amp; ei = e[i];
<a name="l00378"></a>00378             g = c*ei;
<a name="l00379"></a>00379             h = c*p;
<a name="l00380"></a>00380             r = <a class="code" href="utils_8h.html#a3771e75fa9efbea03b99fe1ae4853072" title="sqrt(a^2 + b^2) numerically stable.">myhypot</a>(p, ei);
<a name="l00381"></a>00381             e[i+1] = s*r;
<a name="l00382"></a>00382             s = ei/r;
<a name="l00383"></a>00383             c = p/r;
<a name="l00384"></a>00384             <span class="keyword">const</span> T&amp; di = d[i];
<a name="l00385"></a>00385             p = c*di - s*g;
<a name="l00386"></a>00386             d[i+1] = h + s*(c*g + s*di);
<a name="l00387"></a>00387 
<a name="l00388"></a>00388             <span class="comment">// accumulate transformation.</span>
<a name="l00389"></a>00389             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; n; k++)
<a name="l00390"></a>00390             {
<a name="l00391"></a>00391               T&amp; Vki1 = V[k][i+1];
<a name="l00392"></a>00392               h = Vki1;
<a name="l00393"></a>00393               T&amp; Vki = V[k][i];
<a name="l00394"></a>00394               Vki1 = s*Vki + c*h;
<a name="l00395"></a>00395               Vki *= c; Vki -= s*h;
<a name="l00396"></a>00396             }
<a name="l00397"></a>00397           }
<a name="l00398"></a>00398           p = -s*s2*c3*el1*el/dl1;
<a name="l00399"></a>00399           el = s*p;
<a name="l00400"></a>00400           dl = c*p;
<a name="l00401"></a>00401         } <span class="keywordflow">while</span>(std::fabs(el) &gt; epsTst1);
<a name="l00402"></a>00402       }
<a name="l00403"></a>00403       dl += f;
<a name="l00404"></a>00404       el = 0.0;
<a name="l00405"></a>00405     }
<a name="l00406"></a>00406   }
<a name="l00407"></a>00407 
<a name="l00416"></a><a class="code" href="classCMAES.html#ae861a4dac0f11adfdc0096cfbcdcbd07">00416</a>   <span class="keywordtype">void</span> <a class="code" href="classCMAES.html#ae861a4dac0f11adfdc0096cfbcdcbd07" title="Householder transformation of a symmetric matrix V into tridiagonal form.">householder</a>(T** V, T* d, T* e)
<a name="l00417"></a>00417   {
<a name="l00418"></a>00418     <span class="keyword">const</span> <span class="keywordtype">int</span> n = <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N;
<a name="l00419"></a>00419 
<a name="l00420"></a>00420     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; n; j++)
<a name="l00421"></a>00421     {
<a name="l00422"></a>00422       d[j] = V[n - 1][j];
<a name="l00423"></a>00423     }
<a name="l00424"></a>00424 
<a name="l00425"></a>00425     <span class="comment">// Householder reduction to tridiagonal form</span>
<a name="l00426"></a>00426 
<a name="l00427"></a>00427     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = n - 1; i &gt; 0; i--)
<a name="l00428"></a>00428     {
<a name="l00429"></a>00429       <span class="comment">// scale to avoid under/overflow</span>
<a name="l00430"></a>00430       T scale = 0.0;
<a name="l00431"></a>00431       T h = 0.0;
<a name="l00432"></a>00432       <span class="keywordflow">for</span>(T *pd = d, *<span class="keyword">const</span> dend = d+i; pd != dend; pd++)
<a name="l00433"></a>00433       {
<a name="l00434"></a>00434         scale += std::fabs(*pd);
<a name="l00435"></a>00435       }
<a name="l00436"></a>00436       <span class="keywordflow">if</span>(scale == 0.0)
<a name="l00437"></a>00437       {
<a name="l00438"></a>00438         e[i] = d[i-1];
<a name="l00439"></a>00439         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; i; j++)
<a name="l00440"></a>00440         {
<a name="l00441"></a>00441           d[j] = V[i-1][j];
<a name="l00442"></a>00442           V[i][j] = 0.0;
<a name="l00443"></a>00443           V[j][i] = 0.0;
<a name="l00444"></a>00444         }
<a name="l00445"></a>00445       }
<a name="l00446"></a>00446       <span class="keywordflow">else</span>
<a name="l00447"></a>00447       {
<a name="l00448"></a>00448         <span class="comment">// generate Householder vector</span>
<a name="l00449"></a>00449         <span class="keywordflow">for</span>(T *pd = d, *<span class="keyword">const</span> dend = d+i; pd != dend; pd++)
<a name="l00450"></a>00450         {
<a name="l00451"></a>00451           *pd /= scale;
<a name="l00452"></a>00452           h += *pd * *pd;
<a name="l00453"></a>00453         }
<a name="l00454"></a>00454         T&amp; dim1 = d[i-1];
<a name="l00455"></a>00455         T f = dim1;
<a name="l00456"></a>00456         T g = f &gt; 0 ? -std::sqrt(h) : std::sqrt(h);
<a name="l00457"></a>00457         e[i] = scale*g;
<a name="l00458"></a>00458         h = h - f* g;
<a name="l00459"></a>00459         dim1 = f - g;
<a name="l00460"></a>00460         memset((<span class="keywordtype">void</span> *) e, 0, (<span class="keywordtype">size_t</span>)i*<span class="keyword">sizeof</span>(T));
<a name="l00461"></a>00461 
<a name="l00462"></a>00462         <span class="comment">// apply similarity transformation to remaining columns</span>
<a name="l00463"></a>00463         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; i; j++)
<a name="l00464"></a>00464         {
<a name="l00465"></a>00465           f = d[j];
<a name="l00466"></a>00466           V[j][i] = f;
<a name="l00467"></a>00467           T&amp; ej = e[j];
<a name="l00468"></a>00468           g = ej + V[j][j]* f;
<a name="l00469"></a>00469           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = j + 1; k &lt;= i - 1; k++)
<a name="l00470"></a>00470           {
<a name="l00471"></a>00471             T&amp; Vkj = V[k][j];
<a name="l00472"></a>00472             g += Vkj*d[k];
<a name="l00473"></a>00473             e[k] += Vkj*f;
<a name="l00474"></a>00474           }
<a name="l00475"></a>00475           ej = g;
<a name="l00476"></a>00476         }
<a name="l00477"></a>00477         f = 0.0;
<a name="l00478"></a>00478         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; i; j++)
<a name="l00479"></a>00479         {
<a name="l00480"></a>00480           T&amp; ej = e[j];
<a name="l00481"></a>00481           ej /= h;
<a name="l00482"></a>00482           f += ej* d[j];
<a name="l00483"></a>00483         }
<a name="l00484"></a>00484         T hh = f / (h + h);
<a name="l00485"></a>00485         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; i; j++)
<a name="l00486"></a>00486         {
<a name="l00487"></a>00487           e[j] -= hh*d[j];
<a name="l00488"></a>00488         }
<a name="l00489"></a>00489         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; i; j++)
<a name="l00490"></a>00490         {
<a name="l00491"></a>00491           T&amp; dj = d[j];
<a name="l00492"></a>00492           f = dj;
<a name="l00493"></a>00493           g = e[j];
<a name="l00494"></a>00494           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = j; k &lt;= i - 1; k++)
<a name="l00495"></a>00495           {
<a name="l00496"></a>00496             V[k][j] -= f*e[k] + g*d[k];
<a name="l00497"></a>00497           }
<a name="l00498"></a>00498           dj = V[i-1][j];
<a name="l00499"></a>00499           V[i][j] = 0.0;
<a name="l00500"></a>00500         }
<a name="l00501"></a>00501       }
<a name="l00502"></a>00502       d[i] = h;
<a name="l00503"></a>00503     }
<a name="l00504"></a>00504 
<a name="l00505"></a>00505     <span class="comment">// accumulate transformations</span>
<a name="l00506"></a>00506     <span class="keyword">const</span> <span class="keywordtype">int</span> nm1 = n-1;
<a name="l00507"></a>00507     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; nm1; i++)
<a name="l00508"></a>00508     {
<a name="l00509"></a>00509       T h;
<a name="l00510"></a>00510       T&amp; Vii = V[i][i];
<a name="l00511"></a>00511       V[n-1][i] = Vii;
<a name="l00512"></a>00512       Vii = 1.0;
<a name="l00513"></a>00513       h = d[i+1];
<a name="l00514"></a>00514       <span class="keywordflow">if</span>(h != 0.0)
<a name="l00515"></a>00515       {
<a name="l00516"></a>00516         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt;= i; k++)
<a name="l00517"></a>00517         {
<a name="l00518"></a>00518           d[k] = V[k][i+1] / h;
<a name="l00519"></a>00519         }
<a name="l00520"></a>00520         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt;= i; j++) {
<a name="l00521"></a>00521           T g = 0.0;
<a name="l00522"></a>00522           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt;= i; k++)
<a name="l00523"></a>00523           {
<a name="l00524"></a>00524             T* Vk = V[k];
<a name="l00525"></a>00525             g += Vk[i+1]* Vk[j];
<a name="l00526"></a>00526           }
<a name="l00527"></a>00527           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt;= i; k++)
<a name="l00528"></a>00528           {
<a name="l00529"></a>00529             V[k][j] -= g*d[k];
<a name="l00530"></a>00530           }
<a name="l00531"></a>00531         }
<a name="l00532"></a>00532       }
<a name="l00533"></a>00533       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt;= i; k++)
<a name="l00534"></a>00534       {
<a name="l00535"></a>00535         V[k][i+1] = 0.0;
<a name="l00536"></a>00536       }
<a name="l00537"></a>00537     }
<a name="l00538"></a>00538     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; n; j++)
<a name="l00539"></a>00539     {
<a name="l00540"></a>00540       T&amp; Vnm1j = V[n-1][j];
<a name="l00541"></a>00541       d[j] = Vnm1j;
<a name="l00542"></a>00542       Vnm1j = 0.0;
<a name="l00543"></a>00543     }
<a name="l00544"></a>00544     V[n-1][n-1] = 1.0;
<a name="l00545"></a>00545     e[0] = 0.0;
<a name="l00546"></a>00546   }
<a name="l00547"></a>00547 
<a name="l00551"></a><a class="code" href="classCMAES.html#a6ec64a4e6821b8d568a18acd524a7611">00551</a>   <span class="keywordtype">void</span> <a class="code" href="classCMAES.html#a6ec64a4e6821b8d568a18acd524a7611" title="Dirty index sort.">sortIndex</a>(<span class="keyword">const</span> T* rgFunVal, <span class="keywordtype">int</span>* iindex, <span class="keywordtype">int</span> n)
<a name="l00552"></a>00552   {
<a name="l00553"></a>00553     <span class="keywordtype">int</span> i, j;
<a name="l00554"></a>00554     <span class="keywordflow">for</span>(i = 1, iindex[0] = 0; i &lt; n; ++i)
<a name="l00555"></a>00555     {
<a name="l00556"></a>00556       <span class="keywordflow">for</span>(j = i; j &gt; 0; --j)
<a name="l00557"></a>00557       {
<a name="l00558"></a>00558         <span class="keywordflow">if</span>(rgFunVal[iindex[j - 1]] &lt; rgFunVal[i])
<a name="l00559"></a>00559           <span class="keywordflow">break</span>;
<a name="l00560"></a>00560         iindex[j] = iindex[j - 1]; <span class="comment">// shift up</span>
<a name="l00561"></a>00561       }
<a name="l00562"></a>00562       iindex[j] = i;
<a name="l00563"></a>00563     }
<a name="l00564"></a>00564   }
<a name="l00565"></a>00565 
<a name="l00566"></a><a class="code" href="classCMAES.html#a2865ab646d4cbab7fa8e9c965b3d2b84">00566</a>   <span class="keywordtype">void</span> <a class="code" href="classCMAES.html#a2865ab646d4cbab7fa8e9c965b3d2b84">adaptC2</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> hsig)
<a name="l00567"></a>00567   {
<a name="l00568"></a>00568     <span class="keyword">const</span> <span class="keywordtype">int</span> N = <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N;
<a name="l00569"></a>00569     <span class="keywordtype">bool</span> diag = <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.diagonalCov == 1 || <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.diagonalCov &gt;= <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a>;
<a name="l00570"></a>00570 
<a name="l00571"></a>00571     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.ccov != T(0))
<a name="l00572"></a>00572     {
<a name="l00573"></a>00573       <span class="comment">// definitions for speeding up inner-most loop</span>
<a name="l00574"></a>00574       <span class="keyword">const</span> T mucovinv = T(1)/<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.mucov;
<a name="l00575"></a>00575       <span class="keyword">const</span> T commonFactor = <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.ccov * (diag ? (N + T(1.5)) / T(3) : T(1));
<a name="l00576"></a>00576       <span class="keyword">const</span> T ccov1 = std::min(commonFactor*mucovinv, T(1));
<a name="l00577"></a>00577       <span class="keyword">const</span> T ccovmu = std::min(commonFactor*(T(1)-mucovinv), T(1)-ccov1);
<a name="l00578"></a>00578       <span class="keyword">const</span> T sigmasquare = <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>*<a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>;
<a name="l00579"></a>00579       <span class="keyword">const</span> T onemccov1ccovmu = T(1)-ccov1-ccovmu;
<a name="l00580"></a>00580       <span class="keyword">const</span> T longFactor = (T(1)-hsig)*<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.ccumcov*(T(2)-<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.ccumcov);
<a name="l00581"></a>00581 
<a name="l00582"></a>00582       <a class="code" href="classCMAES.html#ade7b4d250edba249dfcfdc2e2396246e">eigensysIsUptodate</a> = <span class="keyword">false</span>;
<a name="l00583"></a>00583 
<a name="l00584"></a>00584       <span class="comment">// update covariance matrix</span>
<a name="l00585"></a>00585       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; N; ++i)
<a name="l00586"></a>00586         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = diag ? i : 0; j &lt;= i; ++j)
<a name="l00587"></a>00587         {
<a name="l00588"></a>00588           T&amp; Cij = <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i][j];
<a name="l00589"></a>00589           Cij = onemccov1ccovmu*Cij + ccov1 * (<a class="code" href="classCMAES.html#a959adefafdb32f8e1f56a478c28cc2b7" title="anisotropic evolution path (for covariance)">rgpc</a>[i]*<a class="code" href="classCMAES.html#a959adefafdb32f8e1f56a478c28cc2b7" title="anisotropic evolution path (for covariance)">rgpc</a>[j] + longFactor*Cij);
<a name="l00590"></a>00590           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.mu; ++k)
<a name="l00591"></a>00591           { <span class="comment">// additional rank mu update</span>
<a name="l00592"></a>00592             <span class="keyword">const</span> T* rgrgxindexk = <a class="code" href="classCMAES.html#ae85f01391da333e830437e46671b5b4d" title="x-vectors, lambda offspring">rgrgx</a>[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="sorting index of sample pop.">index</a>[k]];
<a name="l00593"></a>00593             Cij += ccovmu*<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.weights[k] * (rgrgxindexk[i] - <a class="code" href="classCMAES.html#a09e7f98cfed00b8847c411faaa28a935">rgxold</a>[i])
<a name="l00594"></a>00594                 * (rgrgxindexk[j] - <a class="code" href="classCMAES.html#a09e7f98cfed00b8847c411faaa28a935">rgxold</a>[j]) / sigmasquare;
<a name="l00595"></a>00595           }
<a name="l00596"></a>00596         }
<a name="l00597"></a>00597       <span class="comment">// update maximal and minimal diagonal value</span>
<a name="l00598"></a>00598       <a class="code" href="classCMAES.html#a93eee1dc0a955f05fcabb5db15b64886" title="repeatedly used for output">maxdiagC</a> = <a class="code" href="classCMAES.html#a0fc9beb46f3685e1f49f2575de3ce026">mindiagC</a> = <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[0][0];
<a name="l00599"></a>00599       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1; i &lt; N; ++i)
<a name="l00600"></a>00600       {
<a name="l00601"></a>00601         <span class="keyword">const</span> T&amp; Cii = <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i][i];
<a name="l00602"></a>00602         <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a93eee1dc0a955f05fcabb5db15b64886" title="repeatedly used for output">maxdiagC</a> &lt; Cii)
<a name="l00603"></a>00603           <a class="code" href="classCMAES.html#a93eee1dc0a955f05fcabb5db15b64886" title="repeatedly used for output">maxdiagC</a> = Cii;
<a name="l00604"></a>00604         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a0fc9beb46f3685e1f49f2575de3ce026">mindiagC</a> &gt; Cii)
<a name="l00605"></a>00605           <a class="code" href="classCMAES.html#a0fc9beb46f3685e1f49f2575de3ce026">mindiagC</a> = Cii;
<a name="l00606"></a>00606       }
<a name="l00607"></a>00607     }
<a name="l00608"></a>00608   }
<a name="l00609"></a>00609 
<a name="l00613"></a><a class="code" href="classCMAES.html#a0acb1ad8ffd57032a1be02654a9d0d4a">00613</a>   <span class="keywordtype">void</span> <a class="code" href="classCMAES.html#a0acb1ad8ffd57032a1be02654a9d0d4a" title="Treats minimal standard deviations and numeric problems.">testMinStdDevs</a>(<span class="keywordtype">void</span>)
<a name="l00614"></a>00614   {
<a name="l00615"></a>00615     <span class="keywordflow">if</span>(!this-&gt;<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.rgDiffMinChange)
<a name="l00616"></a>00616       <span class="keywordflow">return</span>;
<a name="l00617"></a>00617 
<a name="l00618"></a>00618     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00619"></a>00619       <span class="keywordflow">while</span>(this-&gt;<a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>*std::sqrt(this-&gt;<a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i][i]) &lt; this-&gt;<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.rgDiffMinChange[i])
<a name="l00620"></a>00620         this-&gt;<a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a> *= std::exp(T(0.05) + this-&gt;<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.cs / this-&gt;sp.damps);
<a name="l00621"></a>00621   }
<a name="l00622"></a>00622 
<a name="l00628"></a><a class="code" href="classCMAES.html#af5d3c51b5b233cb684ba40bfa564fc98">00628</a>   <span class="keywordtype">void</span> <a class="code" href="classCMAES.html#af5d3c51b5b233cb684ba40bfa564fc98" title="Adds the mutation sigma*B*(D*z).">addMutation</a>(T* x, T eps = 1.0)
<a name="l00629"></a>00629   {
<a name="l00630"></a>00630     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00631"></a>00631       <a class="code" href="classCMAES.html#a75bd9d32b150084d1e6771c7806367b9" title="temporary (random) vector used in different places">rgdTmp</a>[i] = <a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>[i]*<a class="code" href="classCMAES.html#a73e60929e1e08ea6f9f4a5cec6f020b4" title="Random number generator.">rand</a>.gauss();
<a name="l00632"></a>00632     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00633"></a>00633     {
<a name="l00634"></a>00634       T sum = 0.0;
<a name="l00635"></a>00635       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++j)
<a name="l00636"></a>00636         sum += <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="matrix with normalize eigenvectors in columns">B</a>[i][j]*<a class="code" href="classCMAES.html#a75bd9d32b150084d1e6771c7806367b9" title="temporary (random) vector used in different places">rgdTmp</a>[j];
<a name="l00637"></a>00637       x[i] = <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="mean x vector, &amp;quot;parent&amp;quot;">xmean</a>[i] + eps*<a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>*sum;
<a name="l00638"></a>00638     }
<a name="l00639"></a>00639   }
<a name="l00640"></a>00640 
<a name="l00647"></a><a class="code" href="classCMAES.html#a886643be9124a2910aa765ad04e4ca84">00647</a>   <span class="keywordtype">void</span> <a class="code" href="classCMAES.html#a886643be9124a2910aa765ad04e4ca84" title="This hack reads key words from input key for data to be written to a file, see file signals...">writeToStream</a>(<span class="keywordtype">int</span> key, std::ostream&amp; file)
<a name="l00648"></a>00648   {
<a name="l00649"></a>00649     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5aa149aa30989f563b45db616cf69a375b">WKResume</a>)
<a name="l00650"></a>00650     {
<a name="l00651"></a>00651       file &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;# resume &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N &lt;&lt; std::endl;
<a name="l00652"></a>00652       file &lt;&lt; <span class="stringliteral">&quot;xmean&quot;</span> &lt;&lt; std::endl;
<a name="l00653"></a>00653       <a class="code" href="classCMAES.html#a886643be9124a2910aa765ad04e4ca84" title="This hack reads key words from input key for data to be written to a file, see file signals...">writeToStream</a>(<a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5ab430a1a4c4f6030e67f76d49dc1acd76">WKXMean</a>, file);
<a name="l00654"></a>00654       file &lt;&lt; <span class="stringliteral">&quot;path for sigma&quot;</span> &lt;&lt; std::endl;
<a name="l00655"></a>00655       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00656"></a>00656         file &lt;&lt; <a class="code" href="classCMAES.html#af032f05a04ebce55701225bccc9c60f7" title="isotropic evolution path (for step length)">rgps</a>[i] &lt;&lt; (i == <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N-1 ? <span class="stringliteral">&quot;\n&quot;</span> : <span class="stringliteral">&quot;\t&quot;</span>);
<a name="l00657"></a>00657       file &lt;&lt; <span class="stringliteral">&quot;path for C&quot;</span> &lt;&lt; std::endl;
<a name="l00658"></a>00658       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00659"></a>00659         file &lt;&lt; <a class="code" href="classCMAES.html#a959adefafdb32f8e1f56a478c28cc2b7" title="anisotropic evolution path (for covariance)">rgpc</a>[i] &lt;&lt; (i == <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N-1 ? <span class="stringliteral">&quot;\n&quot;</span> : <span class="stringliteral">&quot;\t&quot;</span>);
<a name="l00660"></a>00660       file &lt;&lt; <span class="stringliteral">&quot;sigma &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a> &lt;&lt; std::endl;
<a name="l00661"></a>00661       <span class="comment">// note than B and D might not be up-to-date</span>
<a name="l00662"></a>00662       file &lt;&lt; <span class="stringliteral">&quot;covariance matrix&quot;</span> &lt;&lt; std::endl;
<a name="l00663"></a>00663       <a class="code" href="classCMAES.html#a886643be9124a2910aa765ad04e4ca84" title="This hack reads key words from input key for data to be written to a file, see file signals...">writeToStream</a>(<a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a61d330c96de9b673a0076606bea2b59b">WKC</a>, file);
<a name="l00664"></a>00664     }
<a name="l00665"></a>00665     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5ab430a1a4c4f6030e67f76d49dc1acd76">WKXMean</a>)
<a name="l00666"></a>00666     {
<a name="l00667"></a>00667       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00668"></a>00668         file &lt;&lt; (i == 0 ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;\t&quot;</span>) &lt;&lt; <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="mean x vector, &amp;quot;parent&amp;quot;">xmean</a>[i];
<a name="l00669"></a>00669       file &lt;&lt; std::endl;
<a name="l00670"></a>00670     }
<a name="l00671"></a>00671     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a61d330c96de9b673a0076606bea2b59b">WKC</a>)
<a name="l00672"></a>00672     {
<a name="l00673"></a>00673       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00674"></a>00674         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)
<a name="l00675"></a>00675         {
<a name="l00676"></a>00676           file &lt;&lt; <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i][j];
<a name="l00677"></a>00677           <span class="keywordflow">if</span>(j == i)
<a name="l00678"></a>00678             file &lt;&lt; std::endl;
<a name="l00679"></a>00679           <span class="keywordflow">else</span>
<a name="l00680"></a>00680             file &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;
<a name="l00681"></a>00681         }
<a name="l00682"></a>00682       file &lt;&lt; std::endl;
<a name="l00683"></a>00683     }
<a name="l00684"></a>00684     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5abbf04a8ffe5c7bccecf352e294e9c099">WKAll</a>)
<a name="l00685"></a>00685     {
<a name="l00686"></a>00686       time_t ti = time(0);
<a name="l00687"></a>00687       file &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;# --------- &quot;</span> &lt;&lt; asctime(localtime(&amp;ti)) &lt;&lt; std::endl;
<a name="l00688"></a>00688       file &lt;&lt; <span class="stringliteral">&quot; N &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N &lt;&lt; std::endl;
<a name="l00689"></a>00689       file &lt;&lt; <span class="stringliteral">&quot;function evaluations &quot;</span> &lt;&lt; (long) <a class="code" href="classCMAES.html#a4e328b09739d2fb1a220a3d7cf4bc82c" title="objective function evaluations">countevals</a> &lt;&lt; std::endl;
<a name="l00690"></a>00690       file &lt;&lt; <span class="stringliteral">&quot;elapsed (CPU) time [s] &quot;</span> &lt;&lt; std::setprecision(2) &lt;&lt; <a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">eigenTimings</a>.<a class="code" href="classTiming.html#aaf5612cb0d03c6b03c904f574fdcc929" title="zeroed by re-calling timings_start">totaltotaltime</a> &lt;&lt; std::endl;
<a name="l00691"></a>00691       file &lt;&lt; <span class="stringliteral">&quot;function value f(x)=&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#ae85f01391da333e830437e46671b5b4d" title="x-vectors, lambda offspring">rgrgx</a>[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="sorting index of sample pop.">index</a>[0]][<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N] &lt;&lt; std::endl;
<a name="l00692"></a>00692       file &lt;&lt; <span class="stringliteral">&quot;maximal standard deviation &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#a93eee1dc0a955f05fcabb5db15b64886" title="repeatedly used for output">maxdiagC</a>) &lt;&lt; std::endl;
<a name="l00693"></a>00693       file &lt;&lt; <span class="stringliteral">&quot;minimal standard deviation &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#a0fc9beb46f3685e1f49f2575de3ce026">mindiagC</a>) &lt;&lt; std::endl;
<a name="l00694"></a>00694       file &lt;&lt; <span class="stringliteral">&quot;sigma &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a> &lt;&lt; std::endl;
<a name="l00695"></a>00695       file &lt;&lt; <span class="stringliteral">&quot;axisratio &quot;</span> &lt;&lt; (<a class="code" href="utils_8h.html#a607a38043b6aa6f8501b8bfca777536f">maxElement</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>, <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N) / <a class="code" href="utils_8h.html#a5ab74da4f5c22d49151fd4c7c9a41dee">minElement</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>, <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N)) &lt;&lt; std::endl;
<a name="l00696"></a>00696       file &lt;&lt; <span class="stringliteral">&quot;xbestever found after &quot;</span> &lt;&lt; std::setprecision(0) &lt;&lt; <a class="code" href="classCMAES.html#a33b5fc42be0304dc3ca66f3923d6d6ed" title="best sample ever">rgxbestever</a>[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N+1]
<a name="l00697"></a>00697           &lt;&lt; <span class="stringliteral">&quot;evaluations, function value &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a33b5fc42be0304dc3ca66f3923d6d6ed" title="best sample ever">rgxbestever</a>[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N] &lt;&lt; std::endl;
<a name="l00698"></a>00698       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00699"></a>00699         file &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::setw(12) &lt;&lt; <a class="code" href="classCMAES.html#a33b5fc42be0304dc3ca66f3923d6d6ed" title="best sample ever">rgxbestever</a>[i] &lt;&lt; (i % 5 == 4 || i == <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N-1 ? <span class="charliteral">&#39;\n&#39;</span> : <span class="charliteral">&#39; &#39;</span>);
<a name="l00700"></a>00700       file &lt;&lt; <span class="stringliteral">&quot;xbest (of last generation, function value &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#ae85f01391da333e830437e46671b5b4d" title="x-vectors, lambda offspring">rgrgx</a>[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="sorting index of sample pop.">index</a>[0]][<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N] &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;
<a name="l00701"></a>00701       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00702"></a>00702         file &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::setw(12) &lt;&lt; <a class="code" href="classCMAES.html#ae85f01391da333e830437e46671b5b4d" title="x-vectors, lambda offspring">rgrgx</a>[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="sorting index of sample pop.">index</a>[0]][i] &lt;&lt; (i % 5 == 4 || i == <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N-1 ? <span class="charliteral">&#39;\n&#39;</span> : <span class="charliteral">&#39; &#39;</span>);
<a name="l00703"></a>00703       file &lt;&lt; <span class="stringliteral">&quot;xmean&quot;</span> &lt;&lt; std::endl;
<a name="l00704"></a>00704       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00705"></a>00705         file &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::setw(12) &lt;&lt; <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="mean x vector, &amp;quot;parent&amp;quot;">xmean</a>[i] &lt;&lt; (i % 5 == 4 || i == <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N-1 ? <span class="charliteral">&#39;\n&#39;</span> : <span class="charliteral">&#39; &#39;</span>);
<a name="l00706"></a>00706       file &lt;&lt; <span class="stringliteral">&quot;Standard deviation of coordinate axes (sigma*sqrt(diag(C)))&quot;</span> &lt;&lt; std::endl;
<a name="l00707"></a>00707       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00708"></a>00708         file &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::setw(12) &lt;&lt; <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i][i]) &lt;&lt; (i % 5 == 4 || i == <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N-1 ? <span class="charliteral">&#39;\n&#39;</span> : <span class="charliteral">&#39; &#39;</span>);
<a name="l00709"></a>00709       file &lt;&lt; <span class="stringliteral">&quot;Main axis lengths of mutation ellipsoid (sigma*diag(D))&quot;</span> &lt;&lt; std::endl;
<a name="l00710"></a>00710       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00711"></a>00711           <a class="code" href="classCMAES.html#a75bd9d32b150084d1e6771c7806367b9" title="temporary (random) vector used in different places">rgdTmp</a>[i] = <a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>[i];
<a name="l00712"></a>00712       std::sort(<a class="code" href="classCMAES.html#a75bd9d32b150084d1e6771c7806367b9" title="temporary (random) vector used in different places">rgdTmp</a>, <a class="code" href="classCMAES.html#a75bd9d32b150084d1e6771c7806367b9" title="temporary (random) vector used in different places">rgdTmp</a> + <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N);
<a name="l00713"></a>00713       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00714"></a>00714         file &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::setw(12) &lt;&lt; <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>*<a class="code" href="classCMAES.html#a75bd9d32b150084d1e6771c7806367b9" title="temporary (random) vector used in different places">rgdTmp</a>[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N-1-i] &lt;&lt; (i % 5 == 4 || i == <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N-1 ? <span class="charliteral">&#39;\n&#39;</span> : <span class="charliteral">&#39; &#39;</span>);
<a name="l00715"></a>00715       file &lt;&lt; <span class="stringliteral">&quot;Longest axis (b_i where d_ii=max(diag(D))&quot;</span> &lt;&lt; std::endl;
<a name="l00716"></a>00716       <span class="keywordtype">int</span> k = <a class="code" href="utils_8h.html#add614d252f8c2ae3543a6771602d2d59">maxIndex</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>, <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N);
<a name="l00717"></a>00717       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00718"></a>00718         file &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::setw(12) &lt;&lt; <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="matrix with normalize eigenvectors in columns">B</a>[i][k] &lt;&lt; (i % 5 == 4 || i == <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N-1 ? <span class="charliteral">&#39;\n&#39;</span> : <span class="charliteral">&#39; &#39;</span>);
<a name="l00719"></a>00719       file &lt;&lt; <span class="stringliteral">&quot;Shortest axis (b_i where d_ii=max(diag(D))&quot;</span> &lt;&lt; std::endl;
<a name="l00720"></a>00720       k = <a class="code" href="utils_8h.html#a6613dfd27c8d1c4238f313b5b33da2a3">minIndex</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>, <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N);
<a name="l00721"></a>00721       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00722"></a>00722         file &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::setw(12) &lt;&lt; <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="matrix with normalize eigenvectors in columns">B</a>[i][k] &lt;&lt; (i % 5 == 4 || i == <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N-1 ? <span class="charliteral">&#39;\n&#39;</span> : <span class="charliteral">&#39; &#39;</span>);
<a name="l00723"></a>00723       file &lt;&lt; std::endl;
<a name="l00724"></a>00724     }
<a name="l00725"></a>00725     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a07d0282b9c7d9719df60fbc03f5a6eab">WKFewInfo</a>)
<a name="l00726"></a>00726     {
<a name="l00727"></a>00727       file &lt;&lt; <span class="stringliteral">&quot; Iter\tFevals\tFunction Value\tSigma\tMaxCoorDev\tMinCoorDev\t&quot;</span>
<a name="l00728"></a>00728           &lt;&lt; <span class="stringliteral">&quot;AxisRatio\tMinDii\tTime in eig&quot;</span> &lt;&lt; std::endl;
<a name="l00729"></a>00729       file &lt;&lt; std::endl;
<a name="l00730"></a>00730     }
<a name="l00731"></a>00731     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5ac8b7485532d066b19565db85e060aeac">WKFew</a>)
<a name="l00732"></a>00732     {
<a name="l00733"></a>00733       file &lt;&lt; (int) <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; (<span class="keywordtype">int</span>) <a class="code" href="classCMAES.html#a4e328b09739d2fb1a220a3d7cf4bc82c" title="objective function evaluations">countevals</a> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>
<a name="l00734"></a>00734           &lt;&lt; <a class="code" href="classCMAES.html#a3766a33cf5871b68715921aa5df60118">rgFuncValue</a>[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="sorting index of sample pop.">index</a>[0]] &lt;&lt; <span class="stringliteral">&quot;\t\t&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a> &lt;&lt; <span class="stringliteral">&quot;  &quot;</span>
<a name="l00735"></a>00735           &lt;&lt; <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#a93eee1dc0a955f05fcabb5db15b64886" title="repeatedly used for output">maxdiagC</a>) &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#a0fc9beb46f3685e1f49f2575de3ce026">mindiagC</a>)
<a name="l00736"></a>00736           &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; std::scientific &lt;&lt; std::setprecision(2)
<a name="l00737"></a>00737           &lt;&lt; std::sqrt(<a class="code" href="classCMAES.html#ae36bc85cdd41cb3db39b99a0303f6b6e">maxEW</a> / <a class="code" href="classCMAES.html#a9796be17293ba4549946392565368f41">minEW</a>) &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; std::sqrt(<a class="code" href="classCMAES.html#a9796be17293ba4549946392565368f41">minEW</a>)
<a name="l00738"></a>00738           &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">eigenTimings</a>.<a class="code" href="classTiming.html#aaf5612cb0d03c6b03c904f574fdcc929" title="zeroed by re-calling timings_start">totaltotaltime</a>;
<a name="l00739"></a>00739       file &lt;&lt; std::endl;
<a name="l00740"></a>00740     }
<a name="l00741"></a>00741     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a92d1998fb46900bceb39a60e3ed35746">WKEval</a>)
<a name="l00742"></a>00742     {
<a name="l00743"></a>00743       file &lt;&lt; <a class="code" href="classCMAES.html#a4e328b09739d2fb1a220a3d7cf4bc82c" title="objective function evaluations">countevals</a>;
<a name="l00744"></a>00744       file &lt;&lt; std::endl;
<a name="l00745"></a>00745     }
<a name="l00746"></a>00746     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a3bab88222e97d560b05cdcd7f5d967f0">WKFitness</a>)
<a name="l00747"></a>00747     {
<a name="l00748"></a>00748       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00749"></a>00749         file &lt;&lt; (i == 0 ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;\t&quot;</span>) &lt;&lt; <a class="code" href="classCMAES.html#a3766a33cf5871b68715921aa5df60118">rgFuncValue</a>[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="sorting index of sample pop.">index</a>[i]];
<a name="l00750"></a>00750       file &lt;&lt; std::endl;
<a name="l00751"></a>00751     }
<a name="l00752"></a>00752     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a689dedaccffee9f44f969a838f62b2a3">WKFBestEver</a>)
<a name="l00753"></a>00753     {
<a name="l00754"></a>00754       file &lt;&lt; <a class="code" href="classCMAES.html#a33b5fc42be0304dc3ca66f3923d6d6ed" title="best sample ever">rgxbestever</a>[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N] &lt;&lt; std::endl;
<a name="l00755"></a>00755     }
<a name="l00756"></a>00756     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5af74d31e6940d9c55b13935971bfd764d">WKCGeneration</a>)
<a name="l00757"></a>00757     {
<a name="l00758"></a>00758       file &lt;&lt; <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a> &lt;&lt; std::endl;
<a name="l00759"></a>00759     }
<a name="l00760"></a>00760     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a393a8956a826379f2918b1a0193ceead">WKSigma</a>)
<a name="l00761"></a>00761     {
<a name="l00762"></a>00762       file &lt;&lt; <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a> &lt;&lt; std::endl;
<a name="l00763"></a>00763     }
<a name="l00764"></a>00764     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5ab3b3919789e241ae3ae2c855d17c7528">WKLambda</a>)
<a name="l00765"></a>00765     {
<a name="l00766"></a>00766       file &lt;&lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.lambda &lt;&lt; std::endl;
<a name="l00767"></a>00767     }
<a name="l00768"></a>00768     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a407d38eb1d75495aa388416be4fb9673">WKB</a>)
<a name="l00769"></a>00769     {
<a name="l00770"></a>00770       <span class="keywordtype">int</span>* iindex = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N];
<a name="l00771"></a>00771       <a class="code" href="classCMAES.html#a6ec64a4e6821b8d568a18acd524a7611" title="Dirty index sort.">sortIndex</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>, iindex, <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N);
<a name="l00772"></a>00772       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00773"></a>00773         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++j)
<a name="l00774"></a>00774         {
<a name="l00775"></a>00775           file &lt;&lt; <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="matrix with normalize eigenvectors in columns">B</a>[j][iindex[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N-1-i]];
<a name="l00776"></a>00776           <span class="keywordflow">if</span>(j != <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N-1)
<a name="l00777"></a>00777             file &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;
<a name="l00778"></a>00778           <span class="keywordflow">else</span>
<a name="l00779"></a>00779             file &lt;&lt; std::endl;
<a name="l00780"></a>00780         }
<a name="l00781"></a>00781       <span class="keyword">delete</span>[] iindex;
<a name="l00782"></a>00782       iindex = 0;
<a name="l00783"></a>00783       file &lt;&lt; std::endl;
<a name="l00784"></a>00784     }
<a name="l00785"></a>00785     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a9b15493966d6f12f6e3135046cd6ae24">WKXBest</a>)
<a name="l00786"></a>00786     {
<a name="l00787"></a>00787       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00788"></a>00788         file &lt;&lt; (i == 0 ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;\t&quot;</span>) &lt;&lt; <a class="code" href="classCMAES.html#ae85f01391da333e830437e46671b5b4d" title="x-vectors, lambda offspring">rgrgx</a>[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="sorting index of sample pop.">index</a>[0]][i];
<a name="l00789"></a>00789       file &lt;&lt; std::endl;
<a name="l00790"></a>00790     }
<a name="l00791"></a>00791     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a939618e4c01b55a93ead6992a16e7d80">WKClock</a>)
<a name="l00792"></a>00792     {
<a name="l00793"></a>00793       <a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">eigenTimings</a>.<a class="code" href="classTiming.html#a9973978adb63702db5affd6f77b98fc5">update</a>();
<a name="l00794"></a>00794       file &lt;&lt; <a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">eigenTimings</a>.<a class="code" href="classTiming.html#aaf5612cb0d03c6b03c904f574fdcc929" title="zeroed by re-calling timings_start">totaltotaltime</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">eigenTimings</a>.<a class="code" href="classTiming.html#adfb11a76f87914807cdfe39bcef0a0af">tictoctime</a>
<a name="l00795"></a>00795           &lt;&lt; std::endl;
<a name="l00796"></a>00796     }
<a name="l00797"></a>00797     <span class="keywordflow">if</span>(key &amp; <a class="code" href="classCMAES.html#ae9f81c1f7041cad8e768ecd6d30aaed5a7213701c32edd96cbca9697368af03ae">WKDim</a>)
<a name="l00798"></a>00798     {
<a name="l00799"></a>00799       file &lt;&lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N;
<a name="l00800"></a>00800       file &lt;&lt; std::endl;
<a name="l00801"></a>00801     }
<a name="l00802"></a>00802   }
<a name="l00803"></a>00803 
<a name="l00804"></a>00804 <span class="keyword">public</span>:
<a name="l00805"></a>00805 
<a name="l00806"></a><a class="code" href="classCMAES.html#a4e328b09739d2fb1a220a3d7cf4bc82c">00806</a>   T <a class="code" href="classCMAES.html#a4e328b09739d2fb1a220a3d7cf4bc82c" title="objective function evaluations">countevals</a>; 
<a name="l00807"></a><a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">00807</a>   <a class="code" href="classTiming.html" title="A class for time measurements of the eigen decomposition.">Timing</a> <a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">eigenTimings</a>;
<a name="l00808"></a>00808 
<a name="l00813"></a><a class="code" href="classCMAES.html#a1dafd6714642367224020c2b8bd6573a">00813</a>   <a class="code" href="classCMAES.html#a1dafd6714642367224020c2b8bd6573a" title="Releases the dynamically allocated memory, including that of the return value of init().">~CMAES</a>()
<a name="l00814"></a>00814   {
<a name="l00815"></a>00815     <span class="keyword">delete</span>[] <a class="code" href="classCMAES.html#a959adefafdb32f8e1f56a478c28cc2b7" title="anisotropic evolution path (for covariance)">rgpc</a>;
<a name="l00816"></a>00816     <span class="keyword">delete</span>[] <a class="code" href="classCMAES.html#af032f05a04ebce55701225bccc9c60f7" title="isotropic evolution path (for step length)">rgps</a>;
<a name="l00817"></a>00817     <span class="keyword">delete</span>[] <a class="code" href="classCMAES.html#a75bd9d32b150084d1e6771c7806367b9" title="temporary (random) vector used in different places">rgdTmp</a>;
<a name="l00818"></a>00818     <span class="keyword">delete</span>[] <a class="code" href="classCMAES.html#af70aca7676a8a393591e3813dfd244c6" title="for B*D*z">rgBDz</a>;
<a name="l00819"></a>00819     <span class="keyword">delete</span>[] --<a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="mean x vector, &amp;quot;parent&amp;quot;">xmean</a>;
<a name="l00820"></a>00820     <span class="keyword">delete</span>[] --<a class="code" href="classCMAES.html#a09e7f98cfed00b8847c411faaa28a935">rgxold</a>;
<a name="l00821"></a>00821     <span class="keyword">delete</span>[] --<a class="code" href="classCMAES.html#a33b5fc42be0304dc3ca66f3923d6d6ed" title="best sample ever">rgxbestever</a>;
<a name="l00822"></a>00822     <span class="keyword">delete</span>[] --<a class="code" href="classCMAES.html#a0632e9bfd6e6f6db52df1e988b7d3758">rgout</a>;
<a name="l00823"></a>00823     <span class="keyword">delete</span>[] <a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>;
<a name="l00824"></a>00824     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00825"></a>00825     {
<a name="l00826"></a>00826       <span class="keyword">delete</span>[] <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i];
<a name="l00827"></a>00827       <span class="keyword">delete</span>[] <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="matrix with normalize eigenvectors in columns">B</a>[i];
<a name="l00828"></a>00828     }
<a name="l00829"></a>00829     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.lambda; ++i)
<a name="l00830"></a>00830       <span class="keyword">delete</span>[] --<a class="code" href="classCMAES.html#ae85f01391da333e830437e46671b5b4d" title="x-vectors, lambda offspring">rgrgx</a>[i];
<a name="l00831"></a>00831     <span class="keyword">delete</span>[] <a class="code" href="classCMAES.html#ae85f01391da333e830437e46671b5b4d" title="x-vectors, lambda offspring">rgrgx</a>;
<a name="l00832"></a>00832     <span class="keyword">delete</span>[] <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>;
<a name="l00833"></a>00833     <span class="keyword">delete</span>[] <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="matrix with normalize eigenvectors in columns">B</a>;
<a name="l00834"></a>00834     <span class="keyword">delete</span>[] <a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="sorting index of sample pop.">index</a>;
<a name="l00835"></a>00835     <span class="keyword">delete</span>[] <a class="code" href="classCMAES.html#a4ed94ed86d47a4903cb11eacd1f703e5" title="returned by init()">publicFitness</a>;
<a name="l00836"></a>00836     <span class="keyword">delete</span>[] --<a class="code" href="classCMAES.html#a3766a33cf5871b68715921aa5df60118">rgFuncValue</a>;
<a name="l00837"></a>00837     <span class="keyword">delete</span>[] --<a class="code" href="classCMAES.html#ad5c0bde5c3688de59e830e852ef17e44">arFuncValueHist</a>;
<a name="l00838"></a>00838   }
<a name="l00839"></a>00839 
<a name="l00847"></a><a class="code" href="classCMAES.html#ad9f4e1888c672a88821fef4de2d71193">00847</a>   T* <a class="code" href="classCMAES.html#ad9f4e1888c672a88821fef4de2d71193" title="Initializes the CMA-ES algorithm.">init</a>(<span class="keyword">const</span> <a class="code" href="classParameters.html" title="Holds all parameters that can be adjusted by the user.">Parameters&lt;T&gt;</a>&amp; parameters)
<a name="l00848"></a>00848   {
<a name="l00849"></a>00849     <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a> = parameters;
<a name="l00850"></a>00850 
<a name="l00851"></a>00851     <a class="code" href="classCMAES.html#a39f33a47d224feccbb0f31bc3b24f922" title="Implementation version.">version</a> = <span class="stringliteral">&quot;1.0alpha&quot;</span>;
<a name="l00852"></a>00852     <a class="code" href="classCMAES.html#a0146e5c3a576c5f04e33c0ec3978a2e8" title="A message that contains all matched stop criteria.">stopMessage</a> = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00853"></a>00853 
<a name="l00854"></a>00854     T trace(0);
<a name="l00855"></a>00855     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00856"></a>00856       trace += <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.rgInitialStds[i]*<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.rgInitialStds[i];
<a name="l00857"></a>00857     <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a> = std::sqrt(trace/<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N);
<a name="l00858"></a>00858 
<a name="l00859"></a>00859     <a class="code" href="classCMAES.html#af5aff4dfec9d1eabe488c5f03395158f">chiN</a> = std::sqrt((T) <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N) * (T(1) - T(1)/(T(4)*<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N) + T(1)/(T(21)*<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N*<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N));
<a name="l00860"></a>00860     <a class="code" href="classCMAES.html#ade7b4d250edba249dfcfdc2e2396246e">eigensysIsUptodate</a> = <span class="keyword">true</span>;
<a name="l00861"></a>00861     <a class="code" href="classCMAES.html#a09f393f2ef964f14f6b668bc91657650" title="control via signals.par">doCheckEigen</a> = <span class="keyword">false</span>;
<a name="l00862"></a>00862     <a class="code" href="classCMAES.html#a6f4acfc9073c8320c00bb0faa9efcdcb">genOfEigensysUpdate</a> = 0;
<a name="l00863"></a>00863     <a class="code" href="classCMAES.html#a5ef76c4c2d5833429dc868ed8d2c6709">isResumeDone</a> = <span class="keyword">false</span>;
<a name="l00864"></a>00864 
<a name="l00865"></a>00865     T dtest;
<a name="l00866"></a>00866     <span class="keywordflow">for</span>(dtest = T(1); dtest &amp;&amp; dtest &lt; T(1.1)*dtest; dtest *= T(2))
<a name="l00867"></a>00867       <span class="keywordflow">if</span>(dtest == dtest + T(1))
<a name="l00868"></a>00868         <span class="keywordflow">break</span>;
<a name="l00869"></a>00869     <a class="code" href="classCMAES.html#ae2163bc8eb11b8d28662ae985f51429b">dMaxSignifKond</a> = dtest / T(1000); <span class="comment">// not sure whether this is really save, 100 does not work well enough</span>
<a name="l00870"></a>00870 
<a name="l00871"></a>00871     <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a> = 0;
<a name="l00872"></a>00872     <a class="code" href="classCMAES.html#a4e328b09739d2fb1a220a3d7cf4bc82c" title="objective function evaluations">countevals</a> = 0;
<a name="l00873"></a>00873     <a class="code" href="classCMAES.html#a2259ba2fee168dac1aed9a5de7e9703e" title="algorithm state">state</a> = <a class="code" href="classCMAES.html#a0cef0210cdaaf09dd1d40daf33127765acdf19eb2e5b851d7af910fa38ac814e7">INITIALIZED</a>;
<a name="l00874"></a>00874     <a class="code" href="classCMAES.html#a89e9afdc9f28b153f6939039117080f1">dLastMinEWgroesserNull</a> = T(1);
<a name="l00875"></a>00875     <a class="code" href="classCMAES.html#a31915e1cc29d88faee41c1f45d3d5a2a">printtime</a> = <a class="code" href="classCMAES.html#a9f27aaa233806a6823b96d83059c68e1" title="ideally should keep track for each output file">writetime</a> = <a class="code" href="classCMAES.html#a72e456703b11bdcd7c273a2b764faf70">firstwritetime</a> = <a class="code" href="classCMAES.html#ae5b668b5b4bacd4048c6742650801356">firstprinttime</a> = 0;
<a name="l00876"></a>00876 
<a name="l00877"></a>00877     <a class="code" href="classCMAES.html#a959adefafdb32f8e1f56a478c28cc2b7" title="anisotropic evolution path (for covariance)">rgpc</a> = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N];
<a name="l00878"></a>00878     <a class="code" href="classCMAES.html#af032f05a04ebce55701225bccc9c60f7" title="isotropic evolution path (for step length)">rgps</a> = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N];
<a name="l00879"></a>00879     <a class="code" href="classCMAES.html#a75bd9d32b150084d1e6771c7806367b9" title="temporary (random) vector used in different places">rgdTmp</a> = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N+1];
<a name="l00880"></a>00880     <a class="code" href="classCMAES.html#af70aca7676a8a393591e3813dfd244c6" title="for B*D*z">rgBDz</a> = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N];
<a name="l00881"></a>00881     <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="mean x vector, &amp;quot;parent&amp;quot;">xmean</a> = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N+2];
<a name="l00882"></a>00882     <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="mean x vector, &amp;quot;parent&amp;quot;">xmean</a>[0] = <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N;
<a name="l00883"></a>00883     ++<a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="mean x vector, &amp;quot;parent&amp;quot;">xmean</a>;
<a name="l00884"></a>00884     <a class="code" href="classCMAES.html#a09e7f98cfed00b8847c411faaa28a935">rgxold</a> = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N+2];
<a name="l00885"></a>00885     <a class="code" href="classCMAES.html#a09e7f98cfed00b8847c411faaa28a935">rgxold</a>[0] = <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N;
<a name="l00886"></a>00886     ++<a class="code" href="classCMAES.html#a09e7f98cfed00b8847c411faaa28a935">rgxold</a>;
<a name="l00887"></a>00887     <a class="code" href="classCMAES.html#a33b5fc42be0304dc3ca66f3923d6d6ed" title="best sample ever">rgxbestever</a> = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N+3];
<a name="l00888"></a>00888     <a class="code" href="classCMAES.html#a33b5fc42be0304dc3ca66f3923d6d6ed" title="best sample ever">rgxbestever</a>[0] = <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N;
<a name="l00889"></a>00889     ++<a class="code" href="classCMAES.html#a33b5fc42be0304dc3ca66f3923d6d6ed" title="best sample ever">rgxbestever</a>;
<a name="l00890"></a>00890     <a class="code" href="classCMAES.html#a33b5fc42be0304dc3ca66f3923d6d6ed" title="best sample ever">rgxbestever</a>[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N] = std::numeric_limits&lt;T&gt;::max();
<a name="l00891"></a>00891     <a class="code" href="classCMAES.html#a0632e9bfd6e6f6db52df1e988b7d3758">rgout</a> = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N+2];
<a name="l00892"></a>00892     <a class="code" href="classCMAES.html#a0632e9bfd6e6f6db52df1e988b7d3758">rgout</a>[0] = <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N;
<a name="l00893"></a>00893     ++<a class="code" href="classCMAES.html#a0632e9bfd6e6f6db52df1e988b7d3758">rgout</a>;
<a name="l00894"></a>00894     <a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a> = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N];
<a name="l00895"></a>00895     <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a> = <span class="keyword">new</span> T*[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N];
<a name="l00896"></a>00896     <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="matrix with normalize eigenvectors in columns">B</a> = <span class="keyword">new</span> T*[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N];
<a name="l00897"></a>00897     <a class="code" href="classCMAES.html#a4ed94ed86d47a4903cb11eacd1f703e5" title="returned by init()">publicFitness</a> = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.lambda];
<a name="l00898"></a>00898     <a class="code" href="classCMAES.html#a3766a33cf5871b68715921aa5df60118">rgFuncValue</a> = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.lambda+1];
<a name="l00899"></a>00899     <a class="code" href="classCMAES.html#a3766a33cf5871b68715921aa5df60118">rgFuncValue</a>[0] = <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.lambda;
<a name="l00900"></a>00900     ++<a class="code" href="classCMAES.html#a3766a33cf5871b68715921aa5df60118">rgFuncValue</a>;
<a name="l00901"></a>00901     <span class="keyword">const</span> <span class="keywordtype">int</span> historySize = 10 + (int) ceil(3.*10.*<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N/<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.lambda);
<a name="l00902"></a>00902     <a class="code" href="classCMAES.html#ad5c0bde5c3688de59e830e852ef17e44">arFuncValueHist</a> = <span class="keyword">new</span> T[historySize + 1];
<a name="l00903"></a>00903     <a class="code" href="classCMAES.html#ad5c0bde5c3688de59e830e852ef17e44">arFuncValueHist</a>[0] = (T) historySize;
<a name="l00904"></a>00904     <a class="code" href="classCMAES.html#ad5c0bde5c3688de59e830e852ef17e44">arFuncValueHist</a>++;
<a name="l00905"></a>00905 
<a name="l00906"></a>00906     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00907"></a>00907     {
<a name="l00908"></a>00908       <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i] = <span class="keyword">new</span> T[i+1];
<a name="l00909"></a>00909       <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="matrix with normalize eigenvectors in columns">B</a>[i] = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N];
<a name="l00910"></a>00910     }
<a name="l00911"></a>00911     <a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="sorting index of sample pop.">index</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.lambda];
<a name="l00912"></a>00912     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.lambda; ++i)
<a name="l00913"></a>00913         <a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="sorting index of sample pop.">index</a>[i] = i;
<a name="l00914"></a>00914     <a class="code" href="classCMAES.html#ae85f01391da333e830437e46671b5b4d" title="x-vectors, lambda offspring">rgrgx</a> = <span class="keyword">new</span> T*[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.lambda];
<a name="l00915"></a>00915     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.lambda; ++i)
<a name="l00916"></a>00916     {
<a name="l00917"></a>00917       <a class="code" href="classCMAES.html#ae85f01391da333e830437e46671b5b4d" title="x-vectors, lambda offspring">rgrgx</a>[i] = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N+2];
<a name="l00918"></a>00918       <a class="code" href="classCMAES.html#ae85f01391da333e830437e46671b5b4d" title="x-vectors, lambda offspring">rgrgx</a>[i][0] = <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N;
<a name="l00919"></a>00919       <a class="code" href="classCMAES.html#ae85f01391da333e830437e46671b5b4d" title="x-vectors, lambda offspring">rgrgx</a>[i]++;
<a name="l00920"></a>00920       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; j++)
<a name="l00921"></a>00921         <a class="code" href="classCMAES.html#ae85f01391da333e830437e46671b5b4d" title="x-vectors, lambda offspring">rgrgx</a>[i][j] = 0.0;
<a name="l00922"></a>00922     }
<a name="l00923"></a>00923 
<a name="l00924"></a>00924     <span class="comment">// initialize newed space</span>
<a name="l00925"></a>00925     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.lambda; i++)
<a name="l00926"></a>00926     {
<a name="l00927"></a>00927       <a class="code" href="classCMAES.html#a3766a33cf5871b68715921aa5df60118">rgFuncValue</a>[i] = std::numeric_limits&lt;T&gt;::max();
<a name="l00928"></a>00928     }
<a name="l00929"></a>00929     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; historySize; i++)
<a name="l00930"></a>00930     {
<a name="l00931"></a>00931       <a class="code" href="classCMAES.html#ad5c0bde5c3688de59e830e852ef17e44">arFuncValueHist</a>[i] = std::numeric_limits&lt;T&gt;::max();
<a name="l00932"></a>00932     }
<a name="l00933"></a>00933     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00934"></a>00934       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; i; ++j)
<a name="l00935"></a>00935         <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i][j] = <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="matrix with normalize eigenvectors in columns">B</a>[i][j] = <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="matrix with normalize eigenvectors in columns">B</a>[j][i] = 0.;
<a name="l00936"></a>00936 
<a name="l00937"></a>00937     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00938"></a>00938     {
<a name="l00939"></a>00939       <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="matrix with normalize eigenvectors in columns">B</a>[i][i] = T(1);
<a name="l00940"></a>00940       <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i][i] = <a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>[i] = <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.rgInitialStds[i]*std::sqrt(<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N/trace);
<a name="l00941"></a>00941       <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i][i] *= <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i][i];
<a name="l00942"></a>00942       <a class="code" href="classCMAES.html#a959adefafdb32f8e1f56a478c28cc2b7" title="anisotropic evolution path (for covariance)">rgpc</a>[i] = <a class="code" href="classCMAES.html#af032f05a04ebce55701225bccc9c60f7" title="isotropic evolution path (for step length)">rgps</a>[i] = T(0);
<a name="l00943"></a>00943     }
<a name="l00944"></a>00944     <a class="code" href="classCMAES.html#a9796be17293ba4549946392565368f41">minEW</a> = <a class="code" href="utils_8h.html#a5ab74da4f5c22d49151fd4c7c9a41dee">minElement</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>, <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N);
<a name="l00945"></a>00945     <a class="code" href="classCMAES.html#a9796be17293ba4549946392565368f41">minEW</a> = <a class="code" href="classCMAES.html#a9796be17293ba4549946392565368f41">minEW</a>*<a class="code" href="classCMAES.html#a9796be17293ba4549946392565368f41">minEW</a>;
<a name="l00946"></a>00946     <a class="code" href="classCMAES.html#ae36bc85cdd41cb3db39b99a0303f6b6e">maxEW</a> = <a class="code" href="utils_8h.html#a607a38043b6aa6f8501b8bfca777536f">maxElement</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>, <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N);
<a name="l00947"></a>00947     <a class="code" href="classCMAES.html#ae36bc85cdd41cb3db39b99a0303f6b6e">maxEW</a> = <a class="code" href="classCMAES.html#ae36bc85cdd41cb3db39b99a0303f6b6e">maxEW</a>*<a class="code" href="classCMAES.html#ae36bc85cdd41cb3db39b99a0303f6b6e">maxEW</a>;
<a name="l00948"></a>00948 
<a name="l00949"></a>00949     <a class="code" href="classCMAES.html#a93eee1dc0a955f05fcabb5db15b64886" title="repeatedly used for output">maxdiagC</a> = <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[0][0];
<a name="l00950"></a>00950     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i) <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a93eee1dc0a955f05fcabb5db15b64886" title="repeatedly used for output">maxdiagC</a> &lt; <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i][i]) <a class="code" href="classCMAES.html#a93eee1dc0a955f05fcabb5db15b64886" title="repeatedly used for output">maxdiagC</a> = <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i][i];
<a name="l00951"></a>00951     <a class="code" href="classCMAES.html#a0fc9beb46f3685e1f49f2575de3ce026">mindiagC</a> = <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[0][0];
<a name="l00952"></a>00952     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i) <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a0fc9beb46f3685e1f49f2575de3ce026">mindiagC</a> &gt; <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i][i]) <a class="code" href="classCMAES.html#a0fc9beb46f3685e1f49f2575de3ce026">mindiagC</a> = <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i][i];
<a name="l00953"></a>00953 
<a name="l00954"></a>00954     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00955"></a>00955       <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="mean x vector, &amp;quot;parent&amp;quot;">xmean</a>[i] = <a class="code" href="classCMAES.html#a09e7f98cfed00b8847c411faaa28a935">rgxold</a>[i] = <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.xstart[i];
<a name="l00956"></a>00956     <span class="comment">// use in case xstart as typicalX</span>
<a name="l00957"></a>00957     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.typicalXcase)
<a name="l00958"></a>00958       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l00959"></a>00959         <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="mean x vector, &amp;quot;parent&amp;quot;">xmean</a>[i] += <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>*<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>[i]*<a class="code" href="classCMAES.html#a73e60929e1e08ea6f9f4a5cec6f020b4" title="Random number generator.">rand</a>.gauss();
<a name="l00960"></a>00960 
<a name="l00961"></a>00961     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.resumefile != <span class="stringliteral">&quot;&quot;</span>)
<a name="l00962"></a>00962       <a class="code" href="classCMAES.html#a6fb584672adf0a856b638cadbe2e3b84" title="Allows to restart with saved internal state (distribution) variables (use writeToFile() for saving)...">resumeDistribution</a>(<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.resumefile);
<a name="l00963"></a>00963 
<a name="l00964"></a>00964     <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a4ed94ed86d47a4903cb11eacd1f703e5" title="returned by init()">publicFitness</a>;
<a name="l00965"></a>00965   }
<a name="l00966"></a>00966 
<a name="l00971"></a><a class="code" href="classCMAES.html#a514dd76a8dd20a33a3c52f0cc6af74d2">00971</a>   std::string <a class="code" href="classCMAES.html#a514dd76a8dd20a33a3c52f0cc6af74d2" title="Well, says hello.">sayHello</a>()
<a name="l00972"></a>00972   {
<a name="l00973"></a>00973     std::stringstream stream;
<a name="l00974"></a>00974     stream &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.mu &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.lambda &lt;&lt; <span class="stringliteral">&quot;)-CMA-ES(mu_eff=&quot;</span>
<a name="l00975"></a>00975         &lt;&lt; std::setprecision(1) &lt;&lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.mueff &lt;&lt; <span class="stringliteral">&quot;), Ver=\&quot;&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a39f33a47d224feccbb0f31bc3b24f922" title="Implementation version.">version</a>
<a name="l00976"></a>00976         &lt;&lt; <span class="stringliteral">&quot;\&quot;, dimension=&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N &lt;&lt; <span class="stringliteral">&quot;, diagonalIterations=&quot;</span>
<a name="l00977"></a>00977         &lt;&lt; (long) <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.diagonalCov &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#aed17d3f1a936b1f640203d17f0422743">getTimeStr</a>() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;
<a name="l00978"></a>00978     <span class="keywordflow">return</span> stream.str();
<a name="l00979"></a>00979   }
<a name="l00980"></a>00980 
<a name="l00998"></a><a class="code" href="classCMAES.html#a6fb584672adf0a856b638cadbe2e3b84">00998</a>   <span class="keywordtype">void</span> <a class="code" href="classCMAES.html#a6fb584672adf0a856b638cadbe2e3b84" title="Allows to restart with saved internal state (distribution) variables (use writeToFile() for saving)...">resumeDistribution</a>(<span class="keyword">const</span> std::string&amp; filename)
<a name="l00999"></a>00999   {
<a name="l01000"></a>01000     std::ifstream file(filename.c_str());
<a name="l01001"></a>01001     <span class="keywordflow">if</span>(!file.is_open())
<a name="l01002"></a>01002       <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;resumeDistribution(): could not open &#39;&quot;</span> + filename + <span class="stringliteral">&quot;&#39;&quot;</span>);
<a name="l01003"></a>01003 
<a name="l01004"></a>01004     std::streampos lastResume = 0;
<a name="l01005"></a>01005     std::string entry = <span class="stringliteral">&quot;&quot;</span>;
<a name="l01006"></a>01006     <span class="keywordflow">while</span>(!file.eof())
<a name="l01007"></a>01007     {
<a name="l01008"></a>01008       file &gt;&gt; entry;
<a name="l01009"></a>01009       <span class="keywordflow">if</span>(entry == <span class="stringliteral">&quot;resume&quot;</span>)
<a name="l01010"></a>01010       {
<a name="l01011"></a>01011         lastResume = file.tellg();
<a name="l01012"></a>01012         <span class="keywordflow">break</span>;
<a name="l01013"></a>01013       }
<a name="l01014"></a>01014     }
<a name="l01015"></a>01015     file.clear();
<a name="l01016"></a>01016     file.seekg(lastResume);
<a name="l01017"></a>01017 
<a name="l01018"></a>01018     <span class="keywordtype">int</span> n = 0;
<a name="l01019"></a>01019     file &gt;&gt; n;
<a name="l01020"></a>01020     <span class="keywordflow">if</span>(n != <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N)
<a name="l01021"></a>01021       <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;resumeDistribution(): Dimension numbers do not match&quot;</span>);
<a name="l01022"></a>01022 
<a name="l01023"></a>01023     <span class="comment">// find next &quot;xmean&quot; entry</span>
<a name="l01024"></a>01024     <span class="keywordflow">while</span>(!file.eof())
<a name="l01025"></a>01025     {
<a name="l01026"></a>01026       file &gt;&gt; entry;
<a name="l01027"></a>01027       <span class="keywordflow">if</span>(entry == <span class="stringliteral">&quot;xmean&quot;</span>)
<a name="l01028"></a>01028         <span class="keywordflow">break</span>;
<a name="l01029"></a>01029     }
<a name="l01030"></a>01030     <span class="comment">// read xmean</span>
<a name="l01031"></a>01031     <span class="keywordflow">if</span>(file.eof())
<a name="l01032"></a>01032       <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;resumeDistribution(): &#39;xmean&#39; not found&quot;</span>);
<a name="l01033"></a>01033     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; n; i++)
<a name="l01034"></a>01034       file &gt;&gt; <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="mean x vector, &amp;quot;parent&amp;quot;">xmean</a>[i];
<a name="l01035"></a>01035     file.clear();
<a name="l01036"></a>01036     file.seekg(lastResume);
<a name="l01037"></a>01037 
<a name="l01038"></a>01038     <span class="comment">// find next &quot;path for sigma&quot; entry</span>
<a name="l01039"></a>01039     <span class="keywordflow">while</span>(!file.eof())
<a name="l01040"></a>01040     {
<a name="l01041"></a>01041       file &gt;&gt; entry;
<a name="l01042"></a>01042       <span class="keywordflow">if</span>(entry == <span class="stringliteral">&quot;path&quot;</span>)
<a name="l01043"></a>01043       {
<a name="l01044"></a>01044         std::string temp = <span class="stringliteral">&quot;&quot;</span>;
<a name="l01045"></a>01045         file &gt;&gt; temp;
<a name="l01046"></a>01046         entry += <span class="stringliteral">&quot; &quot;</span> + temp;
<a name="l01047"></a>01047         file &gt;&gt; temp;
<a name="l01048"></a>01048         entry += <span class="stringliteral">&quot; &quot;</span> + temp;
<a name="l01049"></a>01049         <span class="keywordflow">if</span>(entry == <span class="stringliteral">&quot;path for sigma&quot;</span>)
<a name="l01050"></a>01050           <span class="keywordflow">break</span>;
<a name="l01051"></a>01051       }
<a name="l01052"></a>01052     }
<a name="l01053"></a>01053     <span class="comment">// read ps</span>
<a name="l01054"></a>01054     <span class="keywordflow">if</span>(file.eof())
<a name="l01055"></a>01055       <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;resumeDistribution(): &#39;path for sigma&#39; not found&quot;</span>);
<a name="l01056"></a>01056     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; n; i++)
<a name="l01057"></a>01057       file &gt;&gt; <a class="code" href="classCMAES.html#af032f05a04ebce55701225bccc9c60f7" title="isotropic evolution path (for step length)">rgps</a>[i];
<a name="l01058"></a>01058     file.clear();
<a name="l01059"></a>01059     file.seekg(lastResume);
<a name="l01060"></a>01060 
<a name="l01061"></a>01061     <span class="comment">// find next &quot;path for C&quot; entry</span>
<a name="l01062"></a>01062     <span class="keywordflow">while</span>(!file.eof())
<a name="l01063"></a>01063     {
<a name="l01064"></a>01064       file &gt;&gt; entry;
<a name="l01065"></a>01065       <span class="keywordflow">if</span>(entry == <span class="stringliteral">&quot;path&quot;</span>)
<a name="l01066"></a>01066       {
<a name="l01067"></a>01067         std::string temp = <span class="stringliteral">&quot;&quot;</span>;
<a name="l01068"></a>01068         file &gt;&gt; temp;
<a name="l01069"></a>01069         entry += <span class="stringliteral">&quot; &quot;</span> + temp;
<a name="l01070"></a>01070         file &gt;&gt; temp;
<a name="l01071"></a>01071         entry += <span class="stringliteral">&quot; &quot;</span> + temp;
<a name="l01072"></a>01072         <span class="keywordflow">if</span>(entry == <span class="stringliteral">&quot;path for C&quot;</span>)
<a name="l01073"></a>01073           <span class="keywordflow">break</span>;
<a name="l01074"></a>01074       }
<a name="l01075"></a>01075     }
<a name="l01076"></a>01076     <span class="comment">// read pc</span>
<a name="l01077"></a>01077     <span class="keywordflow">if</span>(file.eof())
<a name="l01078"></a>01078       <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;resumeDistribution(): &#39;path for C&#39; not found&quot;</span>);
<a name="l01079"></a>01079     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; n; i++)
<a name="l01080"></a>01080       file &gt;&gt; <a class="code" href="classCMAES.html#a959adefafdb32f8e1f56a478c28cc2b7" title="anisotropic evolution path (for covariance)">rgpc</a>[i];
<a name="l01081"></a>01081     file.clear();
<a name="l01082"></a>01082     file.seekg(lastResume);
<a name="l01083"></a>01083 
<a name="l01084"></a>01084     <span class="comment">// find next &quot;sigma&quot; entry</span>
<a name="l01085"></a>01085     <span class="keywordflow">while</span>(!file.eof())
<a name="l01086"></a>01086     {
<a name="l01087"></a>01087       file &gt;&gt; entry;
<a name="l01088"></a>01088       <span class="keywordflow">if</span>(entry == <span class="stringliteral">&quot;sigma&quot;</span>)
<a name="l01089"></a>01089         <span class="keywordflow">break</span>;
<a name="l01090"></a>01090     }
<a name="l01091"></a>01091     <span class="comment">// read pc</span>
<a name="l01092"></a>01092     <span class="keywordflow">if</span>(file.eof())
<a name="l01093"></a>01093       <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;resumeDistribution(): &#39;sigma&#39; not found&quot;</span>);
<a name="l01094"></a>01094     file &gt;&gt; <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>;
<a name="l01095"></a>01095     file.clear();
<a name="l01096"></a>01096     file.seekg(lastResume);
<a name="l01097"></a>01097 
<a name="l01098"></a>01098     <span class="comment">// find next &quot;covariance matrix&quot; entry</span>
<a name="l01099"></a>01099     <span class="keywordflow">while</span>(!file.eof())
<a name="l01100"></a>01100     {
<a name="l01101"></a>01101       file &gt;&gt; entry;
<a name="l01102"></a>01102       <span class="keywordflow">if</span>(entry == <span class="stringliteral">&quot;covariance&quot;</span>)
<a name="l01103"></a>01103       {
<a name="l01104"></a>01104         std::string temp = <span class="stringliteral">&quot;&quot;</span>;
<a name="l01105"></a>01105         file &gt;&gt; temp;
<a name="l01106"></a>01106         entry += <span class="stringliteral">&quot; &quot;</span> + temp;
<a name="l01107"></a>01107         <span class="keywordflow">if</span>(entry == <span class="stringliteral">&quot;covariance matrix&quot;</span>)
<a name="l01108"></a>01108           <span class="keywordflow">break</span>;
<a name="l01109"></a>01109       }
<a name="l01110"></a>01110     }
<a name="l01111"></a>01111     <span class="comment">// read C</span>
<a name="l01112"></a>01112     <span class="keywordflow">if</span>(file.eof())
<a name="l01113"></a>01113       <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;resumeDistribution(): &#39;covariance matrix&#39; not found&quot;</span>);
<a name="l01114"></a>01114     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l01115"></a>01115       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)
<a name="l01116"></a>01116         file &gt;&gt; <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i][j];
<a name="l01117"></a>01117 
<a name="l01118"></a>01118     <a class="code" href="classCMAES.html#ade7b4d250edba249dfcfdc2e2396246e">eigensysIsUptodate</a> = <span class="keyword">false</span>;
<a name="l01119"></a>01119     <a class="code" href="classCMAES.html#a5ef76c4c2d5833429dc868ed8d2c6709">isResumeDone</a> = <span class="keyword">true</span>;
<a name="l01120"></a>01120     <a class="code" href="classCMAES.html#ae0dcc966a2b41a9f35724c5f65e87cf5" title="Conducts the eigendecomposition of C into B and D such that  and  and D diagonal and positive...">updateEigensystem</a>(<span class="keyword">true</span>);
<a name="l01121"></a>01121   }
<a name="l01122"></a>01122 
<a name="l01129"></a><a class="code" href="classCMAES.html#a125e113c39476688c546f3e065fd18f1">01129</a>   T* <span class="keyword">const</span>* <a class="code" href="classCMAES.html#a125e113c39476688c546f3e065fd18f1" title="The search space vectors have a special form: they are arrays with N+1 entries.">samplePopulation</a>()
<a name="l01130"></a>01130   {
<a name="l01131"></a>01131     <span class="keywordtype">bool</span> diag = <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.diagonalCov == 1 || <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.diagonalCov &gt;= <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a>;
<a name="l01132"></a>01132 
<a name="l01133"></a>01133     <span class="comment">// calculate eigensystem</span>
<a name="l01134"></a>01134     <span class="keywordflow">if</span>(!<a class="code" href="classCMAES.html#ade7b4d250edba249dfcfdc2e2396246e">eigensysIsUptodate</a>)
<a name="l01135"></a>01135     {
<a name="l01136"></a>01136       <span class="keywordflow">if</span>(!diag)
<a name="l01137"></a>01137         <a class="code" href="classCMAES.html#ae0dcc966a2b41a9f35724c5f65e87cf5" title="Conducts the eigendecomposition of C into B and D such that  and  and D diagonal and positive...">updateEigensystem</a>(<span class="keyword">false</span>);
<a name="l01138"></a>01138       <span class="keywordflow">else</span>
<a name="l01139"></a>01139       {
<a name="l01140"></a>01140         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l01141"></a>01141           <a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>[i] = std::sqrt(<a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i][i]);
<a name="l01142"></a>01142         <a class="code" href="classCMAES.html#a9796be17293ba4549946392565368f41">minEW</a> = <a class="code" href="utils_8h.html#a989667debd678779d780857cc650eb86">square</a>(<a class="code" href="utils_8h.html#a5ab74da4f5c22d49151fd4c7c9a41dee">minElement</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>, <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N));
<a name="l01143"></a>01143         <a class="code" href="classCMAES.html#ae36bc85cdd41cb3db39b99a0303f6b6e">maxEW</a> = <a class="code" href="utils_8h.html#a989667debd678779d780857cc650eb86">square</a>(<a class="code" href="utils_8h.html#a607a38043b6aa6f8501b8bfca777536f">maxElement</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>, <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N));
<a name="l01144"></a>01144         <a class="code" href="classCMAES.html#ade7b4d250edba249dfcfdc2e2396246e">eigensysIsUptodate</a> = <span class="keyword">true</span>;
<a name="l01145"></a>01145         <a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">eigenTimings</a>.<a class="code" href="classTiming.html#a5110c4f7949fbd326ee071c82473b611">start</a>();
<a name="l01146"></a>01146       }
<a name="l01147"></a>01147     }
<a name="l01148"></a>01148 
<a name="l01149"></a>01149     <a class="code" href="classCMAES.html#a0acb1ad8ffd57032a1be02654a9d0d4a" title="Treats minimal standard deviations and numeric problems.">testMinStdDevs</a>();
<a name="l01150"></a>01150 
<a name="l01151"></a>01151     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iNk = 0; iNk &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.lambda; ++iNk)
<a name="l01152"></a>01152     { <span class="comment">// generate scaled random vector D*z</span>
<a name="l01153"></a>01153       T* rgrgxink = <a class="code" href="classCMAES.html#ae85f01391da333e830437e46671b5b4d" title="x-vectors, lambda offspring">rgrgx</a>[iNk];
<a name="l01154"></a>01154       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l01155"></a>01155         <span class="keywordflow">if</span>(diag)
<a name="l01156"></a>01156           rgrgxink[i] = <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="mean x vector, &amp;quot;parent&amp;quot;">xmean</a>[i] + <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>*<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>[i]*<a class="code" href="classCMAES.html#a73e60929e1e08ea6f9f4a5cec6f020b4" title="Random number generator.">rand</a>.gauss();
<a name="l01157"></a>01157         <span class="keywordflow">else</span>
<a name="l01158"></a>01158           <a class="code" href="classCMAES.html#a75bd9d32b150084d1e6771c7806367b9" title="temporary (random) vector used in different places">rgdTmp</a>[i] = <a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>[i]*<a class="code" href="classCMAES.html#a73e60929e1e08ea6f9f4a5cec6f020b4" title="Random number generator.">rand</a>.gauss();
<a name="l01159"></a>01159       <span class="keywordflow">if</span>(!diag)
<a name="l01160"></a>01160         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i) <span class="comment">// add mutation sigma*B*(D*z)</span>
<a name="l01161"></a>01161         {
<a name="l01162"></a>01162           T sum = 0.0;
<a name="l01163"></a>01163           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++j)
<a name="l01164"></a>01164             sum += <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="matrix with normalize eigenvectors in columns">B</a>[i][j]*<a class="code" href="classCMAES.html#a75bd9d32b150084d1e6771c7806367b9" title="temporary (random) vector used in different places">rgdTmp</a>[j];
<a name="l01165"></a>01165           rgrgxink[i] = <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="mean x vector, &amp;quot;parent&amp;quot;">xmean</a>[i] + <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>*sum;
<a name="l01166"></a>01166         }
<a name="l01167"></a>01167     }
<a name="l01168"></a>01168 
<a name="l01169"></a>01169     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a2259ba2fee168dac1aed9a5de7e9703e" title="algorithm state">state</a> == <a class="code" href="classCMAES.html#a0cef0210cdaaf09dd1d40daf33127765a56c763404afb4ac45e7b81539eeb6fd2">UPDATED</a> || <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a> == 0)
<a name="l01170"></a>01170       ++<a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a>;
<a name="l01171"></a>01171     <a class="code" href="classCMAES.html#a2259ba2fee168dac1aed9a5de7e9703e" title="algorithm state">state</a> = <a class="code" href="classCMAES.html#a0cef0210cdaaf09dd1d40daf33127765abf4219108f9e35e6816d0233af2a2e3e">SAMPLED</a>;
<a name="l01172"></a>01172 
<a name="l01173"></a>01173     <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#ae85f01391da333e830437e46671b5b4d" title="x-vectors, lambda offspring">rgrgx</a>;
<a name="l01174"></a>01174   }
<a name="l01175"></a>01175 
<a name="l01185"></a><a class="code" href="classCMAES.html#af4080d6c8baeda354674c5e94f15c682">01185</a>   T* <span class="keyword">const</span>* <a class="code" href="classCMAES.html#af4080d6c8baeda354674c5e94f15c682" title="Can be called after samplePopulation() to resample single solutions of the population as often as des...">reSampleSingle</a>(<span class="keywordtype">int</span> i)
<a name="l01186"></a>01186   {
<a name="l01187"></a>01187     T* x;
<a name="l01188"></a>01188     assert(i &gt;= 0 &amp;&amp; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.lambda &amp;&amp;
<a name="l01189"></a>01189         <span class="stringliteral">&quot;reSampleSingle(): index must be between 0 and sp.lambda&quot;</span>);
<a name="l01190"></a>01190     x = <a class="code" href="classCMAES.html#ae85f01391da333e830437e46671b5b4d" title="x-vectors, lambda offspring">rgrgx</a>[i];
<a name="l01191"></a>01191     <a class="code" href="classCMAES.html#af5d3c51b5b233cb684ba40bfa564fc98" title="Adds the mutation sigma*B*(D*z).">addMutation</a>(x);
<a name="l01192"></a>01192     <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#ae85f01391da333e830437e46671b5b4d" title="x-vectors, lambda offspring">rgrgx</a>;
<a name="l01193"></a>01193   }
<a name="l01194"></a>01194 
<a name="l01209"></a><a class="code" href="classCMAES.html#a5e691eef09ff825b48b1db0aed3f5cd8">01209</a>   T* <a class="code" href="classCMAES.html#a5e691eef09ff825b48b1db0aed3f5cd8" title="Can be called after samplePopulation() to resample single solutions.">sampleSingleInto</a>(T* x)
<a name="l01210"></a>01210   {
<a name="l01211"></a>01211     <span class="keywordflow">if</span>(!x)
<a name="l01212"></a>01212       x = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N];
<a name="l01213"></a>01213     <a class="code" href="classCMAES.html#af5d3c51b5b233cb684ba40bfa564fc98" title="Adds the mutation sigma*B*(D*z).">addMutation</a>(x);
<a name="l01214"></a>01214     <span class="keywordflow">return</span> x;
<a name="l01215"></a>01215   }
<a name="l01216"></a>01216 
<a name="l01226"></a><a class="code" href="classCMAES.html#a0b63182a2fe2b4e977b3f0931153d166">01226</a>   T <span class="keyword">const</span>* <a class="code" href="classCMAES.html#a0b63182a2fe2b4e977b3f0931153d166" title="Can be called after samplePopulation() to resample single solutions.">reSampleSingleOld</a>(T* x)
<a name="l01227"></a>01227   {
<a name="l01228"></a>01228     assert(x &amp;&amp; <span class="stringliteral">&quot;reSampleSingleOld(): Missing input x&quot;</span>);
<a name="l01229"></a>01229     <a class="code" href="classCMAES.html#af5d3c51b5b233cb684ba40bfa564fc98" title="Adds the mutation sigma*B*(D*z).">addMutation</a>(x);
<a name="l01230"></a>01230     <span class="keywordflow">return</span> x;
<a name="l01231"></a>01231   }
<a name="l01232"></a>01232 
<a name="l01246"></a><a class="code" href="classCMAES.html#ad567c3fb26738c797f4312dcacb48d52">01246</a>   T* <a class="code" href="classCMAES.html#ad567c3fb26738c797f4312dcacb48d52" title="Used to reevaluate a slightly disturbed solution for an uncertaintly measurement.">perturbSolutionInto</a>(T* x, T <span class="keyword">const</span>* pxmean, T eps)
<a name="l01247"></a>01247   {
<a name="l01248"></a>01248     <span class="keywordflow">if</span>(!x)
<a name="l01249"></a>01249       x = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N];
<a name="l01250"></a>01250     assert(pxmean &amp;&amp; <span class="stringliteral">&quot;perturbSolutionInto(): pxmean was not given&quot;</span>);
<a name="l01251"></a>01251     <a class="code" href="classCMAES.html#af5d3c51b5b233cb684ba40bfa564fc98" title="Adds the mutation sigma*B*(D*z).">addMutation</a>(x, eps);
<a name="l01252"></a>01252     <span class="keywordflow">return</span> x;
<a name="l01253"></a>01253   }
<a name="l01254"></a>01254 
<a name="l01262"></a><a class="code" href="classCMAES.html#aca72ba65586cc02ecd9325eb0cc420a0">01262</a>   T* <a class="code" href="classCMAES.html#aca72ba65586cc02ecd9325eb0cc420a0" title="Core procedure of the CMA-ES algorithm.">updateDistribution</a>(<span class="keyword">const</span> T* fitnessValues)
<a name="l01263"></a>01263   {
<a name="l01264"></a>01264     <span class="keyword">const</span> <span class="keywordtype">int</span> N = <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N;
<a name="l01265"></a>01265     <span class="keywordtype">bool</span> diag = <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.diagonalCov == 1 || <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.diagonalCov &gt;= <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a>;
<a name="l01266"></a>01266 
<a name="l01267"></a>01267     assert(<a class="code" href="classCMAES.html#a2259ba2fee168dac1aed9a5de7e9703e" title="algorithm state">state</a> != <a class="code" href="classCMAES.html#a0cef0210cdaaf09dd1d40daf33127765a56c763404afb4ac45e7b81539eeb6fd2">UPDATED</a> &amp;&amp; <span class="stringliteral">&quot;updateDistribution(): You need to call &quot;</span>
<a name="l01268"></a>01268           <span class="stringliteral">&quot;samplePopulation() before update can take place.&quot;</span>);
<a name="l01269"></a>01269     assert(fitnessValues &amp;&amp; <span class="stringliteral">&quot;updateDistribution(): No fitness function value array input.&quot;</span>);
<a name="l01270"></a>01270 
<a name="l01271"></a>01271     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a2259ba2fee168dac1aed9a5de7e9703e" title="algorithm state">state</a> == <a class="code" href="classCMAES.html#a0cef0210cdaaf09dd1d40daf33127765abf4219108f9e35e6816d0233af2a2e3e">SAMPLED</a>) <span class="comment">// function values are delivered here</span>
<a name="l01272"></a>01272       <a class="code" href="classCMAES.html#a4e328b09739d2fb1a220a3d7cf4bc82c" title="objective function evaluations">countevals</a> += <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.lambda;
<a name="l01273"></a>01273     <span class="keywordflow">else</span>
<a name="l01274"></a>01274       assert(<span class="keyword">false</span> &amp;&amp; <span class="stringliteral">&quot;updateDistribution(): unexpected state&quot;</span>);
<a name="l01275"></a>01275 
<a name="l01276"></a>01276     <span class="comment">// assign function values</span>
<a name="l01277"></a>01277     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.lambda; ++i)
<a name="l01278"></a>01278       <a class="code" href="classCMAES.html#ae85f01391da333e830437e46671b5b4d" title="x-vectors, lambda offspring">rgrgx</a>[i][N] = <a class="code" href="classCMAES.html#a3766a33cf5871b68715921aa5df60118">rgFuncValue</a>[i] = fitnessValues[i];
<a name="l01279"></a>01279 
<a name="l01280"></a>01280     <span class="comment">// Generate index</span>
<a name="l01281"></a>01281     <a class="code" href="classCMAES.html#a6ec64a4e6821b8d568a18acd524a7611" title="Dirty index sort.">sortIndex</a>(fitnessValues, <a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="sorting index of sample pop.">index</a>, <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.lambda);
<a name="l01282"></a>01282 
<a name="l01283"></a>01283     <span class="comment">// Test if function values are identical, escape flat fitness</span>
<a name="l01284"></a>01284     <span class="keywordflow">if</span>(fitnessValues[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="sorting index of sample pop.">index</a>[0]] == fitnessValues[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="sorting index of sample pop.">index</a>[(<span class="keywordtype">int</span>) <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.lambda / 2]])
<a name="l01285"></a>01285     {
<a name="l01286"></a>01286       <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a> *= std::exp(T(0.2) + <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.cs / <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.damps);
<a name="l01287"></a>01287       assert(<span class="keyword">false</span> &amp;&amp; <span class="stringliteral">&quot;Warning: sigma increased due to equal function values\n&quot;</span>
<a name="l01288"></a>01288           <span class="stringliteral">&quot;   Reconsider the formulation of the objective function&quot;</span>);
<a name="l01289"></a>01289     }
<a name="l01290"></a>01290 
<a name="l01291"></a>01291     <span class="comment">// update function value history</span>
<a name="l01292"></a>01292     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = (<span class="keywordtype">int</span>) *(<a class="code" href="classCMAES.html#ad5c0bde5c3688de59e830e852ef17e44">arFuncValueHist</a> - 1) - 1; i &gt; 0; --i)
<a name="l01293"></a>01293       <a class="code" href="classCMAES.html#ad5c0bde5c3688de59e830e852ef17e44">arFuncValueHist</a>[i] = <a class="code" href="classCMAES.html#ad5c0bde5c3688de59e830e852ef17e44">arFuncValueHist</a>[i - 1];
<a name="l01294"></a>01294     <a class="code" href="classCMAES.html#ad5c0bde5c3688de59e830e852ef17e44">arFuncValueHist</a>[0] = fitnessValues[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="sorting index of sample pop.">index</a>[0]];
<a name="l01295"></a>01295 
<a name="l01296"></a>01296     <span class="comment">// update xbestever</span>
<a name="l01297"></a>01297     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a33b5fc42be0304dc3ca66f3923d6d6ed" title="best sample ever">rgxbestever</a>[N] &gt; <a class="code" href="classCMAES.html#ae85f01391da333e830437e46671b5b4d" title="x-vectors, lambda offspring">rgrgx</a>[index[0]][N] || <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a> == 1)
<a name="l01298"></a>01298       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt;= N; ++i)
<a name="l01299"></a>01299       {
<a name="l01300"></a>01300         <a class="code" href="classCMAES.html#a33b5fc42be0304dc3ca66f3923d6d6ed" title="best sample ever">rgxbestever</a>[i] = <a class="code" href="classCMAES.html#ae85f01391da333e830437e46671b5b4d" title="x-vectors, lambda offspring">rgrgx</a>[index[0]][i];
<a name="l01301"></a>01301         <a class="code" href="classCMAES.html#a33b5fc42be0304dc3ca66f3923d6d6ed" title="best sample ever">rgxbestever</a>[N+1] = <a class="code" href="classCMAES.html#a4e328b09739d2fb1a220a3d7cf4bc82c" title="objective function evaluations">countevals</a>;
<a name="l01302"></a>01302       }
<a name="l01303"></a>01303 
<a name="l01304"></a>01304     <span class="keyword">const</span> T sqrtmueffdivsigma = std::sqrt(<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.mueff) / <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>;
<a name="l01305"></a>01305     <span class="comment">// calculate xmean and rgBDz~N(0,C)</span>
<a name="l01306"></a>01306     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; N; ++i)
<a name="l01307"></a>01307     {
<a name="l01308"></a>01308       <a class="code" href="classCMAES.html#a09e7f98cfed00b8847c411faaa28a935">rgxold</a>[i] = <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="mean x vector, &amp;quot;parent&amp;quot;">xmean</a>[i];
<a name="l01309"></a>01309       <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="mean x vector, &amp;quot;parent&amp;quot;">xmean</a>[i] = 0.;
<a name="l01310"></a>01310       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iNk = 0; iNk &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.mu; ++iNk)
<a name="l01311"></a>01311         <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="mean x vector, &amp;quot;parent&amp;quot;">xmean</a>[i] += <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.weights[iNk]*<a class="code" href="classCMAES.html#ae85f01391da333e830437e46671b5b4d" title="x-vectors, lambda offspring">rgrgx</a>[index[iNk]][i];
<a name="l01312"></a>01312       <a class="code" href="classCMAES.html#af70aca7676a8a393591e3813dfd244c6" title="for B*D*z">rgBDz</a>[i] = sqrtmueffdivsigma*(<a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="mean x vector, &amp;quot;parent&amp;quot;">xmean</a>[i]-<a class="code" href="classCMAES.html#a09e7f98cfed00b8847c411faaa28a935">rgxold</a>[i]);
<a name="l01313"></a>01313     }
<a name="l01314"></a>01314 
<a name="l01315"></a>01315     <span class="comment">// calculate z := D^(-1)* B^(-1)* rgBDz into rgdTmp</span>
<a name="l01316"></a>01316     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; N; ++i)
<a name="l01317"></a>01317     {
<a name="l01318"></a>01318       T sum;
<a name="l01319"></a>01319       <span class="keywordflow">if</span>(diag)
<a name="l01320"></a>01320         sum = <a class="code" href="classCMAES.html#af70aca7676a8a393591e3813dfd244c6" title="for B*D*z">rgBDz</a>[i];
<a name="l01321"></a>01321       <span class="keywordflow">else</span>
<a name="l01322"></a>01322       {
<a name="l01323"></a>01323         sum = 0.;
<a name="l01324"></a>01324         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; N; ++j)
<a name="l01325"></a>01325           sum += <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="matrix with normalize eigenvectors in columns">B</a>[j][i]*<a class="code" href="classCMAES.html#af70aca7676a8a393591e3813dfd244c6" title="for B*D*z">rgBDz</a>[j];
<a name="l01326"></a>01326       }
<a name="l01327"></a>01327       <a class="code" href="classCMAES.html#a75bd9d32b150084d1e6771c7806367b9" title="temporary (random) vector used in different places">rgdTmp</a>[i] = sum/<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>[i];
<a name="l01328"></a>01328     }
<a name="l01329"></a>01329 
<a name="l01330"></a>01330     <span class="comment">// cumulation for sigma (ps) using B*z</span>
<a name="l01331"></a>01331     <span class="keyword">const</span> T sqrtFactor = std::sqrt(<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.cs*(T(2)-<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.cs));
<a name="l01332"></a>01332     <span class="keyword">const</span> T invps = T(1)-<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.cs;
<a name="l01333"></a>01333     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; N; ++i)
<a name="l01334"></a>01334     {
<a name="l01335"></a>01335       T sum;
<a name="l01336"></a>01336       <span class="keywordflow">if</span>(diag)
<a name="l01337"></a>01337         sum = <a class="code" href="classCMAES.html#a75bd9d32b150084d1e6771c7806367b9" title="temporary (random) vector used in different places">rgdTmp</a>[i];
<a name="l01338"></a>01338       <span class="keywordflow">else</span>
<a name="l01339"></a>01339       {
<a name="l01340"></a>01340         sum = T(0);
<a name="l01341"></a>01341         T* Bi = <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="matrix with normalize eigenvectors in columns">B</a>[i];
<a name="l01342"></a>01342         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; N; ++j)
<a name="l01343"></a>01343           sum += Bi[j]*<a class="code" href="classCMAES.html#a75bd9d32b150084d1e6771c7806367b9" title="temporary (random) vector used in different places">rgdTmp</a>[j];
<a name="l01344"></a>01344       }
<a name="l01345"></a>01345       <a class="code" href="classCMAES.html#af032f05a04ebce55701225bccc9c60f7" title="isotropic evolution path (for step length)">rgps</a>[i] = invps*<a class="code" href="classCMAES.html#af032f05a04ebce55701225bccc9c60f7" title="isotropic evolution path (for step length)">rgps</a>[i] + sqrtFactor*sum;
<a name="l01346"></a>01346     }
<a name="l01347"></a>01347 
<a name="l01348"></a>01348     <span class="comment">// calculate norm(ps)^2</span>
<a name="l01349"></a>01349     T psxps(0);
<a name="l01350"></a>01350     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; N; ++i)
<a name="l01351"></a>01351     {
<a name="l01352"></a>01352       <span class="keyword">const</span> T&amp; rgpsi = <a class="code" href="classCMAES.html#af032f05a04ebce55701225bccc9c60f7" title="isotropic evolution path (for step length)">rgps</a>[i];
<a name="l01353"></a>01353       psxps += rgpsi*rgpsi;
<a name="l01354"></a>01354     }
<a name="l01355"></a>01355 
<a name="l01356"></a>01356     <span class="comment">// cumulation for covariance matrix (pc) using B*D*z~N(0,C)</span>
<a name="l01357"></a>01357     <span class="keywordtype">int</span> hsig = std::sqrt(psxps) / std::sqrt(T(1) - std::pow(T(1) - <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.cs, T(2)* <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a>))
<a name="l01358"></a>01358         / <a class="code" href="classCMAES.html#af5aff4dfec9d1eabe488c5f03395158f">chiN</a> &lt; T(1.4) + T(2) / (N + 1);
<a name="l01359"></a>01359     <span class="keyword">const</span> T ccumcovinv = 1.-<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.ccumcov;
<a name="l01360"></a>01360     <span class="keyword">const</span> T hsigFactor = hsig*std::sqrt(<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.ccumcov*(T(2)-<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.ccumcov));
<a name="l01361"></a>01361     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; N; ++i)
<a name="l01362"></a>01362       <a class="code" href="classCMAES.html#a959adefafdb32f8e1f56a478c28cc2b7" title="anisotropic evolution path (for covariance)">rgpc</a>[i] = ccumcovinv*<a class="code" href="classCMAES.html#a959adefafdb32f8e1f56a478c28cc2b7" title="anisotropic evolution path (for covariance)">rgpc</a>[i] + hsigFactor*<a class="code" href="classCMAES.html#af70aca7676a8a393591e3813dfd244c6" title="for B*D*z">rgBDz</a>[i];
<a name="l01363"></a>01363 
<a name="l01364"></a>01364     <span class="comment">// update of C</span>
<a name="l01365"></a>01365     <a class="code" href="classCMAES.html#a2865ab646d4cbab7fa8e9c965b3d2b84">adaptC2</a>(hsig);
<a name="l01366"></a>01366 
<a name="l01367"></a>01367     <span class="comment">// update of sigma</span>
<a name="l01368"></a>01368     <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a> *= std::exp(((std::sqrt(psxps) / <a class="code" href="classCMAES.html#af5aff4dfec9d1eabe488c5f03395158f">chiN</a>) - T(1))* <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.cs / <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.damps);
<a name="l01369"></a>01369 
<a name="l01370"></a>01370     <a class="code" href="classCMAES.html#a2259ba2fee168dac1aed9a5de7e9703e" title="algorithm state">state</a> = <a class="code" href="classCMAES.html#a0cef0210cdaaf09dd1d40daf33127765a56c763404afb4ac45e7b81539eeb6fd2">UPDATED</a>;
<a name="l01371"></a>01371     <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="mean x vector, &amp;quot;parent&amp;quot;">xmean</a>;
<a name="l01372"></a>01372   }
<a name="l01373"></a>01373 
<a name="l01379"></a><a class="code" href="classCMAES.html#a45e773741a707a9f95a5c2bab07fcfca">01379</a>   T <span class="keyword">get</span>(<a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8" title="Keys for get().">GetScalar</a> key)
<a name="l01380"></a>01380   {
<a name="l01381"></a>01381     <span class="keywordflow">switch</span>(key)
<a name="l01382"></a>01382     {
<a name="l01383"></a>01383       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a80b1da110476f59b1dd637f86abcff6d">AxisRatio</a>:
<a name="l01384"></a>01384         <span class="keywordflow">return</span> <a class="code" href="utils_8h.html#a607a38043b6aa6f8501b8bfca777536f">maxElement</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>, <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N) / <a class="code" href="utils_8h.html#a5ab74da4f5c22d49151fd4c7c9a41dee">minElement</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>, <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N);
<a name="l01385"></a>01385       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a792dc72137eae9dff32d3d0ec7e520a0">Eval</a>:
<a name="l01386"></a>01386         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a4e328b09739d2fb1a220a3d7cf4bc82c" title="objective function evaluations">countevals</a>;
<a name="l01387"></a>01387       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8addcdd74505b48ad4a541db7b829e335b">Fitness</a>:
<a name="l01388"></a>01388         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a3766a33cf5871b68715921aa5df60118">rgFuncValue</a>[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="sorting index of sample pop.">index</a>[0]];
<a name="l01389"></a>01389       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8ad21c49f13a72548684969bd0efadee5b">FBestEver</a>:
<a name="l01390"></a>01390         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a33b5fc42be0304dc3ca66f3923d6d6ed" title="best sample ever">rgxbestever</a>[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N];
<a name="l01391"></a>01391       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8acc3da801ee825cfe1d4546e7ff1df445">Generation</a>:
<a name="l01392"></a>01392         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a>;
<a name="l01393"></a>01393       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8aa6d0a2c0e925ea13fbc4eafdb0d73212">MaxEval</a>:
<a name="l01394"></a>01394         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.stopMaxFunEvals;
<a name="l01395"></a>01395       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a2f5dc38e6e11ee72a99131f66ac96ec6">MaxIter</a>:
<a name="l01396"></a>01396         <span class="keywordflow">return</span> std::ceil(<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.stopMaxIter);
<a name="l01397"></a>01397       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8ad08dc0a35ffc83e74e5ee207facfd9ae">MaxAxisLength</a>:
<a name="l01398"></a>01398         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#ae36bc85cdd41cb3db39b99a0303f6b6e">maxEW</a>);
<a name="l01399"></a>01399       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a69531e25f35ad31c729d8cbbdb0919ce">MinAxisLength</a>:
<a name="l01400"></a>01400         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#a9796be17293ba4549946392565368f41">minEW</a>);
<a name="l01401"></a>01401       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a2255eb5bbe0790bd7d8a59ebd6adcefc">MaxStdDev</a>:
<a name="l01402"></a>01402         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#a93eee1dc0a955f05fcabb5db15b64886" title="repeatedly used for output">maxdiagC</a>);
<a name="l01403"></a>01403       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8ad2a4cb103c2cde9298f960900d82d9e5">MinStdDev</a>:
<a name="l01404"></a>01404         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#a0fc9beb46f3685e1f49f2575de3ce026">mindiagC</a>);
<a name="l01405"></a>01405       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8aa3da33927ee647a3f48e408b11c37946">Dimension</a>:
<a name="l01406"></a>01406         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N;
<a name="l01407"></a>01407       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a525cb5a156ebe9191586e97830aede31">SampleSize</a>:
<a name="l01408"></a>01408         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.lambda;
<a name="l01409"></a>01409       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#ad7400b48c05115ef004ce20317646ca8a06a4d432f0d0783509dd88456ecd07ea">Sigma</a>:
<a name="l01410"></a>01410         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>;
<a name="l01411"></a>01411       <span class="keywordflow">default</span>:
<a name="l01412"></a>01412         <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;get(): No match found for key&quot;</span>);
<a name="l01413"></a>01413     }
<a name="l01414"></a>01414   }
<a name="l01415"></a>01415 
<a name="l01423"></a><a class="code" href="classCMAES.html#a818196db6e0a2bfcf800d4b6e644988e">01423</a>   <span class="keyword">const</span> T* <a class="code" href="classCMAES.html#a818196db6e0a2bfcf800d4b6e644988e" title="Request a vector parameter from CMA-ES.">getPtr</a>(<a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82" title="Keys for getPtr().">GetVector</a> key)
<a name="l01424"></a>01424   {
<a name="l01425"></a>01425     <span class="keywordflow">switch</span>(key)
<a name="l01426"></a>01426     {
<a name="l01427"></a>01427       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82ae17b1c54a0a0ab7c76d07eed386d9322">DiagC</a>:
<a name="l01428"></a>01428       {
<a name="l01429"></a>01429         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l01430"></a>01430           <a class="code" href="classCMAES.html#a0632e9bfd6e6f6db52df1e988b7d3758">rgout</a>[i] = <a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i][i];
<a name="l01431"></a>01431         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a0632e9bfd6e6f6db52df1e988b7d3758">rgout</a>;
<a name="l01432"></a>01432       }
<a name="l01433"></a>01433       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82a5bdd7c9d31b8273f97e54e30f6119399">DiagD</a>:
<a name="l01434"></a>01434         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>;
<a name="l01435"></a>01435       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82a0ec1a5126c8afaa5de18d488631e0694">StdDev</a>:
<a name="l01436"></a>01436       {
<a name="l01437"></a>01437         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l01438"></a>01438           <a class="code" href="classCMAES.html#a0632e9bfd6e6f6db52df1e988b7d3758">rgout</a>[i] = <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i][i]);
<a name="l01439"></a>01439         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a0632e9bfd6e6f6db52df1e988b7d3758">rgout</a>;
<a name="l01440"></a>01440       }
<a name="l01441"></a>01441       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82aee6ad973ab7973ed05fbd787af5f4241">XBestEver</a>:
<a name="l01442"></a>01442         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a33b5fc42be0304dc3ca66f3923d6d6ed" title="best sample ever">rgxbestever</a>;
<a name="l01443"></a>01443       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82aeb635f2a8c23f4e25bd9ae0e0804bb7a">XBest</a>:
<a name="l01444"></a>01444         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#ae85f01391da333e830437e46671b5b4d" title="x-vectors, lambda offspring">rgrgx</a>[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="sorting index of sample pop.">index</a>[0]];
<a name="l01445"></a>01445       <span class="keywordflow">case</span> <a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82abe10ba6036cb0771e308fb1f9af27f48">XMean</a>:
<a name="l01446"></a>01446         <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="mean x vector, &amp;quot;parent&amp;quot;">xmean</a>;
<a name="l01447"></a>01447       <span class="keywordflow">default</span>:
<a name="l01448"></a>01448         <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;getPtr(): No match found for key&quot;</span>);
<a name="l01449"></a>01449     }
<a name="l01450"></a>01450   }
<a name="l01451"></a>01451 
<a name="l01459"></a><a class="code" href="classCMAES.html#a573360ecfe2684493e0e256f9d5ea60d">01459</a>   T* <a class="code" href="classCMAES.html#a573360ecfe2684493e0e256f9d5ea60d" title="Request a vector parameter from CMA-ES.">getNew</a>(<a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82" title="Keys for getPtr().">GetVector</a> key)
<a name="l01460"></a>01460   {
<a name="l01461"></a>01461     <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a26ea206fe46a5bc687716dfb0802d74c" title="Request a vector parameter from CMA-ES.">getInto</a>(key, 0);
<a name="l01462"></a>01462   }
<a name="l01463"></a>01463 
<a name="l01471"></a><a class="code" href="classCMAES.html#a26ea206fe46a5bc687716dfb0802d74c">01471</a>   T* <a class="code" href="classCMAES.html#a26ea206fe46a5bc687716dfb0802d74c" title="Request a vector parameter from CMA-ES.">getInto</a>(<a class="code" href="classCMAES.html#a55c21f2418b9972c6ffe26d188115f82" title="Keys for getPtr().">GetVector</a> key, T* res)
<a name="l01472"></a>01472   {
<a name="l01473"></a>01473     T <span class="keyword">const</span>* res0 = <a class="code" href="classCMAES.html#a818196db6e0a2bfcf800d4b6e644988e" title="Request a vector parameter from CMA-ES.">getPtr</a>(key);
<a name="l01474"></a>01474     <span class="keywordflow">if</span>(!res)
<a name="l01475"></a>01475       res = <span class="keyword">new</span> T[<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N];
<a name="l01476"></a>01476     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l01477"></a>01477       res[i] = res0[i];
<a name="l01478"></a>01478     <span class="keywordflow">return</span> res;
<a name="l01479"></a>01479   }
<a name="l01480"></a>01480 
<a name="l01489"></a><a class="code" href="classCMAES.html#a5d3fb0bbff460e5901ef0e8a2bb2f839">01489</a>   <span class="keywordtype">bool</span> <a class="code" href="classCMAES.html#a5d3fb0bbff460e5901ef0e8a2bb2f839" title="Some stopping criteria can be set in initials.par, with names starting with stop...">testForTermination</a>()
<a name="l01490"></a>01490   {
<a name="l01491"></a>01491     T range, fac;
<a name="l01492"></a>01492     <span class="keywordtype">int</span> iAchse, iKoo;
<a name="l01493"></a>01493     <span class="keywordtype">int</span> diag = <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.diagonalCov == 1 || <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.diagonalCov &gt;= <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a>;
<a name="l01494"></a>01494     <span class="keywordtype">int</span> i, cTemp, N = <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N;
<a name="l01495"></a>01495     std::stringstream message;
<a name="l01496"></a>01496 
<a name="l01497"></a>01497     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a0146e5c3a576c5f04e33c0ec3978a2e8" title="A message that contains all matched stop criteria.">stopMessage</a> != <span class="stringliteral">&quot;&quot;</span>)
<a name="l01498"></a>01498     {
<a name="l01499"></a>01499       message &lt;&lt; <a class="code" href="classCMAES.html#a0146e5c3a576c5f04e33c0ec3978a2e8" title="A message that contains all matched stop criteria.">stopMessage</a> &lt;&lt; std::endl;
<a name="l01500"></a>01500     }
<a name="l01501"></a>01501 
<a name="l01502"></a>01502     <span class="comment">// function value reached</span>
<a name="l01503"></a>01503     <span class="keywordflow">if</span>((<a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a> &gt; 1 || <a class="code" href="classCMAES.html#a2259ba2fee168dac1aed9a5de7e9703e" title="algorithm state">state</a> &gt; <a class="code" href="classCMAES.html#a0cef0210cdaaf09dd1d40daf33127765abf4219108f9e35e6816d0233af2a2e3e">SAMPLED</a>) &amp;&amp; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.stStopFitness.flg &amp;&amp;
<a name="l01504"></a>01504         <a class="code" href="classCMAES.html#a3766a33cf5871b68715921aa5df60118">rgFuncValue</a>[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="sorting index of sample pop.">index</a>[0]] &lt;= <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.stStopFitness.val)
<a name="l01505"></a>01505     {
<a name="l01506"></a>01506       message &lt;&lt; <span class="stringliteral">&quot;Fitness: function value &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a3766a33cf5871b68715921aa5df60118">rgFuncValue</a>[<a class="code" href="classCMAES.html#a6e665f59b72e11cda732b4461a450eb3" title="sorting index of sample pop.">index</a>[0]]
<a name="l01507"></a>01507           &lt;&lt; <span class="stringliteral">&quot; &lt;= stopFitness (&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.stStopFitness.val &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;
<a name="l01508"></a>01508     }
<a name="l01509"></a>01509 
<a name="l01510"></a>01510     <span class="comment">// TolFun</span>
<a name="l01511"></a>01511     range = std::max(<a class="code" href="utils_8h.html#a607a38043b6aa6f8501b8bfca777536f">maxElement</a>(<a class="code" href="classCMAES.html#ad5c0bde5c3688de59e830e852ef17e44">arFuncValueHist</a>, (<span class="keywordtype">int</span>) std::min(<a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a>, *(<a class="code" href="classCMAES.html#ad5c0bde5c3688de59e830e852ef17e44">arFuncValueHist</a> - 1))),
<a name="l01512"></a>01512         <a class="code" href="utils_8h.html#a607a38043b6aa6f8501b8bfca777536f">maxElement</a>(<a class="code" href="classCMAES.html#a3766a33cf5871b68715921aa5df60118">rgFuncValue</a>, <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.lambda)) -
<a name="l01513"></a>01513         std::min(<a class="code" href="utils_8h.html#a5ab74da4f5c22d49151fd4c7c9a41dee">minElement</a>(<a class="code" href="classCMAES.html#ad5c0bde5c3688de59e830e852ef17e44">arFuncValueHist</a>, (<span class="keywordtype">int</span>) std::min(<a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a>, *(<a class="code" href="classCMAES.html#ad5c0bde5c3688de59e830e852ef17e44">arFuncValueHist</a> - 1))),
<a name="l01514"></a>01514         <a class="code" href="utils_8h.html#a5ab74da4f5c22d49151fd4c7c9a41dee">minElement</a>(<a class="code" href="classCMAES.html#a3766a33cf5871b68715921aa5df60118">rgFuncValue</a>, <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.lambda));
<a name="l01515"></a>01515 
<a name="l01516"></a>01516     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a> &gt; 0 &amp;&amp; range &lt;= <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.stopTolFun)
<a name="l01517"></a>01517     {
<a name="l01518"></a>01518       message &lt;&lt; <span class="stringliteral">&quot;TolFun: function value differences &quot;</span> &lt;&lt; range
<a name="l01519"></a>01519           &lt;&lt; <span class="stringliteral">&quot; &lt; stopTolFun=&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.stopTolFun &lt;&lt; std::endl;
<a name="l01520"></a>01520     }
<a name="l01521"></a>01521 
<a name="l01522"></a>01522     <span class="comment">// TolFunHist</span>
<a name="l01523"></a>01523     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a> &gt; *(<a class="code" href="classCMAES.html#ad5c0bde5c3688de59e830e852ef17e44">arFuncValueHist</a> - 1))
<a name="l01524"></a>01524     {
<a name="l01525"></a>01525       range = <a class="code" href="utils_8h.html#a607a38043b6aa6f8501b8bfca777536f">maxElement</a>(<a class="code" href="classCMAES.html#ad5c0bde5c3688de59e830e852ef17e44">arFuncValueHist</a>, (<span class="keywordtype">int</span>) *(<a class="code" href="classCMAES.html#ad5c0bde5c3688de59e830e852ef17e44">arFuncValueHist</a> - 1))
<a name="l01526"></a>01526           - <a class="code" href="utils_8h.html#a5ab74da4f5c22d49151fd4c7c9a41dee">minElement</a>(<a class="code" href="classCMAES.html#ad5c0bde5c3688de59e830e852ef17e44">arFuncValueHist</a>, (<span class="keywordtype">int</span>) *(<a class="code" href="classCMAES.html#ad5c0bde5c3688de59e830e852ef17e44">arFuncValueHist</a> - 1));
<a name="l01527"></a>01527       <span class="keywordflow">if</span>(range &lt;= <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.stopTolFunHist)
<a name="l01528"></a>01528         message &lt;&lt; <span class="stringliteral">&quot;TolFunHist: history of function value changes &quot;</span> &lt;&lt; range
<a name="l01529"></a>01529             &lt;&lt; <span class="stringliteral">&quot; stopTolFunHist=&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.stopTolFunHist &lt;&lt; std::endl;
<a name="l01530"></a>01530     }
<a name="l01531"></a>01531 
<a name="l01532"></a>01532     <span class="comment">// TolX</span>
<a name="l01533"></a>01533     <span class="keywordflow">for</span>(i = 0, cTemp = 0; i &lt; N; ++i)
<a name="l01534"></a>01534     {
<a name="l01535"></a>01535       cTemp += (<a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i][i]) &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.stopTolX) ? 1 : 0;
<a name="l01536"></a>01536       cTemp += (<a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>*<a class="code" href="classCMAES.html#a959adefafdb32f8e1f56a478c28cc2b7" title="anisotropic evolution path (for covariance)">rgpc</a>[i] &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.stopTolX) ? 1 : 0;
<a name="l01537"></a>01537     }
<a name="l01538"></a>01538     <span class="keywordflow">if</span>(cTemp == 2*N)
<a name="l01539"></a>01539     {
<a name="l01540"></a>01540       message &lt;&lt; <span class="stringliteral">&quot;TolX: object variable changes below &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.stopTolX &lt;&lt; std::endl;
<a name="l01541"></a>01541     }
<a name="l01542"></a>01542 
<a name="l01543"></a>01543     <span class="comment">// TolUpX</span>
<a name="l01544"></a>01544     <span class="keywordflow">for</span>(i = 0; i &lt; N; ++i)
<a name="l01545"></a>01545     {
<a name="l01546"></a>01546       <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[i][i]) &gt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.stopTolUpXFactor*<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.rgInitialStds[i])
<a name="l01547"></a>01547         <span class="keywordflow">break</span>;
<a name="l01548"></a>01548     }
<a name="l01549"></a>01549     <span class="keywordflow">if</span>(i &lt; N)
<a name="l01550"></a>01550     {
<a name="l01551"></a>01551       message &lt;&lt; <span class="stringliteral">&quot;TolUpX: standard deviation increased by more than &quot;</span>
<a name="l01552"></a>01552           &lt;&lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.stopTolUpXFactor &lt;&lt; <span class="stringliteral">&quot;, larger initial standard deviation recommended \n&quot;</span>
<a name="l01553"></a>01553           &lt;&lt; std::endl;
<a name="l01554"></a>01554     }
<a name="l01555"></a>01555 
<a name="l01556"></a>01556     <span class="comment">// Condition of C greater than dMaxSignifKond</span>
<a name="l01557"></a>01557     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#ae36bc85cdd41cb3db39b99a0303f6b6e">maxEW</a> &gt;= <a class="code" href="classCMAES.html#a9796be17293ba4549946392565368f41">minEW</a>* <a class="code" href="classCMAES.html#ae2163bc8eb11b8d28662ae985f51429b">dMaxSignifKond</a>)
<a name="l01558"></a>01558     {
<a name="l01559"></a>01559       message &lt;&lt; <span class="stringliteral">&quot;ConditionNumber: maximal condition number &quot;</span> &lt;&lt; dMaxSignifKond
<a name="l01560"></a>01560           &lt;&lt; <span class="stringliteral">&quot; reached. maxEW=&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#ae36bc85cdd41cb3db39b99a0303f6b6e">maxEW</a> &lt;&lt;  <span class="stringliteral">&quot;,minEW=&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a9796be17293ba4549946392565368f41">minEW</a> &lt;&lt; <span class="stringliteral">&quot;,maxdiagC=&quot;</span>
<a name="l01561"></a>01561           &lt;&lt; <a class="code" href="classCMAES.html#a93eee1dc0a955f05fcabb5db15b64886" title="repeatedly used for output">maxdiagC</a> &lt;&lt; <span class="stringliteral">&quot;,mindiagC=&quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a0fc9beb46f3685e1f49f2575de3ce026">mindiagC</a> &lt;&lt; std::endl;
<a name="l01562"></a>01562     }
<a name="l01563"></a>01563 
<a name="l01564"></a>01564     <span class="comment">// Principal axis i has no effect on xmean, ie. x == x + 0.1* sigma* rgD[i]* B[i]</span>
<a name="l01565"></a>01565     <span class="keywordflow">if</span>(!diag)
<a name="l01566"></a>01566     {
<a name="l01567"></a>01567       <span class="keywordflow">for</span>(iAchse = 0; iAchse &lt; N; ++iAchse)
<a name="l01568"></a>01568       {
<a name="l01569"></a>01569         fac = 0.1* <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>* <a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>[iAchse];
<a name="l01570"></a>01570         <span class="keywordflow">for</span>(iKoo = 0; iKoo &lt; N; ++iKoo)
<a name="l01571"></a>01571         {
<a name="l01572"></a>01572           <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="mean x vector, &amp;quot;parent&amp;quot;">xmean</a>[iKoo] != <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="mean x vector, &amp;quot;parent&amp;quot;">xmean</a>[iKoo] + fac* <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="matrix with normalize eigenvectors in columns">B</a>[iKoo][iAchse])
<a name="l01573"></a>01573             <span class="keywordflow">break</span>;
<a name="l01574"></a>01574         }
<a name="l01575"></a>01575         <span class="keywordflow">if</span>(iKoo == N)
<a name="l01576"></a>01576         {
<a name="l01577"></a>01577           message &lt;&lt; <span class="stringliteral">&quot;NoEffectAxis: standard deviation 0.1*&quot;</span> &lt;&lt; (fac / 0.1)
<a name="l01578"></a>01578               &lt;&lt; <span class="stringliteral">&quot; in principal axis &quot;</span> &lt;&lt; iAchse &lt;&lt; <span class="stringliteral">&quot; without effect&quot;</span> &lt;&lt; std::endl;
<a name="l01579"></a>01579           <span class="keywordflow">break</span>;
<a name="l01580"></a>01580         }
<a name="l01581"></a>01581       }
<a name="l01582"></a>01582     }
<a name="l01583"></a>01583     <span class="comment">// Component of xmean is not changed anymore</span>
<a name="l01584"></a>01584     <span class="keywordflow">for</span>(iKoo = 0; iKoo &lt; N; ++iKoo)
<a name="l01585"></a>01585     {
<a name="l01586"></a>01586       <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="mean x vector, &amp;quot;parent&amp;quot;">xmean</a>[iKoo] == <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="mean x vector, &amp;quot;parent&amp;quot;">xmean</a>[iKoo] + <a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[iKoo][iKoo])/T(5))
<a name="l01587"></a>01587       {
<a name="l01588"></a>01588         message &lt;&lt; <span class="stringliteral">&quot;NoEffectCoordinate: standard deviation 0.2*&quot;</span>
<a name="l01589"></a>01589             &lt;&lt; (<a class="code" href="classCMAES.html#a8d4d03e74abcb95d665288c4f6298af4" title="step size">sigma</a>*std::sqrt(<a class="code" href="classCMAES.html#a0298719dac43fe97d073d33b0381169d" title="lower triangular matrix: i&amp;gt;=j for C[i][j]">C</a>[iKoo][iKoo])) &lt;&lt; <span class="stringliteral">&quot; in coordinate &quot;</span> &lt;&lt; iKoo
<a name="l01590"></a>01590             &lt;&lt; <span class="stringliteral">&quot; without effect&quot;</span> &lt;&lt; std::endl;
<a name="l01591"></a>01591         <span class="keywordflow">break</span>;
<a name="l01592"></a>01592       }
<a name="l01593"></a>01593     }
<a name="l01594"></a>01594 
<a name="l01595"></a>01595     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a4e328b09739d2fb1a220a3d7cf4bc82c" title="objective function evaluations">countevals</a> &gt;= <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.stopMaxFunEvals)
<a name="l01596"></a>01596     {
<a name="l01597"></a>01597       message &lt;&lt; <span class="stringliteral">&quot;MaxFunEvals: conducted function evaluations &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a4e328b09739d2fb1a220a3d7cf4bc82c" title="objective function evaluations">countevals</a>
<a name="l01598"></a>01598           &lt;&lt; <span class="stringliteral">&quot; &gt;= &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.stopMaxFunEvals &lt;&lt; std::endl;
<a name="l01599"></a>01599     }
<a name="l01600"></a>01600     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a> &gt;= <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.stopMaxIter)
<a name="l01601"></a>01601     {
<a name="l01602"></a>01602       message &lt;&lt; <span class="stringliteral">&quot;MaxIter: number of iterations &quot;</span> &lt;&lt; <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a> &lt;&lt; <span class="stringliteral">&quot; &gt;= &quot;</span>
<a name="l01603"></a>01603           &lt;&lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.stopMaxIter &lt;&lt; std::endl;
<a name="l01604"></a>01604     }
<a name="l01605"></a>01605 
<a name="l01606"></a>01606     <a class="code" href="classCMAES.html#a0146e5c3a576c5f04e33c0ec3978a2e8" title="A message that contains all matched stop criteria.">stopMessage</a> = message.str();
<a name="l01607"></a>01607     <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a0146e5c3a576c5f04e33c0ec3978a2e8" title="A message that contains all matched stop criteria.">stopMessage</a> != <span class="stringliteral">&quot;&quot;</span>;
<a name="l01608"></a>01608   }
<a name="l01609"></a>01609 
<a name="l01614"></a><a class="code" href="classCMAES.html#a3a09215b6efefde35c9faa5c2201c7a7">01614</a>   std::string <a class="code" href="classCMAES.html#a3a09215b6efefde35c9faa5c2201c7a7" title="A message that contains a detailed description of the matched stop criteria.">getStopMessage</a>()
<a name="l01615"></a>01615   {
<a name="l01616"></a>01616     <span class="keywordflow">return</span> <a class="code" href="classCMAES.html#a0146e5c3a576c5f04e33c0ec3978a2e8" title="A message that contains all matched stop criteria.">stopMessage</a>;
<a name="l01617"></a>01617   }
<a name="l01618"></a>01618 
<a name="l01624"></a><a class="code" href="classCMAES.html#a57ea7bb50956aed2aa9eb03f7233f71e">01624</a>   <span class="keywordtype">void</span> <a class="code" href="classCMAES.html#a57ea7bb50956aed2aa9eb03f7233f71e">writeToFile</a>(<span class="keywordtype">int</span> key, <span class="keyword">const</span> std::string&amp; filename)
<a name="l01625"></a>01625   {
<a name="l01626"></a>01626     std::ofstream file;
<a name="l01627"></a>01627     file.open(filename.c_str(), std::ios_base::app);
<a name="l01628"></a>01628 
<a name="l01629"></a>01629     <span class="keywordflow">if</span>(file.is_open())
<a name="l01630"></a>01630     {
<a name="l01631"></a>01631       <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a> &gt; 0 || filename.substr(0, 11) != <span class="stringliteral">&quot;outcmaesfit&quot;</span>)
<a name="l01632"></a>01632         <a class="code" href="classCMAES.html#a886643be9124a2910aa765ad04e4ca84" title="This hack reads key words from input key for data to be written to a file, see file signals...">writeToStream</a>(key, file); <span class="comment">/* do not write fitness for gen==0 */</span>
<a name="l01633"></a>01633       file.close();
<a name="l01634"></a>01634     }
<a name="l01635"></a>01635     <span class="keywordflow">else</span>
<a name="l01636"></a>01636     {
<a name="l01637"></a>01637       <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;writeToFile(): could not open &#39;&quot;</span> + filename + <span class="stringliteral">&quot;&#39;&quot;</span>);
<a name="l01638"></a>01638     }
<a name="l01639"></a>01639   }
<a name="l01640"></a>01640 
<a name="l01648"></a><a class="code" href="classCMAES.html#ae0dcc966a2b41a9f35724c5f65e87cf5">01648</a>   <span class="keywordtype">void</span> <a class="code" href="classCMAES.html#ae0dcc966a2b41a9f35724c5f65e87cf5" title="Conducts the eigendecomposition of C into B and D such that  and  and D diagonal and positive...">updateEigensystem</a>(<span class="keywordtype">bool</span> force)
<a name="l01649"></a>01649   {
<a name="l01650"></a>01650     <a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">eigenTimings</a>.<a class="code" href="classTiming.html#a9973978adb63702db5affd6f77b98fc5">update</a>();
<a name="l01651"></a>01651 
<a name="l01652"></a>01652     <span class="keywordflow">if</span>(!force)
<a name="l01653"></a>01653     {
<a name="l01654"></a>01654       <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#ade7b4d250edba249dfcfdc2e2396246e">eigensysIsUptodate</a>)
<a name="l01655"></a>01655         <span class="keywordflow">return</span>;
<a name="l01656"></a>01656       <span class="comment">// return on modulo generation number</span>
<a name="l01657"></a>01657       <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a> &lt; <a class="code" href="classCMAES.html#a6f4acfc9073c8320c00bb0faa9efcdcb">genOfEigensysUpdate</a> + <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.updateCmode.modulo)
<a name="l01658"></a>01658         <span class="keywordflow">return</span>;
<a name="l01659"></a>01659       <span class="comment">// return on time percentage</span>
<a name="l01660"></a>01660       <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.updateCmode.maxtime &lt; 1.00
<a name="l01661"></a>01661           &amp;&amp; <a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">eigenTimings</a>.<a class="code" href="classTiming.html#adfb11a76f87914807cdfe39bcef0a0af">tictoctime</a> &gt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.updateCmode.maxtime* <a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">eigenTimings</a>.<a class="code" href="classTiming.html#acbd8393d5e1bd7d78e6e6f26cf1850c3">totaltime</a>
<a name="l01662"></a>01662           &amp;&amp; <a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">eigenTimings</a>.<a class="code" href="classTiming.html#adfb11a76f87914807cdfe39bcef0a0af">tictoctime</a> &gt; 0.0002)
<a name="l01663"></a>01663         <span class="keywordflow">return</span>;
<a name="l01664"></a>01664     }
<a name="l01665"></a>01665 
<a name="l01666"></a>01666     <a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">eigenTimings</a>.<a class="code" href="classTiming.html#ac7c5f73d8c5595cb6a2f02f9df913851">tic</a>();
<a name="l01667"></a>01667     <a class="code" href="classCMAES.html#a77ac5ff94fbff0bed5ce9e8d83f890ee" title="Calculating eigenvalues and vectors.">eigen</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>, <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="matrix with normalize eigenvectors in columns">B</a>, <a class="code" href="classCMAES.html#a75bd9d32b150084d1e6771c7806367b9" title="temporary (random) vector used in different places">rgdTmp</a>);
<a name="l01668"></a>01668     <a class="code" href="classCMAES.html#a3ee3b115e387f80b409e94e1127a77dd">eigenTimings</a>.<a class="code" href="classTiming.html#a173ec27a4c1feb364370a920d28ec23b">toc</a>();
<a name="l01669"></a>01669 
<a name="l01670"></a>01670     <span class="comment">// find largest and smallest eigenvalue, they are supposed to be sorted anyway</span>
<a name="l01671"></a>01671     <a class="code" href="classCMAES.html#a9796be17293ba4549946392565368f41">minEW</a> = <a class="code" href="utils_8h.html#a5ab74da4f5c22d49151fd4c7c9a41dee">minElement</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>, <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N);
<a name="l01672"></a>01672     <a class="code" href="classCMAES.html#ae36bc85cdd41cb3db39b99a0303f6b6e">maxEW</a> = <a class="code" href="utils_8h.html#a607a38043b6aa6f8501b8bfca777536f">maxElement</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>, <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N);
<a name="l01673"></a>01673 
<a name="l01674"></a>01674     <span class="keywordflow">if</span>(<a class="code" href="classCMAES.html#a09f393f2ef964f14f6b668bc91657650" title="control via signals.par">doCheckEigen</a>) <span class="comment">// needs O(n^3)! writes, in case, error message in error file</span>
<a name="l01675"></a>01675       <a class="code" href="classCMAES.html#a770b17733d7d66fae4654823736d9c26" title="Exhaustive test of the output of the eigendecomposition, needs O(n^3) operations writes to error file...">checkEigen</a>(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>, <a class="code" href="classCMAES.html#ad8e754e134fdfa39a040a1d421d514f0" title="matrix with normalize eigenvectors in columns">B</a>);
<a name="l01676"></a>01676 
<a name="l01677"></a>01677     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l01678"></a>01678       <a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>[i] = std::sqrt(<a class="code" href="classCMAES.html#a477663d643d114c667965d299221a1e1" title="axis lengths">rgD</a>[i]);
<a name="l01679"></a>01679 
<a name="l01680"></a>01680     <a class="code" href="classCMAES.html#ade7b4d250edba249dfcfdc2e2396246e">eigensysIsUptodate</a> = <span class="keyword">true</span>;
<a name="l01681"></a>01681     <a class="code" href="classCMAES.html#a6f4acfc9073c8320c00bb0faa9efcdcb">genOfEigensysUpdate</a> = <a class="code" href="classCMAES.html#ad9d6f162f80c8163903883694d3970c3" title="Generation number.">gen</a>;
<a name="l01682"></a>01682   }
<a name="l01683"></a>01683 
<a name="l01690"></a><a class="code" href="classCMAES.html#aa61a791319fb10455ed26a77edded44d">01690</a>   T <span class="keyword">const</span>* <a class="code" href="classCMAES.html#aa61a791319fb10455ed26a77edded44d" title="Distribution mean could be changed before samplePopulation().">setMean</a>(<span class="keyword">const</span> T* newxmean)
<a name="l01691"></a>01691   {
<a name="l01692"></a>01692     assert(<a class="code" href="classCMAES.html#a2259ba2fee168dac1aed9a5de7e9703e" title="algorithm state">state</a> != <a class="code" href="classCMAES.html#a0cef0210cdaaf09dd1d40daf33127765abf4219108f9e35e6816d0233af2a2e3e">SAMPLED</a> &amp;&amp;
<a name="l01693"></a>01693         <span class="stringliteral">&quot;setMean: mean cannot be set inbetween the calls of samplePopulation and updateDistribution&quot;</span>);
<a name="l01694"></a>01694 
<a name="l01695"></a>01695     <span class="keywordflow">if</span>(newxmean &amp;&amp; newxmean != <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="mean x vector, &amp;quot;parent&amp;quot;">xmean</a>)
<a name="l01696"></a>01696       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classCMAES.html#a1471339fa263d00131424b3436c7b2ab" title="CMA-ES parameters.">sp</a>.N; ++i)
<a name="l01697"></a>01697         <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="mean x vector, &amp;quot;parent&amp;quot;">xmean</a>[i] = newxmean[i];
<a name="l01698"></a>01698     <span class="keywordflow">else</span>
<a name="l01699"></a>01699       newxmean = <a class="code" href="classCMAES.html#ac98e58c55d6b24c324f4f4d520983191" title="mean x vector, &amp;quot;parent&amp;quot;">xmean</a>;
<a name="l01700"></a>01700 
<a name="l01701"></a>01701     <span class="keywordflow">return</span> newxmean;
<a name="l01702"></a>01702   }
<a name="l01703"></a>01703 };
</pre></div></div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Friends</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Fri Sep 16 2011 17:34:54 for CMA-ES by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
